{"version":3,"sources":["webpack://bitmovin.analytics/webpack/universalModuleDefinition","webpack://bitmovin.analytics/webpack/bootstrap","webpack://bitmovin.analytics/./js/utils/Logger.ts","webpack://bitmovin.analytics/./js/utils/Utils.ts","webpack://bitmovin.analytics/./js/enums/Event.ts","webpack://bitmovin.analytics/./js/enums/Player.ts","webpack://bitmovin.analytics/./js/core/Analytics.ts","webpack://bitmovin.analytics/./js/adapters/Adapter.ts","webpack://bitmovin.analytics/./js/utils/Settings.ts","webpack://bitmovin.analytics/./js/features/errordetails/ErrorDetailBackend.ts","webpack://bitmovin.analytics/./js/features/errordetails/ErrorDetailTracking.ts","webpack://bitmovin.analytics/./js/enums/MIMETypes.ts","webpack://bitmovin.analytics/./js/enums/PlayerSize.ts","webpack://bitmovin.analytics/./js/adapters/internal/InternalAdapter.ts","webpack://bitmovin.analytics/./js/enums/ErrorCode.ts","webpack://bitmovin.analytics/./node_modules/javascript-state-machine/state-machine.js","webpack://bitmovin.analytics/./js/analyticsStateMachines/AnalyticsStateMachine.ts","webpack://bitmovin.analytics/./js/adapters/internal/HTML5InternalAdapter.ts","webpack://bitmovin.analytics/./js/Version.ts","webpack://bitmovin.analytics/./js/utils/Http.ts","webpack://bitmovin.analytics/./js/core/NoOpBackend.ts","webpack://bitmovin.analytics/./js/core/EventDispatcher.ts","webpack://bitmovin.analytics/./js/core/VideoCompletionTracker.ts","webpack://bitmovin.analytics/./js/types/CustomDataValues.ts","webpack://bitmovin.analytics/./js/utils/EventDebugging.ts","webpack://bitmovin.analytics/./js/enums/CastTech.ts","webpack://bitmovin.analytics/./js/utils/BitmovinProgressiveSourceHelper.ts","webpack://bitmovin.analytics/./js/core/DownloadSpeedMeter.ts","webpack://bitmovin.analytics/./js/analyticsStateMachines/HTML5AnalyticsStateMachine.ts","webpack://bitmovin.analytics/./js/enums/StreamTypes.ts","webpack://bitmovin.analytics/./js/core/BitmovinAnalyticsExport.ts","webpack://bitmovin.analytics/./js/adapters/Bitmovin7Adapter.ts","webpack://bitmovin.analytics/./js/features/FeatureManager.ts","webpack://bitmovin.analytics/./js/utils/CodecHelper.ts","webpack://bitmovin.analytics/./js/enums/PageLoadType.ts","webpack://bitmovin.analytics/./js/core/AdAnalytics.ts","webpack://bitmovin.analytics/./js/types/AdAnalyticsSample.ts","webpack://bitmovin.analytics/./js/types/AdBreakSample.ts","webpack://bitmovin.analytics/./js/types/AdSample.ts","webpack://bitmovin.analytics/./js/utils/ViewportTracker.ts","webpack://bitmovin.analytics/./js/core/BackendFactory.ts","webpack://bitmovin.analytics/./js/utils/LicenseCall.ts","webpack://bitmovin.analytics/./js/core/DebuggingBackend.ts","webpack://bitmovin.analytics/./js/core/LicenseCheckingBackend.ts","webpack://bitmovin.analytics/./js/types/LicensingRequest.ts","webpack://bitmovin.analytics/./js/core/QueueBackend.ts","webpack://bitmovin.analytics/./js/core/RemoteBackend.ts","webpack://bitmovin.analytics/./js/utils/AnalyticsCall.ts","webpack://bitmovin.analytics/./js/core/LongPlaytimeFilteringBackend.ts","webpack://bitmovin.analytics/./js/core/SequenceNumberBackend.ts","webpack://bitmovin.analytics/./js/core/SessionPersistenceHandler.ts","webpack://bitmovin.analytics/./js/adapters/internal/Bitmovin7InternalAdapter.ts","webpack://bitmovin.analytics/./js/analyticsStateMachines/Bitmovin7AnalyticsStateMachine.ts","webpack://bitmovin.analytics/./js/enums/VideoStartFailedReason.ts","webpack://bitmovin.analytics/./js/features/Feature.ts","webpack://bitmovin.analytics/./js/types/StateMachineCallbacks.ts","webpack://bitmovin.analytics/./js/adapters/Bitmovin8Adapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/Bitmovin8InternalAdapter.ts","webpack://bitmovin.analytics/./js/analyticsStateMachines/Bitmovin8AnalyticsStateMachine.ts","webpack://bitmovin.analytics/./js/utils/Converter.ts","webpack://bitmovin.analytics/./js/core/Measure.ts","webpack://bitmovin.analytics/./js/core/SegmentTracker.ts","webpack://bitmovin.analytics/./js/features/httprequesttracking/HttpRequestTracking.ts","webpack://bitmovin.analytics/./js/utils/Queue.ts","webpack://bitmovin.analytics/./js/adapters/internal/ads/Bitmovin8AdModule.ts","webpack://bitmovin.analytics/./js/adapters/internal/ads/AdModuleAPI.ts","webpack://bitmovin.analytics/./js/adapters/internal/Bitmovin8HttpRequestTrackingAdapter.ts","webpack://bitmovin.analytics/./js/features/httprequesttracking/HttpRequestType.ts","webpack://bitmovin.analytics/./js/adapters/internal/Bitmovin8SegmentTrackerAdapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/Bitmovin8SpeedMeterAdapter.ts","webpack://bitmovin.analytics/./js/adapters/CAFv3Adapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/CAFv3InternalAdapter.ts","webpack://bitmovin.analytics/./js/adapters/DashjsAdapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/DashjsInternalAdapter.ts","webpack://bitmovin.analytics/./js/adapters/HlsAdapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/HlsInternalAdapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/HlsSpeedMeterAdapter.ts","webpack://bitmovin.analytics/./js/adapters/HTMLVideoElementAdapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/HTMLVideoElementInternalAdapter.ts","webpack://bitmovin.analytics/./js/adapters/ShakaAdapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/ShakaInternalAdapter.ts","webpack://bitmovin.analytics/./js/adapters/VideoJsAdapter.ts","webpack://bitmovin.analytics/./js/adapters/internal/VideojsInternalAdapter.ts","webpack://bitmovin.analytics/./js/analyticsStateMachines/VideoJsAnalyticsStateMachine.ts","webpack://bitmovin.analytics/./js/types/SubtitleInfo.ts","webpack://bitmovin.analytics/./js/enums/CDNProvider.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Logger","showLogs","this","setLogging","logging","isLogging","log","msg","optionalParamters","_i","arguments","length","console","apply","__spreadArrays","logTable","fields","table","errorMessageToUser","error","warning","warn","warningMessageToUser","optionalParameters","padRight","str","Array","join","slice","logger","PageLoadType_1","CustomDataUtils","validString","text","isNullOrEmptyString","validBoolean","bool","validNumber","num","sanitizePath","path","replace","calculateTimeWithUndefined","time","undefined","Math","round","calculateTime","getCurrentTimestamp","Date","now","getDurationFromTimestampToNow","timestamp","generateUUID","random","toString","getCookie","cname","ca_1","document","cookie","split","charAt","substring","indexOf","noOp","getCustomDataString","customData","JSON","stringify","String","transferCustomDataFields","fromConfig","toConfig","customDataFieldCount","customDataField","getDocumentPropWithPrefix","prop","pascalCase","toUpperCase","prefixes_1","prefix","isVideoInFullscreen","fullscreenProp","nodeName","getHiddenProp","getPageLoadType","PAGE_LOAD_TYPE","BACKGROUND","FOREGROUND","getHostnameAndPathFromUrl","url","domElement","createElement","href","hostname","pathname","calculatePercentage","numerator","denominator","getBrowserInfo","tem","ua","navigator","userAgent","M","match","test","version","exec","appName","appVersion","splice","getURLResourceName","pop","joinUrls","args","reduce","prev","current","endsWith","substr","startsWith","suffix","Event","Player","ErrorCode_1","PlayerSize_1","FeatureManager_1","CustomDataValues_1","CodecHelper_1","Logger_1","Settings","Utils","Version_1","AdAnalytics_1","BackendFactory_1","EventDispatcher_1","NoOpBackend_1","SessionPersistenceHandler_1","Analytics","config","adapter","backendFactory","_this","BackendFactory","pageLoadTime","playerStartupTime","videoStartupTime","autoplay","droppedSampleFrames","startupTime","featureManager","FeatureManager","onErrorDetailEventDispatcher","EventDispatcher","authenticationCallback","authenticationCompleted","success","featureConfigs","configureFeatures","guardAgainstMissingVideoTitle","oldConfig","newConfig","title","guardAgainstMissingIsLive","isLive","sourceChange","getMergedAnalyticsConfig","setCustomDataOnce","values","__assign","setState","changeCustomData","sendAnalyticsRequestAndClearValues","setConfigParameters","setCustomData","getCurrentImpressionId","sample","impressionId","input","retVal","customDataValuesKeys","forEach","that","buildDefaultAnalyticsConfigValues","errorDetailTrackingSettingsProvider","domain","getDomain","licenseKey","_a","collectorConfig","sessionHandler","SessionPersistenceHandler","licenseKeyReceivedUnsubscriber","onLicenseKeyReceived","subscribe","eventArgs","setupSample","init","setupStateMachineCallbacks","features","initialize","registerFeatures","adModule","AdAnalytics","checkForErrorsInConfig","VERSION","getPlayerInformationFromAdapter","player","getPlayerName","getPlayerVersion","playerTech","getPlayerTech","updateSamplesToCastClientConfig","samples","castClientConfig","samples_1","updateSampleToCastClientConfig","userId","language","supportsDeferredLicenseLoading","debug","resetFeatures","backend","createBackend","generateNewImpressionId","setUserId","videoCompletionTracker","reset","clearResetQualityChangeInterval","resetQualityChangeCount","disable","NoOpBackend","playerKey","getDomainFromConfig","location","cdnProvider","videoId","videoTitle","customUserId","experimentName","stateMachineCallbacks","setup","duration","state","analyticsVersion","setDuration","performance","timing","loadTime","navigationStart","startup","supportedVideoCodecs","CodecHelper","supportedVideoFormats","getAutoPlay","drmPerformance","getDrmPerformanceInfo","drmType","drmLoadTime","playing","played","setCompletionValues","unload","videoStartForClosedState","videoTimeStart","sendUnloadRequest","videoTimeEnd","setVideoTimeStartFromEvent","currentTime","clearValues","heartbeat","sampleData","qualitychange","sendQualityChange","qualitychange_pause","qualitychange_rebuffering","videoChange","event","setVideoTimeEndFromEvent","setPlaybackVideoPropertiesFromEvent","audioChange","setPlaybackAudioPropertiesFromEvent","audiotrack_changing","pause","paused","paused_seeking","seeked","end_play_seeking","rebuffering","buffered","videoStartFailed","sendRequest","videoStartFailedReason","reason","errorCode","code","errorMessage","message","dispatch","errorData","legacyData","segmentNames","segments","map","errorSegments","onError","data","ad","mute","isMuted","unMute","subtitle_changing","manualSourceChange","resetSourceRelatedState","playlistTransition","initialSourceChange","end","stop_collecting","release","customdatachange","width","videoPlaybackWidth","height","videoPlaybackHeight","bitrate","videoBitrate","codec","videoCodec","audioBitrate","audioCodec","setPlaybackInfoFromAdapter","info","getCurrentPlaybackInfo","getIsLiveFromConfigOrPlaybackInfo","size","videoDuration","streamFormat","mpdUrl","m3u8Url","progUrl","videoWindowWidth","videoWindowHeight","screenHeight","screenWidth","isCasting","castTech","audioLanguage","subtitleEnabled","subtitleLanguage","droppedFrames","max","platform","pageLoadType","userLanguage","screen","PlayerSize","Window","completedTotal","sendAnalyticsRequest","downloadSpeedInfo","copySample","sendAnalyticsRequestSynchronous","sendRequestSynchronous","completed","isLiveFromPlayback","getMergedCollectorConfig","mergedCollectorConfig","enabled","origin","addWatched","start","getCompletionPercentage","Number","isNaN","resetQualityChangeCountIntervalId","setInterval","ANALYTICS_QUALITY_CHANGE_COUNT_RESET_INTERVAL","increaseQualityChangeCount","isQualityChangeEventEnabled","ErrorCode","QUALITY_CHANGE_THRESHOLD_EXCEEDED","clearInterval","LICENSE_CALL_PENDING_TIMEOUT","PAGE_LOAD_TYPE_TIMEOUT","CAST_RECEIVER_CONFIG_MESSAGE","Adapter","guardAgainstNotInitializedAnalytics","analytics","internalAdapter","hasPlayerAlreadyBeenAugmented","__bitmovinAnalyticsHasBeenSetup","markPlayerInstanceAsAugmented","MESSAGE_NAMESPACE","ANALYTICS_BACKEND_BASE_URL","ANALYTICS_LICENSECALL_TIMEOUT","ANALYTICS_VIDEOSTART_TIMEOUT","ANALYTICS_QUALITY_CHANGE_COUNT_THRESHOLD","ANALYTICS_REBUFFER_TIMEOUT","ANALYTICS_MIN_SEEK_DIFFERENCE_THRESHOLD","Http_1","Settings_1","Utils_1","ErrorDetailBackend","_queue","_enabled","backendUrl","copyErrorDetailTruncateStringsAndUrls","errorDetail","maxStringLength","maxUrlLength","copyErrorDataTruncateStrings","httpRequests","_b","request","copyHttpRequestTruncateUrls","httpRequest","maxLength","lastRedirectLocation","exceptionMessage","additionalData","copyErrorDetailTruncateHttpRequests","maxRequests","limitHttpRequestsOfQueuedErrorDetails","index","send","errorDetailCopy","MAX_STRING_LENGTH","MAX_URL_LENGTH","post","push","flush","copy","element","shift","removeFromQueue","clear","findIndex","ErrorDetailTracking","_super","settingsProvider","subscribables","httpRequestTracking","errorIndex","onErrorHandler","isEnabled","httpRequestsCopy","errorId","exceptionStacktrace","subscribable","__extends","disabled","unsubscribe","configured","authenticated","numberOfHttpRequests","configure","extractConfig","configContainer","errorDetails","Feature","MP4","WEBM","HLS","DASH","MIMETypes","getMIMETypeFromFileExtension","toLowerCase","Event_1","StateMachineCallbacks_1","InternalAdapter","opts","defaultStateMachineCallbacks","_onLicenseKeyReceived","_onLicenseCallFailed","drmPerformanceInfo","previousVideoBitrate","previousAudioBitrate","qualityChangeCount","eventCallback","eventType","eventObject","stateMachine","callEvent","starttime","segmentsDownloadCount","segmentsDownloadSize","segmentsDownloadTime","avgDownloadSpeed","minDownloadSpeed","maxDownloadSpeed","avgTimeToFirstByte","resetIntervals","getCommonPlaybackInfo","clearSegments","previousState","currentState","CUSTOM_DATA_CHANGE","shouldAllowVideoQualityChange","newBitrate","setPreviousVideoBitrate","shouldAllowAudioQualityChange","setPreviousAudioBitrate","BITMOVIN_PLAYER_LICENSING_ERROR","SETUP_MISSING_LICENSE_WHITELIST","BUFFERING_TIMEOUT_REACHED","VIDEO_STARTUP_TIMEOUT_REACHED","StateMachine","Result","SUCCEEDED","NOTRANSITION","CANCELLED","PENDING","Error","INVALID_TRANSITION","PENDING_TRANSITION","INVALID_CALLBACK","WILDCARD","ASYNC","cfg","target","initial","terminal","fsm","events","callbacks","transitions","add","e","from","isArray","to","buildEvent","is","can","transition","cannot","concat","isFinished","states","keys","sort","defer","doCallback","func","beforeAnyEvent","afterAnyEvent","leaveAnyState","enterAnyState","changeState","beforeThisEvent","afterThisEvent","leaveThisState","enterThisState","beforeEvent","afterEvent","leaveState","specific","general","enterState","cancel","leave","VideoStartFailedReason_1","REBUFFERING_HEARTBEAT_INTERVALS","AnalyticsStateMachine","onEnterStateTimestamp","videoStartupTimeoutMs","rebufferTimeoutMs","currentRebufferingIntervalIndex","createStateMachine","clearVideoStartTimeout","clearRebufferingTimeoutHandle","clearRebufferingHeartbeatHandle","startRebufferingHeartbeatInterval","resetRebufferingHelpers","startRebufferingTimeoutHandle","rebufferingHeartbeatIntervalHandle","getTime","stateDuration","min","rebufferingTimeoutHandle","setTimeout","ERROR","clearTimeout","getVideoStartupFailedEventData","getReasonForVideoStartFailure","VideoStartFailedReason","PLAYER_ERROR","UNLOAD","PAGE_CLOSED","VIDEOSTART_TIMEOUT","TIMEOUT","UNKNOWN","setVideoStartTimeout","videoStartTimeout","HTML5AnalyticsStateMachine_1","VideoCompletionTracker_1","MIMETypes_1","Player_1","StreamTypes_1","HTML5InternalAdapter","mediaElement","onBeforeUnLoadEvent","HTML5","Infinity","HTML5AnalyticsStateMachine","mediaElEventHandlers","bufferingTimeout","isBuffering","lastIsLiveStatus","isPaused","isSeeking","previousMediaTime","previousClientTime","needsReadyEvent","needsFirstPlayIntent","mediaElementSet","default","setMediaElement","registerWindowEvents","getStreamSources","getStreamType","getStreamURL","Fullscreen","muted","qualityInfo","getCurrentQualityLevelInfo","unregisterMediaElement","registerMediaElement","onMaybeReady","getMIMEType","streamUrl","mimetype","getStreamTypeFromMIMEType","src","resetMedia","listenToMediaElementEvent","READY","readyState","checkQualityLevelAttributes","setVideoDuration","PLAY","onPaused","TIMECHANGED","MUTE","UN_MUTE","SEEK","SEEKED","checkSeeking","checkPlayheadProgress","onBuffering","handler","boundHandler","addEventListener","item","removeEventListener","START_BUFFERING","PAUSE","onPageClose","ended","BUFFERING_TIMECHANGED_TIMEOUT","silent","qualityLevelInfo","eventData","VIDEO_CHANGE","getSelectedSubtitleFromMediaElement","textTracks","textTrackList_1","attr","isSubtitleDisplayed","mediaTimeDif","clientTimeDif","body","callback","async","xhttp","legacyMode","XDomainRequest","XMLHttpRequest","responseCallback","DONE","responseText","sampleResponse","parse","onload","onreadystatechange","open","setRequestHeader","sendAdRequest","TimespanOverlappingType","VideoCompletionTracker","watched","overlappingTimespan","mergeWatched","getDuration","w","time1","k","time2","overlapType","getOverlappingType","Overlapping","mergeAndReplace","getOverlappingTimespan","FirstContainedInSecond","SecondContainedInFirst","None","first","second","isMomentInTimespan","moment","timespan","firstIndex","secondIndex","newWatchedTimespan","abs","filter","EventDebugging","CastTech","getSourceInfoFromBitmovinSourceConfig","progressive","progBitrate","playbackVideoData","getPlaybackVideoData","progressiveArrayIndex","id","Converter_1","Measure_1","DownloadSpeedMeter","measures","addMeasurement","measurement","httpStatus","measure","Measure","threshhold","Converter","bitsToBytes","speed","getInfo","ceil","totalTime","avgSpeed","minSpeed","maxSpeed","a","b","totalSpeed","speeds","numMeasurements","bytePerSecondToBitPerSecond","bps","bytesToBits","avg","timeToFirstByte","State","AnalyticsStateMachine_1","MANUAL_SOURCE_CHANGE","seekStartedAt","getAllStates","getAllStatesBut","SETUP","eventName","END","SOURCE_CHANGING","STARTUP","EXIT_BEFORE_VIDEOSTART","END_BUFFERING","AUDIO_CHANGE","PLAYING","REBUFFERING","PAUSED_SEEKING","QUALITYCHANGE","QUALITYCHANGE_PAUSE","SUBTITLE_CHANGE","SUBTITLE_CHANGING","AUDIOTRACK_CHANGED","AUDIOTRACK_CHANGING","START_AD","AD","END_AD","MUTING_READY","MUTING_PLAY","MUTING_PAUSE","START_CAST","CASTING","END_CAST","SOURCE_LOADED","QUALITYCHANGE_REBUFFERING","CUSTOMDATACHANGE","PLAYLIST_TRANSITION","onenterstate","startCasting","onafterevent","FINISH_QUALITYCHANGE_PAUSE","FINISH_QUALITYCHANGE","FINISH_QUALITYCHANGE_REBUFFERING","FINISH_MUTING","onleavestate","fnName","shouldSendSample","seekDuration","callbackFunction","onseek","ontimechanged","onplayerError","mapping","mimeType","Bitmovin7Adapter_1","Bitmovin7Adapter","Bitmovin8Adapter_1","Bitmovin8Adapter","CAFv3Adapter_1","CAFv3Adapter","DashjsAdapter_1","DashjsAdapter","HlsAdapter_1","HlsAdapter","HTMLVideoElementAdapter_1","HTMLVideoElementAdapter","ShakaAdapter_1","ShakaAdapter","VideoJsAdapter_1","VideojsAdapter","CDNProvider_1","CdnProvider","AnalyticsModule","hooks","getConfig","Promise","resolve","analyticsModuleInstance","analyticsModule","PlayerModule","adapters","Analytics_1","Adapter_1","Bitmovin7InternalAdapter_1","augment","originalSetup","playerSetupPromise","analyticsConfig","Bitmovin7InternalAdapter","wrapPlayerLoad","originalLoad","load","unregisterFeatures","feature","constructor","videoFormatCodecMap","avc","vp9","av1","hevc","getOwnPropertyNames","format","some","isCodecSupported","MediaSource","isTypeSupported","AdQuartile","AdAnalyticsSample_1","AdBreakSample_1","AdSample_1","ViewportTracker_1","adManifestLoadedEvents","isPlaying","adPodPosition","adCallbacks","onAdStarted","onAdFinished","onAdBreakStarted","onAdBreakFinished","onAdClicked","onAdError","onAdManifestLoaded","onPlay","onPause","onBeforeUnload","onAdSkipped","onAdQuartile","viewportTracker","ViewportTracker","getContainer","onIntersectionChanged","activeAdSample","isContainerInViewport","enterViewportTimestamp","timeInViewport","isInViewport","isLinearAdActive","beginPlayingTimestamp","updatePlayingTime","adTagConfig","adConfig","tag","type","AdBreakSample","adBreak","activeAdBreakSample","getAdManifestLoadedEvent","adStartupTimestamp","resetActiveAd","isLinear","AdSample","adStartupTime","startAd","adSample","completeAd","adDuration","skipped","skipPosition","skipPercentage","errorPosition","adBreakSample","ads","includes","adId","errorPercentage","onAdLinearityChanged","adClickthroughUrl","clickThroughUrl","clicked","clickPosition","clickPercentage","quartile","FIRST_QUARTILE","quartile1","MIDPOINT","midpoint","THIRD_QUARTILE","quartile3","closed","closePosition","closePercentage","createNewAdAnalyticsSample","analyticsSample","moduleInfo","getAdModuleInfo","AdAnalyticsSample","adModuleVersion","find","adImpressionId","percentageInViewport","timePlayed","started","currentTimeInterval","TIMEOUT_CURRENT_TIME_INTERVAL","exitPosition","playPercentage","MODULE_NAME","videoImpressionId","adManifestLoadedEvent","adFallbackIndex","manifestDownloadTime","downloadTiming","downloadTime","adReplaceContentDuration","replaceContentDuration","currentFallbackIndex","adBreakConfig","position","adPosition","adOffset","adPreloadOffset","preloadOffset","adIsPersistent","persistent","fallbackTags","adTagType","adTagUrl","adTagDetails","adTagServer","adTagPath","adScheduleTime","scheduleTime","adIdPlayer","mediaUrl","mediaFileUrl","mediaUrlDetails","mediaPath","mediaServer","adPlaybackHeight","adPlaybackWidth","adSystem","advertiser","advertiserName","apiFramework","creative","creativeAdId","creativeId","universalAdId","universalAdIdRegistry","idRegistry","universalAdIdValue","adDescription","minSuggestedDuration","survey","surveyUrl","uri","adTitle","wrapperAdsCount","wrapperAdIds","linearAd","adSkippableAfter","parseSkipAfter","skippableAfter","adSkippable","skippable","skipAfter","threshold","inViewport","options","rootMargin","observer","IntersectionObserver","entries","handleIntersect","observe","hidden","visibilityChange","handleVisibilityChange","isHidden","dispose","unobserve","disconnect","intersectionRatio","LicenseCall_1","DebuggingBackend_1","LicenseCheckingBackend_1","LongPlaytimeFilteringBackend_1","SequenceNumberBackend_1","licensingRequest","inner","createInnerBackend","decorateWithDebuggingBackend","DebuggingBackend","decorateWithBackendFromConfigIfAvailable","innerBackend","wrapBackend","LicenseCheckingBackend","LicenseCall","sequenceNumberAssigningBackend","SequenceNumberBackend","LongPlaytimeFilteringBackend","baseUrl","licenseServerUrl","response","underlying","debugFields","printFields","fields_1","f","LicensingRequest_1","QueueBackend_1","RemoteBackend_1","licenseCall","backendBaseUrl","licenseKeyReceived","licenseLazyLoadingTimeoutHandle","unsubscribeFromAdapter","promise","wrapLicenseCheckPromiseWithCallback","performLicenseCheck","licenseCallFailed","licenseLazyLoadingTimeout","QueueBackend","onLicenseCallFailed","status","LicensingResult","Denied","then","result","Granted","remoteBackend","RemoteBackend","flushTo","catch","err","queue","unloadQueue","syncQueue","adQueue","AnalyticsCall_1","hasAdModule","analyticsCall","AnalyticsCall","Utils_2","analyticsServerUrl","adAnalyticsServerUrl","trySendBeacon","getAnalyticsServerUrl","fallbackFunction","sendBeacon","getAdAnalyticsServerUrl","next","isPlayedAboveThreshold","sequenceNumber","updateSampleBeforeSending","BITMOVIN_ANALYTICS_UUID_COOKIE_NAME","cookiesEnabled","cookiesDomain","ensureNoCookiePresent","setupUserId","createAndSetNewUserId","generatedId","writeCookie","Bitmovin7AnalyticsStateMachine_1","CastTech_1","ErrorDetailBackend_1","ErrorDetailTracking_1","BitmovinProgressiveSourceHelper_1","BITMOVIN","getPlayerType","Bitmovin7AnalyticsStateMachine","register","errorDetailSubscribable","playback","isFullscreen","getFigure","offsetWidth","offsetHeight","getAudio","lang","isReady","getDroppedFrames","applySubtitleProperties","applyPlaybackQualityProperties","applySourceProperties","applyCastingProperties","addEventHandler","EVENT","ON_SOURCE_UNLOADED","SOURCE_UNLOADED","getCurrentTime","ON_SOURCE_LOADED","ON_READY","ON_CAST_STARTED","ON_CAST_STOPPED","ON_PLAY","ON_PAUSED","ON_TIME_CHANGED","ON_SEEK","ON_SEEKED","ON_STALL_STARTED","ON_STALL_ENDED","ON_AUDIO_PLAYBACK_QUALITY_CHANGED","quality","getPlaybackAudioData","ON_VIDEO_PLAYBACK_QUALITY_CHANGED","ON_FULLSCREEN_ENTER","START_FULLSCREEN","ON_FULLSCREEN_EXIT","END_FULLSCREEN","ON_AD_STARTED","ON_AD_FINISHED","ON_MUTED","ON_UNMUTED","ON_ERROR","ON_PLAYBACK_FINISHED","PLAYBACK_FINISHED","ON_DOWNLOAD_FINISHED","downloadType","ON_AUDIO_CHANGED","ON_SUBTITLE_CHANGED","handlePageClose","source","dash","hls","progSourceInfo","subtitle","getSubtitle","videoQuality","audioQuality","isAirplayActive","AirPlay","remoteControlConfig","remotecontrol","GoogleCast","WebSocket","EventDebugging_1","debuggingStates","enabledDebugging","pausedTimestamp","seekTimestamp","seekedTimestamp","seekedTimeout","seekStarted","seekEnded","PLAY_SEEKING","END_PLAY_SEEKING","onpause","onbeforeevent","elapsedTime","PAUSE_SEEK_DELAY","PLAY_SEEK","SEEKED_PAUSE_DELAY","addStatesToLog","onseeked","getStates","setEnabledDebugging","_config","_isEnabled","payload","source_changing","ready","casting","muting_ready","Bitmovin8InternalAdapter_1","playerConfig","Bitmovin8InternalAdapter","ViewMode","Bitmovin8AnalyticsStateMachine_1","DownloadSpeedMeter_1","SegmentTracker_1","HttpRequestTracking_1","AnalyticsSettings","Bitmovin8AdModule_1","Bitmovin8HttpRequestTrackingAdapter_1","Bitmovin8SegmentTrackerAdapter_1","Bitmovin8SpeedMeterAdapter_1","InternalAdapter_1","Bitmovin8AnalyticsStateMachine","speedMeter","Bitmovin8SpeedMeterAdapter","getDownloadSpeedMeter","segmentTracker","Bitmovin8SegmentTrackerAdapter","SegmentTracker","getSegmentTracker","httpRequestTrackingAdapter","Bitmovin8HttpRequestTrackingAdapter","getSegments","_adModule","lastTrackedCurrentTime","requestTracking","HttpRequestTracking","getViewMode","getSource","getDroppedVideoFrames","on","PlayerEvent","SourceUnloaded","SourceLoaded","CastStarted","CastStopped","Play","issuer","Playing","Paused","TimeChanged","Seek","allowSeeking","Seeked","StallStarted","StallEnded","AudioPlaybackQualityChanged","VideoPlaybackQualityChanged","ViewModeChanged","AdStarted","AdFinished","AdSkipped","AdError","Muted","Unmuted","PlaybackFinished","DownloadFinished","AudioChanged","SubtitleEnabled","SubtitleDisabled","LicenseValidated","handleCollectorUnload","Destroy","Bitmovin8AdModule","enabledSubtitle","subtitles","list","seekEvent","seekTarget","INITIAL_SOURCE_CHANGE","AD_STARTUP","AD_READY","AD_PAUSE","AD_PLAYING","bytes","bits","bytesToKiloBytes","kiloBytesToMegaBytes","kiloByte","download","addSegment","segment","removeSegment","Queue_1","_maxRequests","DEFAULT_MAX_REQUESTS","_httpRequestQueue","Queue","onDownloadFinishedHandler","addRequest","items","limit","offer","_items","poll","maxElements","AdModuleAPI_1","AdCallbacks","getModuleInfo","AdBreakStarted","AdBreakFinished","AdClicked","AdManifestLoaded","HttpRequestType_1","eventDispatcher","playerExports","onDownloadFinished","_c","mapHttpRequestType","HttpRequestType","MANIFEST_DASH","MANIFEST_HLS_MASTER","MANIFEST_HLS_VARIANT","MANIFEST_SMOOTH","MANIFEST_ADS","MEDIA_AUDIO","MEDIA_VIDEO","MEDIA_SUBTITLES","MEDIA_THUMBNAILS","DRM_LICENSE_WIDEVINE","DRM_LICENSE_PLAYREADY","DRM_LICENSE_FAIRPLAY","DRM_LICENSE_PRIMETIME","DRM_LICENSE_CLEARKEY","DRM_CERTIFICATE_FAIRPLAY","KEY_HLS_AES","TIME_SYNC","handleSegmentPlaybackEvent","handleOnDownloadFinishEvent","SegmentPlayback","meter","CAFv3InternalAdapter_1","CAFv3InternalAdapter","context","currentItemIndex","CHROMECAST_SHAKA","currentItem","playerManager","getPlayerManager","queueManager","getQueueManager","cast","framework","getCurrentTimeSec","stats","getStats","mediaInformation","streamType","activeAudioTrack","trackContentType","activeTextTracks","audioTracksManager","getAudioTracksManager","getActiveTrack","textTracksManager","getTextTracksManager","getActiveTracks","getCurrentItem","media","currentMediaTime","detailedErrorCode","getCurrentItemIndex","DashjsInternalAdapter_1","DashjsInternalAdapter","mediaPlayer","DASHJS","getVersion","videoEl","canPlay","getVideoElement","registerMediaElementEventsForDashJS","currentVideoQuality","getBitrateInfoListFor","getQualityFor","HlsInternalAdapter_1","HlsInternalAdapter","HlsSpeedMeterAdapter_1","HLSJS","levels","currentLevel","currentLevelObj","details","live","HlsSpeedMeterAdapter","registerHlsEvents","Events","MEDIA_ATTACHING","onMediaAttaching","MEDIA_DETACHING","onMediaDetaching","MANIFEST_LOADING","onManifestLoading","AUDIO_TRACK_SWITCHED","onAudioTrackSwitched","SUBTITLE_TRACK_SWITCH","onSubtitleLanguageSwitched","DESTROYING","onHlsError","selectedSubtitle","getSelectedSubtitleLanguage","getSelectedAudioLanguage","errorName","fatal","getErrorCodeFromHlsErrorType","audioTrack","audioTracks","subtitleDisplay","subtitleTrack","subtitleTracks","subtitleTrackController","FRAG_LOADED","handleFragmentLoadedEvent","frag","tload","trequest","total","tfirst","networkDetails","HTMLVideoElementInternalAdapter_1","HTMLVideoElementInternalAdapter","browserInfo","currentSrc","videoWidth","videoHeight","ShakaInternalAdapter_1","ShakaInternalAdapter","getMediaElement","SHAKA","videoElement","onStateChangeEventListener_1","getAssetUri","activeVideoTrack","getVariantTracks","track","active","videoBandwidth","bandwidth","VideojsInternalAdapter_1","VideojsInternalAdapter","VideoJsAnalyticsStateMachine_1","SubtitleInfo_1","_subtitleInfo","previousTime","videojs","VIDEOJS","VideojsAnalyticsStateMachine","selectedAudioLanguage","getSelectedAudioTrackLanguage","getSubtitleInfo","seeking","newSubtitleInfo","hasInfoChanged","isDifferentSubtitleInfo","newSelectedAudioLanguage","selectedPlaylist","tech_","playlists","attributes","BANDWIDTH","RESOLUTION","tech","IWillNotUseThisInPlugins","selectedPlaylist_1","attributes_1","bitrate_1","width_1","height_1","textTracks_1","AUDIOTRACK_CHANGED_PLAYING","SUBTITLE_CHANGED_PLAYING","FINISH_AUDIOTRACK_CHANGING","FINISH_SUBTITLE_CHANGING","info1","info2"],"mappings":"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","file":"bitmovinanalytics.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"analytics\"] = factory();\n\telse\n\t\troot[\"bitmovin\"] = root[\"bitmovin\"] || {}, root[\"bitmovin\"][\"analytics\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Users/ineskulenovic/Desktop/Bitmovin/bitmovin-analytics-collector/build/release\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 28);\n","/* tslint:disable:no-console */\nclass Logger {\n  constructor(showLogs: boolean = false) {\n    (this as any).showLogs = showLogs;\n  }\n\n  public setLogging(logging: boolean) {\n    (this as any).showLogs = logging;\n  }\n\n  public isLogging() {\n    return (this as any).showLogs;\n  }\n\n  public log(msg: string, ...optionalParamters: any[]) {\n    if (!(this as any).showLogs) {\n      return;\n    }\n\n    console.log(msg, ...optionalParamters);\n  }\n\n  public logTable(fields: any[]) {\n    console.table(fields);\n  }\n\n  public errorMessageToUser(msg: string, ...optionalParamters: any[]) {\n    console.error(msg, ...optionalParamters);\n  }\n\n  public error(msg: string | undefined, ...optionalParamters: any[]) {\n    if (!(this as any).showLogs) {\n      return;\n    }\n\n    console.error(msg, ...optionalParamters);\n  }\n\n  public warning(msg: string) {\n    if (!(this as any).showLogs) {\n      return;\n    }\n\n    console.warn(msg);\n  }\n\n  public warningMessageToUser(msg: string, ...optionalParameters: any[]) {\n    console.warn(msg, ...optionalParameters);\n  }\n}\n\nexport const padRight = (str: string | undefined, length: number) => {\n  const padStr = new Array(length).join(' ');\n  return (str + padStr).slice(0, length);\n};\n\nexport const logger = new Logger();\n","import {PAGE_LOAD_TYPE} from '../enums/PageLoadType';\nimport * as CustomDataUtils from '../types/CustomDataValues';\nimport {CustomDataValues} from '../types/CustomDataValues';\n\n/* tslint:disable */\nexport const validString = (text: any): boolean => {\n  return text != null && typeof text === 'string';\n};\n\nexport const isNullOrEmptyString = (text: any): boolean => {\n  return text == null || typeof text != 'string' || text.length === 0;\n};\n\nexport const validBoolean = (bool: any): boolean => {\n  return bool != null && typeof bool === 'boolean';\n};\n\nexport const validNumber = (num: any): boolean => {\n  return num != null && typeof num === 'number';\n};\n\nexport const sanitizePath = (path: string): string => {\n  return path.replace(/\\/$/g, '');\n};\n/* tslint:enable */\n\nexport const calculateTimeWithUndefined = (time?: number): number | undefined => {\n  if (time === undefined) {\n    return time;\n  }\n  time = time * 1000;\n  return Math.round(time);\n};\n\nexport const calculateTime = (time: number): number => {\n  time = time * 1000;\n  return Math.round(time);\n};\n\nexport const getCurrentTimestamp = (): number => {\n  return Date.now();\n};\n\nexport const getDurationFromTimestampToNow = (timestamp: number): number => {\n  return getCurrentTimestamp() - timestamp;\n};\n\nexport const generateUUID = (): string => {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    // tslint:disable-next-line\n    const r = (Math.random() * 16) | 0;\n    // tslint:disable-next-line\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n};\n\nexport const getCookie = (cname: string): string => {\n  const name = cname + '=';\n  const ca = document.cookie.split(';');\n  for (let c of ca) {\n    while (c.charAt(0) === ' ') {\n      c = c.substring(1);\n    }\n    if (c.indexOf(name) === 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n  return '';\n};\n\n// tslint:disable-next-line\nexport const noOp = () => {};\n\nexport const getCustomDataString = (customData: any): string | undefined => {\n  if (typeof customData === 'object') {\n    return JSON.stringify(customData);\n  } else if (typeof customData === 'function') {\n    return getCustomDataString(customData());\n  } else if (typeof customData === 'undefined') {\n    return customData;\n  } else if (typeof customData !== 'string') {\n    return String(customData);\n  }\n\n  return customData;\n};\n\nexport const transferCustomDataFields = (fromConfig: CustomDataValues, toConfig: CustomDataValues) => {\n  for (let i = 1; i <= CustomDataUtils.customDataFieldCount; i++) {\n    const customDataField = `customData${i}`;\n    toConfig[customDataField] = getCustomDataString(fromConfig[customDataField]);\n  }\n};\n\nexport const getDocumentPropWithPrefix = (prop: string): string | undefined => {\n  const prefixes = ['webkit', 'moz', 'ms', 'o'];\n  if (prop in document) {\n    return prop;\n  }\n\n  const pascalCase = prop.charAt(0).toUpperCase() + prop.slice(1);\n  for (const prefix of prefixes) {\n    if (prefix + pascalCase in document) {\n      return prefix + pascalCase;\n    }\n  }\n  return undefined;\n};\n\nexport const isVideoInFullscreen = () => {\n  const fullscreenProp = getDocumentPropWithPrefix('fullscreenElement');\n  return fullscreenProp !== undefined && document[fullscreenProp] && document[fullscreenProp].nodeName === 'VIDEO';\n};\n\nexport const getHiddenProp = (): string | undefined => {\n  return getDocumentPropWithPrefix('hidden');\n};\n\nexport function getPageLoadType(): PAGE_LOAD_TYPE {\n  // @ts-ignore\n  if (document[getHiddenProp()] === true) {\n    return PAGE_LOAD_TYPE.BACKGROUND;\n  }\n  return PAGE_LOAD_TYPE.FOREGROUND;\n}\n\nexport const getHostnameAndPathFromUrl = (url: string) => {\n  const domElement = document.createElement('a');\n  domElement.href = url;\n\n  return {hostname: domElement.hostname, path: domElement.pathname};\n};\n\nexport const calculatePercentage = (numerator?: number, denominator?: number): number | undefined => {\n  if (denominator === undefined || denominator === 0) {\n    return undefined;\n  }\n  return Math.round(((numerator || 0) / denominator) * 100);\n};\n\n/* tslint:disable */\nexport const getBrowserInfo = () => {\n  var ua = navigator.userAgent,\n    tem,\n    M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || [];\n  if (/trident/i.test(M[1])) {\n    tem = /\\brv[ :]+(\\d+)/g.exec(ua) || [];\n    return {name: 'IE', version: tem[1] || ''};\n  }\n  if (M[1] === 'Chrome') {\n    tem = ua.match(/\\b(OPR|Edge)\\/(\\d+)/);\n    if (tem != null) return {name: tem[1].replace('OPR', 'Opera'), version: tem[2]};\n  }\n  M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];\n  if ((tem = ua.match(/version\\/(\\d+)/i)) != null) M.splice(1, 1, tem[1]);\n  return {name: M[0], version: M[1]};\n};\n/* tslint:enable */\n\nexport const getURLResourceName = (url: string): string => {\n  if (url.length === 0) {\n    return '';\n  }\n  return url.split('/').pop() || '';\n};\n\nexport const joinUrls = (...args: string[]): string => {\n  return args.reduce((prev, current) => {\n    const prevUrlValue = endsWith(prev, '/') && current !== undefined ? prev.substr(0, prev.length - 1) : prev;\n    const nextUrlValue = startsWith(current, '/') ? current.substr(1) : current;\n    return prevUrlValue + '/' + nextUrlValue;\n  });\n};\n\nexport const endsWith = (str: string, suffix: string): boolean => {\n  if (String.prototype.endsWith != null) {\n    return str.endsWith(suffix);\n  }\n\n  return str.substring(str.length - suffix.length) === suffix;\n};\n\nexport const startsWith = (str: string, prefix: string): boolean => {\n  if (String.prototype.startsWith != null) {\n    return str.startsWith(prefix);\n  }\n  return str.substring(0, prefix.length) === prefix;\n};\n","import {\n  AnalyticsEventBase,\n  AudioChangeEvent,\n  ErrorEvent,\n  SourceChangeEvent,\n  VideoChangeEvent,\n} from '../types/EventData';\n\nexport enum Event {\n  READY = 'ready',\n  SOURCE_LOADED = 'sourceLoaded',\n  PLAY = 'play',\n  PLAYING = 'playing',\n  PAUSE = 'pause',\n  TIMECHANGED = 'timechanged',\n  SEEK = 'seek',\n  SEEKED = 'seeked',\n  START_CAST = 'startCasting',\n  END_CAST = 'endCasting',\n  START_BUFFERING = 'startBuffering',\n  END_BUFFERING = 'endBuffering',\n  AUDIOTRACK_CHANGED = 'audioTrackChanged',\n  AUDIO_CHANGE = 'audioChange',\n  VIDEO_CHANGE = 'videoChange',\n  START_FULLSCREEN = 'startFullscreen',\n  END_FULLSCREEN = 'endFullscreen',\n  START_AD = 'adStart',\n  SUBTITLE_CHANGE = 'subtitleChange',\n  END_AD = 'adEnd',\n  MUTE = 'mute',\n  UN_MUTE = 'unMute',\n  ERROR = 'playerError',\n  PLAYBACK_FINISHED = 'end',\n  SCREEN_RESIZE = 'resize',\n  UNLOAD = 'unload',\n  END = 'end',\n  SOURCE_UNLOADED = 'sourceUnloaded',\n  MANUAL_SOURCE_CHANGE = 'manualSourceChangeInitiated',\n  VIDEOSTART_TIMEOUT = 'VIDEOSTART_TIMEOUT',\n  CUSTOM_DATA_CHANGE = 'customDataChange',\n  PLAYLIST_TRANSITION = 'playlistTransition',\n}\n\nexport interface EventMap {\n  [Event.READY]: AnalyticsEventBase;\n  [Event.SOURCE_LOADED]: AnalyticsEventBase;\n  [Event.PLAY]: AnalyticsEventBase;\n  [Event.PLAYING]: AnalyticsEventBase;\n  [Event.PAUSE]: AnalyticsEventBase;\n  [Event.TIMECHANGED]: AnalyticsEventBase;\n  [Event.SEEK]: AnalyticsEventBase;\n  [Event.SEEKED]: AnalyticsEventBase;\n  [Event.START_CAST]: AnalyticsEventBase;\n  [Event.END_CAST]: AnalyticsEventBase;\n  [Event.START_BUFFERING]: AnalyticsEventBase;\n  [Event.END_BUFFERING]: AnalyticsEventBase;\n  [Event.AUDIOTRACK_CHANGED]: AnalyticsEventBase;\n  [Event.AUDIO_CHANGE]: AudioChangeEvent;\n  [Event.VIDEO_CHANGE]: VideoChangeEvent;\n  [Event.START_FULLSCREEN]: AnalyticsEventBase;\n  [Event.END_FULLSCREEN]: AnalyticsEventBase;\n  [Event.START_AD]: AnalyticsEventBase;\n  [Event.SUBTITLE_CHANGE]: AnalyticsEventBase;\n  [Event.END_AD]: AnalyticsEventBase;\n  [Event.MUTE]: AnalyticsEventBase;\n  [Event.UN_MUTE]: AnalyticsEventBase;\n  [Event.ERROR]: ErrorEvent;\n  [Event.PLAYBACK_FINISHED]: AnalyticsEventBase;\n  [Event.SCREEN_RESIZE]: AnalyticsEventBase;\n  [Event.UNLOAD]: AnalyticsEventBase;\n  [Event.END]: AnalyticsEventBase;\n  [Event.SOURCE_UNLOADED]: AnalyticsEventBase;\n  [Event.MANUAL_SOURCE_CHANGE]: SourceChangeEvent;\n  [Event.VIDEOSTART_TIMEOUT]: AnalyticsEventBase;\n  [Event.CUSTOM_DATA_CHANGE]: AnalyticsEventBase;\n  [Event.PLAYLIST_TRANSITION]: AnalyticsEventBase;\n}\n","export enum Player {\n  BITMOVIN = 'bitmovin',\n  JW = 'jw',\n  RADIANT = 'radiant',\n  VIDEOJS = 'videojs',\n  HLSJS = 'hlsjs',\n  SHAKA = 'shaka',\n  DASHJS = 'dashjs',\n  HTML5 = 'html5',\n  CHROMECAST_SHAKA = 'chromecast-shaka',\n}\n","import {InternalAdapterAPI} from '../adapters/internal/InternalAdapterAPI';\nimport {ErrorCode} from '../enums/ErrorCode';\nimport {PlayerSize} from '../enums/PlayerSize';\nimport {ErrorDetailTrackingSettingsProvider} from '../features/errordetails/ErrorDetailTracking';\nimport {OnErrorDetailEventObject} from '../features/errordetails/OnErrorDetailEventObject';\nimport {FeatureManager} from '../features/FeatureManager';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AuthenticationCallback} from '../types/AuthenticationCallback';\nimport {CastClientConfig} from '../types/CastClientConfig';\nimport {CustomDataValues, customDataValuesKeys} from '../types/CustomDataValues';\nimport * as EventData from '../types/EventData';\nimport {FeatureConfigContainer} from '../types/FeatureConfigContainer';\nimport {Sample} from '../types/Sample';\nimport Timespan from '../types/Timespan';\nimport {CodecHelper} from '../utils/CodecHelper';\nimport {logger} from '../utils/Logger';\nimport * as Settings from '../utils/Settings';\nimport * as Utils from '../utils/Utils';\nimport {VERSION} from '../Version';\nimport {AdAnalytics} from './AdAnalytics';\nimport {Backend} from './Backend';\nimport {BackendFactory} from './BackendFactory';\nimport {EventDispatcher, Subscribable} from './EventDispatcher';\nimport {NoOpBackend} from './NoOpBackend';\nimport {SessionPersistenceHandler} from './SessionPersistenceHandler';\n\nexport class Analytics {\n  public get version(): string {\n    return VERSION;\n  }\n  public static version: string = VERSION;\n  public static LICENSE_CALL_PENDING_TIMEOUT = 200;\n  public static PAGE_LOAD_TYPE_TIMEOUT = 200;\n  public static CAST_RECEIVER_CONFIG_MESSAGE = 'CAST_RECEIVER_CONFIG_MESSAGE';\n\n  public pageLoadTime: number = 0;\n  public playerStartupTime: number = 0;\n  public videoStartupTime: number = 0;\n  public autoplay: boolean | undefined = undefined;\n  public sample: Sample;\n  public backend!: Backend;\n  public errorDetailTrackingSettingsProvider: ErrorDetailTrackingSettingsProvider;\n  public get errorDetailSubscribable(): Subscribable<OnErrorDetailEventObject> {\n    return this.onErrorDetailEventDispatcher;\n  }\n\n  private config: AnalyticsConfig;\n  private sessionHandler: SessionPersistenceHandler;\n  private droppedSampleFrames: number = 0;\n  private startupTime: number = 0;\n  private adapter!: InternalAdapterAPI;\n  private backendFactory: BackendFactory;\n  private resetQualityChangeCountIntervalId?: number;\n  private featureManager = new FeatureManager<FeatureConfigContainer>();\n  private onErrorDetailEventDispatcher = new EventDispatcher<OnErrorDetailEventObject>();\n\n  private authenticationCallback: AuthenticationCallback = {\n    authenticationCompleted: (success: boolean, featureConfigs?: FeatureConfigContainer) => {\n      this.featureManager.configureFeatures(success, featureConfigs);\n    },\n  };\n\n  constructor(\n    config: AnalyticsConfig,\n    adapter: InternalAdapterAPI,\n    backendFactory: BackendFactory = new BackendFactory()\n  ) {\n    const that = this;\n    this.config = this.buildDefaultAnalyticsConfigValues(config);\n    this.errorDetailTrackingSettingsProvider = {\n      get domain() {\n        return that.getDomain(that.config);\n      },\n      get licenseKey() {\n        return that.config.key ?? '';\n      },\n      get impressionId() {\n        return that.getCurrentImpressionId() ?? '';\n      },\n      get collectorConfig() {\n        return that.config.config;\n      },\n    };\n\n    this.adapter = adapter;\n    this.backendFactory = backendFactory;\n    this.sessionHandler = new SessionPersistenceHandler(config);\n\n    const licenseKeyReceivedUnsubscriber = this.adapter.onLicenseKeyReceived.subscribe(\n      (eventArgs: {licenseKey: string}) => {\n        if (!this.config.key) {\n          this.config.key = eventArgs.licenseKey;\n        }\n        licenseKeyReceivedUnsubscriber();\n      }\n    );\n\n    this.sample = this.setupSample();\n    this.init();\n    this.setupStateMachineCallbacks();\n    const features = this.adapter.initialize(this);\n    this.featureManager.registerFeatures(features);\n\n    if (this.adapter.adModule) {\n      const adAnalytics = new AdAnalytics(this, this.adapter.adModule);\n    }\n\n    this.checkForErrorsInConfig(config);\n  }\n\n  public getPlayerInformationFromAdapter() {\n    const player = this.config.player || this.adapter.getPlayerName();\n    return {\n      player,\n      version: player + '-' + this.adapter.getPlayerVersion(),\n      playerTech: this.adapter.getPlayerTech(),\n    };\n  }\n\n  public updateSamplesToCastClientConfig(samples: Sample[], castClientConfig: CastClientConfig) {\n    for (const sample of samples) {\n      this.updateSampleToCastClientConfig(sample, castClientConfig);\n    }\n  }\n\n  public updateSampleToCastClientConfig(sample: Sample, castClientConfig: CastClientConfig) {\n    const {config, userId, impressionId, domain, path, language, userAgent} = castClientConfig;\n    sample.impressionId = impressionId;\n    sample.userId = userId;\n    sample.userAgent = userAgent;\n    sample.domain = domain;\n    sample.path = path;\n    sample.language = language;\n\n    this.setConfigParameters(sample, config);\n  }\n\n  public init() {\n    if (\n      this.adapter.supportsDeferredLicenseLoading !== true &&\n      (this.config.key === '' || !Utils.validString(this.config.key))\n    ) {\n      logger.error('Invalid analytics license key provided');\n      return;\n    }\n\n    logger.setLogging((this.config.debug as boolean) || false);\n\n    this.featureManager.resetFeatures();\n    this.backend = this.createBackend(this.config);\n    this.videoStartupTime = 0;\n\n    this.setConfigParameters();\n\n    this.generateNewImpressionId();\n    this.setUserId();\n\n    if (this.adapter.videoCompletionTracker) {\n      this.adapter.videoCompletionTracker.reset();\n    }\n    this.clearResetQualityChangeInterval();\n    this.adapter.resetQualityChangeCount();\n  }\n\n  public disable() {\n    this.backend = new NoOpBackend();\n  }\n\n  public setConfigParameters(sample = this.sample, config = this.config) {\n    sample.key = config.key;\n    sample.playerKey = config.playerKey;\n    if (config.player) {\n      sample.player = config.player;\n    }\n    sample.domain = this.getDomainFromConfig(config) || Utils.sanitizePath(window.location.hostname);\n    sample.cdnProvider = config.cdnProvider;\n    sample.videoId = config.videoId;\n    sample.videoTitle = config.title;\n    sample.customUserId = config.userId != null ? config.userId : config.customUserId;\n\n    Utils.transferCustomDataFields(config, sample);\n\n    sample.experimentName = config.experimentName;\n  }\n\n  public generateNewImpressionId() {\n    this.sample.impressionId = Utils.generateUUID();\n  }\n\n  public setUserId() {\n    this.sample.userId = this.sessionHandler.userId;\n  }\n\n  public setupStateMachineCallbacks() {\n    // All of these are called in the onLeaveState Method.\n    // So it's the last sample\n    this.adapter.stateMachineCallbacks.setup = (duration: number, state: string) => {\n      logger.log(\n        'Setup bitmovin analytics ' + this.sample.analyticsVersion + ' with impressionId: ' + this.sample.impressionId\n      );\n\n      this.setDuration(duration);\n      this.setState(state);\n      this.playerStartupTime = this.sample.playerStartupTime = duration;\n\n      if (window.performance && window.performance.timing) {\n        const loadTime = Utils.getCurrentTimestamp() - window.performance.timing.navigationStart;\n        this.pageLoadTime = this.sample.pageLoadTime = loadTime;\n      }\n\n      this.startupTime = duration;\n\n      this.sendAnalyticsRequestAndClearValues();\n\n      this.sample.pageLoadTime = 0;\n    };\n\n    this.adapter.stateMachineCallbacks.startup = (duration: number, state: string) => {\n      this.setDuration(duration);\n      this.videoStartupTime = this.sample.videoStartupTime = duration;\n      this.sample.supportedVideoCodecs = CodecHelper.supportedVideoFormats;\n      this.setState(state);\n\n      if (this.startupTime > 0) {\n        this.startupTime += duration;\n      }\n      this.sample.startupTime = this.startupTime;\n      this.autoplay = this.sample.autoplay = this.adapter.getAutoPlay();\n\n      const drmPerformance = this.adapter.getDrmPerformanceInfo();\n      if (drmPerformance != null) {\n        this.sample.drmType = drmPerformance.drmType;\n        this.sample.drmLoadTime = drmPerformance.drmLoadTime;\n      }\n\n      this.sendAnalyticsRequestAndClearValues();\n      this.sample.autoplay = undefined;\n    };\n\n    this.adapter.stateMachineCallbacks.playing = (duration: number, state: string) => {\n      this.setDuration(duration);\n      this.setState(state);\n      this.sample.played = duration;\n      this.setCompletionValues();\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.unload = (duration: number, state: string) => {\n      let videoStartForClosedState = this.sample.videoTimeStart;\n      if (state === 'playing') {\n        this.setDuration(duration);\n        this.setState(state);\n        this.sample.played = duration;\n        this.setCompletionValues();\n        this.sendUnloadRequest();\n        if (Utils.validNumber(this.sample.videoTimeEnd)) {\n          videoStartForClosedState = this.sample.videoTimeEnd! / 1000;\n        }\n      }\n\n      if (this.videoStartupTime > 0) {\n        this.adapter.stateMachineCallbacks.setVideoTimeStartFromEvent({currentTime: videoStartForClosedState});\n        this.clearValues();\n        this.setState('closed');\n        this.sendUnloadRequest();\n      }\n    };\n\n    this.adapter.stateMachineCallbacks.heartbeat = (\n      duration: number,\n      state: string,\n      sampleData: Pick<Sample, 'played'> | Pick<Sample, 'buffered'>\n    ) => {\n      this.setState(state);\n      this.setDuration(duration);\n\n      this.sample = {\n        ...this.sample,\n        ...sampleData,\n      };\n\n      if (state === 'playing') {\n        this.setCompletionValues();\n      }\n\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.qualitychange = (duration: number, state: string) => {\n      this.sendQualityChange(state, duration);\n    };\n\n    this.adapter.stateMachineCallbacks.qualitychange_pause = (duration: number, state: string) => {\n      this.sendQualityChange(state, duration);\n    };\n\n    this.adapter.stateMachineCallbacks.qualitychange_rebuffering = (duration: number, state: string) => {\n      this.sendQualityChange(state, duration);\n    };\n\n    this.adapter.stateMachineCallbacks.videoChange = (event: any) => {\n      this.adapter.stateMachineCallbacks.setVideoTimeEndFromEvent(event);\n      this.adapter.stateMachineCallbacks.setVideoTimeStartFromEvent(event);\n      this.setPlaybackVideoPropertiesFromEvent(event);\n    };\n\n    this.adapter.stateMachineCallbacks.audioChange = (event: any) => {\n      this.adapter.stateMachineCallbacks.setVideoTimeEndFromEvent(event);\n      this.adapter.stateMachineCallbacks.setVideoTimeStartFromEvent(event);\n      this.setPlaybackAudioPropertiesFromEvent(event);\n    };\n\n    this.adapter.stateMachineCallbacks.audiotrack_changing = () => {\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.pause = (duration: number, state: string) => {\n      this.setDuration(duration);\n      this.setState(state);\n\n      this.sample.paused = duration;\n\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.paused_seeking = (duration: number, state: string) => {\n      this.setDuration(duration);\n      this.setState(state);\n\n      this.sample.seeked = duration;\n\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.end_play_seeking = (duration: number, state: string) => {\n      this.setState(state);\n      this.setDuration(duration);\n\n      this.sample.seeked = duration;\n\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.rebuffering = (duration: number, state: string) => {\n      this.setDuration(duration);\n      this.setState(state);\n\n      this.sample.buffered = duration;\n\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.videoStartFailed = (\n      event: Readonly<EventData.VideoStartFailedEvent>,\n      sendRequest = true\n    ) => {\n      this.sample.videoStartFailed = true;\n      this.sample.videoStartFailedReason = event.reason.reason;\n      if (event.reason.errorCode != null) {\n        this.sample.errorCode = event.reason.errorCode.code;\n        this.sample.errorMessage = event.reason.errorCode.message;\n        if (sendRequest) {\n          this.onErrorDetailEventDispatcher.dispatch({\n            ...event.reason.errorCode,\n          });\n        }\n      }\n      if (sendRequest) {\n        this.sendAnalyticsRequestAndClearValues();\n      }\n    };\n\n    this.adapter.stateMachineCallbacks.error = (event: Readonly<EventData.ErrorEvent>) => {\n      this.adapter.stateMachineCallbacks.setVideoTimeEndFromEvent(event);\n      this.adapter.stateMachineCallbacks.setVideoTimeStartFromEvent(event);\n\n      this.setState('error');\n      this.sample.errorCode = event.code;\n      this.sample.errorMessage = event.message;\n      this.sample.errorData = JSON.stringify(event.legacyData);\n\n      const segmentNames = this.adapter.segments.map((s) => s.name);\n      this.sample.errorSegments = segmentNames;\n\n      if (this.adapter.onError) {\n        this.adapter.onError();\n      }\n\n      this.onErrorDetailEventDispatcher.dispatch({\n        code: event.code,\n        message: event.message,\n        errorData: event.data,\n      });\n      this.sendAnalyticsRequestAndClearValues();\n\n      delete this.sample.errorCode;\n      delete this.sample.errorMessage;\n      delete this.sample.errorData;\n    };\n\n    this.adapter.stateMachineCallbacks.ad = (duration: number, state: string) => {\n      this.setDuration(duration);\n      this.setState(state);\n      this.sample.ad = duration;\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.mute = () => {\n      this.sample.isMuted = true;\n    };\n\n    this.adapter.stateMachineCallbacks.unMute = () => {\n      this.sample.isMuted = false;\n    };\n\n    this.adapter.stateMachineCallbacks.subtitle_changing = () => {\n      this.sendAnalyticsRequestAndClearValues();\n    };\n\n    this.adapter.stateMachineCallbacks.setVideoTimeEndFromEvent = (event: any) => {\n      if (Utils.validNumber(event.currentTime)) {\n        this.sample.videoTimeEnd = Utils.calculateTime(event.currentTime);\n      }\n    };\n\n    this.adapter.stateMachineCallbacks.setVideoTimeStartFromEvent = (event: any) => {\n      if (Utils.validNumber(event.currentTime)) {\n        this.sample.videoTimeStart = Utils.calculateTime(event.currentTime);\n      }\n    };\n\n    this.adapter.stateMachineCallbacks.manualSourceChange = (event: {config: AnalyticsConfig}) => {\n      this.adapter.resetSourceRelatedState();\n      this.sample = this.setupSample();\n      this.startupTime = 0;\n      this.config = event.config ? event.config : this.config;\n      this.init();\n    };\n\n    this.adapter.stateMachineCallbacks.playlistTransition = (event: EventData.AnalyticsEventBase) => {\n      this.sample = this.setupSample();\n      this.startupTime = 0;\n      // init is needed because of resetting sequence number which\n      // is done inside SequenceNumberBackend\n      this.init();\n    };\n\n    this.adapter.stateMachineCallbacks.initialSourceChange = (event: {config: AnalyticsConfig}) => {\n      this.config = event.config;\n      this.setConfigParameters();\n    };\n\n    // The video has ended and we set up for a new impression\n    this.adapter.stateMachineCallbacks.end = () => {\n      this.sample = this.setupSample();\n      this.startupTime = 0;\n      this.init();\n    };\n\n    this.adapter.stateMachineCallbacks.stop_collecting = () => {\n      this.disable();\n    };\n\n    this.adapter.stateMachineCallbacks.release = () => {\n      this.clearResetQualityChangeInterval();\n    };\n\n    this.adapter.stateMachineCallbacks.customdatachange = (\n      duration?: number,\n      state?: string,\n      event?: {values: CustomDataValues}\n    ) => {\n      if (event && event.values) {\n        this.changeCustomData(event.values);\n      }\n    };\n  }\n\n  public guardAgainstMissingVideoTitle = (oldConfig: AnalyticsConfig, newConfig: AnalyticsConfig) => {\n    if (oldConfig && newConfig && oldConfig.title && !newConfig.title) {\n      // TODO: Better description\n      logger.error('The new analytics configuration does not contain the field title');\n    }\n  };\n\n  public guardAgainstMissingIsLive = (oldConfig: AnalyticsConfig, newConfig: AnalyticsConfig) => {\n    if (oldConfig != null && newConfig != null && oldConfig.isLive && newConfig.isLive == null) {\n      logger.error(\n        'The new analytics configuration does not contain the field `isLive`. It will default to `false` which might be unintended? Once stream playback information is available the type will be populated.'\n      );\n    }\n  };\n\n  public sourceChange = (config: AnalyticsConfig) => {\n    logger.log('Processing Source Change for Analytics', config);\n\n    this.guardAgainstMissingVideoTitle(this.config, config);\n    this.guardAgainstMissingIsLive(this.config, config);\n\n    const newConfig = this.getMergedAnalyticsConfig(config);\n\n    this.adapter.sourceChange(newConfig, Utils.getCurrentTimestamp());\n  };\n\n  public setCustomDataOnce = (values: CustomDataValues) => {\n    const oldConfig = {...this.config};\n    this.setState('customdatachange');\n    this.changeCustomData(values);\n    this.sendAnalyticsRequestAndClearValues();\n    // this method doesn't call changeCustomData() second time because in that method we have check for null values\n    // to prevent overriding existing customData values with null if some field in object doesn't have value\n    // because of that if some customData field had previous value null and it got changed to something else\n    // it will not be possible to return it back to null using that method\n    this.config = {...oldConfig};\n    this.setConfigParameters();\n  };\n\n  public setCustomData = (values: CustomDataValues) => {\n    this.adapter.setCustomData(values);\n  };\n\n  public getCurrentImpressionId = (): string | undefined => {\n    return this.sample.impressionId;\n  };\n\n  public setDuration(duration: number) {\n    this.sample.duration = duration;\n  }\n\n  public setState(state: string) {\n    this.sample.state = state;\n  }\n\n  public setPlaybackVideoPropertiesFromEvent(event: any) {\n    if (Utils.validNumber(event.width)) {\n      this.sample.videoPlaybackWidth = event.width;\n    }\n    if (Utils.validNumber(event.height)) {\n      this.sample.videoPlaybackHeight = event.height;\n    }\n    if (Utils.validNumber(event.bitrate)) {\n      this.sample.videoBitrate = event.bitrate;\n    }\n    if (Utils.validString(event.codec)) {\n      this.sample.videoCodec = event.codec;\n    }\n  }\n\n  public setPlaybackAudioPropertiesFromEvent(event: any) {\n    if (Utils.validNumber(event.bitrate)) {\n      this.sample.audioBitrate = event.bitrate;\n    }\n    if (Utils.validString(event.codec)) {\n      this.sample.audioCodec = event.codec;\n    }\n  }\n\n  public setPlaybackInfoFromAdapter() {\n    const info = this.adapter.getCurrentPlaybackInfo();\n    if (!info) {\n      return;\n    }\n\n    this.sample.isLive = this.getIsLiveFromConfigOrPlaybackInfo(this.config, info.isLive);\n\n    if (Utils.validString(info.size)) {\n      this.sample.size = info.size;\n    }\n    if (Utils.validString(info.playerTech)) {\n      this.sample.playerTech = info.playerTech;\n    }\n    if (Utils.validNumber(info.videoDuration)) {\n      this.sample.videoDuration = Utils.calculateTime(info.videoDuration || 0);\n    }\n    if (Utils.validString(info.streamFormat)) {\n      this.sample.streamFormat = info.streamFormat;\n    }\n    if (Utils.validString(info.mpdUrl)) {\n      this.sample.mpdUrl = info.mpdUrl;\n    }\n    if (Utils.validString(info.m3u8Url)) {\n      this.sample.m3u8Url = info.m3u8Url;\n    }\n    if (Utils.validString(info.progUrl)) {\n      this.sample.progUrl = info.progUrl;\n    }\n    if (Utils.validNumber(info.videoWindowWidth)) {\n      this.sample.videoWindowWidth = info.videoWindowWidth;\n    }\n    if (Utils.validNumber(info.videoWindowHeight)) {\n      this.sample.videoWindowHeight = info.videoWindowHeight;\n    }\n    if (Utils.validNumber(info.screenHeight)) {\n      this.sample.screenHeight = info.screenHeight;\n    }\n    if (Utils.validNumber(info.screenWidth)) {\n      this.sample.screenWidth = info.screenWidth;\n    }\n    if (Utils.validNumber(info.videoPlaybackHeight)) {\n      this.sample.videoPlaybackHeight = info.videoPlaybackHeight;\n    }\n    if (Utils.validNumber(info.videoPlaybackWidth)) {\n      this.sample.videoPlaybackWidth = info.videoPlaybackWidth;\n    }\n    if (Utils.validNumber(info.videoBitrate)) {\n      this.sample.videoBitrate = info.videoBitrate;\n    }\n    if (Utils.validNumber(info.audioBitrate)) {\n      this.sample.audioBitrate = info.audioBitrate;\n    }\n    if (Utils.validBoolean(info.isMuted)) {\n      this.sample.isMuted = info.isMuted;\n    }\n    if (Utils.validBoolean(info.isCasting)) {\n      this.sample.isCasting = info.isCasting;\n    }\n    if (Utils.validString(info.castTech)) {\n      this.sample.castTech = info.castTech;\n    }\n    if (Utils.validString(info.videoTitle) && !this.config.title) {\n      this.sample.videoTitle = info.videoTitle;\n    }\n    if (Utils.validString(info.audioCodec)) {\n      this.sample.audioCodec = info.audioCodec;\n    }\n    if (Utils.validString(info.videoCodec)) {\n      this.sample.videoCodec = info.videoCodec;\n    }\n    if (Utils.validString(info.audioLanguage)) {\n      this.sample.audioLanguage = info.audioLanguage;\n    }\n    if (Utils.validBoolean(info.subtitleEnabled)) {\n      this.sample.subtitleEnabled = info.subtitleEnabled;\n    }\n    if (Utils.validString(info.subtitleLanguage)) {\n      this.sample.subtitleLanguage = info.subtitleLanguage;\n    } else {\n      this.sample.subtitleLanguage = undefined;\n    }\n    if (Utils.validNumber(info.droppedFrames)) {\n      this.sample.droppedFrames = Math.max(info.droppedFrames - this.droppedSampleFrames, 0);\n      this.droppedSampleFrames = info.droppedFrames;\n    }\n  }\n\n  public setupSample(): Sample {\n    this.droppedSampleFrames = 0;\n\n    return {\n      platform: 'web',\n      playerStartupTime: 0,\n      pageLoadType: Utils.getPageLoadType(),\n      path: Utils.sanitizePath(window.location.pathname),\n      language: navigator.language || (navigator as any).userLanguage,\n      userAgent: navigator.userAgent,\n      screenWidth: screen.width,\n      screenHeight: screen.height,\n      isLive: false,\n      videoDuration: 0,\n      size: PlayerSize.Window,\n      time: 0,\n      videoWindowWidth: 0,\n      videoWindowHeight: 0,\n      droppedFrames: 0,\n      played: 0,\n      buffered: 0,\n      paused: 0,\n      ad: 0,\n      seeked: 0,\n      videoPlaybackWidth: 0,\n      videoPlaybackHeight: 0,\n      videoBitrate: 0,\n      audioBitrate: 0,\n      videoTimeStart: 0,\n      videoTimeEnd: 0,\n      videoStartupTime: 0,\n      duration: 0,\n      startupTime: 0,\n      analyticsVersion: VERSION,\n      pageLoadTime: 0,\n      completedTotal: 0,\n      ...this.getPlayerInformationFromAdapter(),\n    };\n  }\n\n  public sendAnalyticsRequest() {\n    this.setPlaybackInfoFromAdapter();\n    this.sample.time = Utils.getCurrentTimestamp();\n    this.sample.downloadSpeedInfo = this.adapter.downloadSpeedInfo;\n\n    const copySample = {...this.sample};\n    this.backend.sendRequest(copySample);\n  }\n\n  public sendAnalyticsRequestAndClearValues() {\n    this.sendAnalyticsRequest();\n    this.clearValues();\n  }\n\n  public sendUnloadRequest() {\n    this.backend.sendUnloadRequest(this.sample);\n  }\n\n  public sendAnalyticsRequestSynchronous() {\n    this.backend.sendRequestSynchronous(this.sample);\n  }\n\n  public clearValues() {\n    this.sample.ad = 0;\n    this.sample.paused = 0;\n    this.sample.played = 0;\n    this.sample.seeked = 0;\n    this.sample.buffered = 0;\n\n    this.sample.playerStartupTime = 0;\n    this.sample.videoStartupTime = 0;\n    this.sample.startupTime = 0;\n    this.sample.castTech = undefined;\n\n    this.sample.duration = 0;\n    this.sample.droppedFrames = 0;\n\n    this.sample.drmLoadTime = undefined;\n\n    this.sample.videoStartFailed = undefined;\n    this.sample.videoStartFailedReason = undefined;\n\n    this.sample.completed = undefined;\n    this.adapter.clearValues();\n  }\n\n  public getIsLiveFromConfigOrPlaybackInfo(config: AnalyticsConfig, isLiveFromPlayback?: boolean): boolean {\n    if (isLiveFromPlayback == null) {\n      return config.isLive || false;\n    }\n    return Utils.validBoolean(isLiveFromPlayback) ? isLiveFromPlayback : false;\n  }\n\n  public getMergedCollectorConfig(newConfig: AnalyticsConfig, oldConfig = this.config) {\n    let mergedCollectorConfig = (oldConfig || {}).config;\n    if (newConfig != null) {\n      mergedCollectorConfig = {...mergedCollectorConfig, enabled: true, ...newConfig.config};\n    }\n    return mergedCollectorConfig;\n  }\n\n  public getMergedAnalyticsConfig(newConfig: AnalyticsConfig, oldConfig = this.config): AnalyticsConfig {\n    const mergedCollectorConfig = this.getMergedCollectorConfig(newConfig, oldConfig);\n    const mergedConfig = {\n      ...oldConfig,\n      ...newConfig,\n      ...{config: mergedCollectorConfig},\n    };\n    return mergedConfig;\n  }\n\n  /**\n   * This method sanitizes the input and updates the analytics config.\n   * @param values Object containing the customData and other fields\n   */\n  private changeCustomData = (values: CustomDataValues) => {\n    const filterValuesFromHash = (input: CustomDataValues) => {\n      const retVal: CustomDataValues = {};\n      customDataValuesKeys.forEach((key) => {\n        if (input[key]) {\n          retVal[key] = input[key];\n        }\n      });\n      return retVal;\n    };\n\n    this.config = {\n      ...this.config,\n      ...filterValuesFromHash(values),\n    };\n    this.setConfigParameters();\n  };\n\n  private buildDefaultAnalyticsConfigValues(config: AnalyticsConfig): AnalyticsConfig {\n    if (!Utils.validBoolean(config.isLive)) {\n      config.isLive = false;\n    }\n    return config;\n  }\n\n  private checkForErrorsInConfig(config: AnalyticsConfig) {\n    if (config.customUserId != null && config.userId != null) {\n      logger.warning(\n        'Configuration Warning: \\nCustomUserId and UserId are set in the config \\nValue of UserId will be used in sample \\nPlease only use one configuartion field to set your userId'\n      );\n    }\n  }\n\n  private getDomainFromConfig(config: AnalyticsConfig) {\n    const collectorConfig = config.config;\n    return collectorConfig != null && collectorConfig.origin != null ? collectorConfig.origin : undefined;\n  }\n\n  private createBackend(config: AnalyticsConfig): Backend {\n    const domain = this.getDomain(config);\n    return this.backendFactory.createBackend(\n      config,\n      {key: config.key, domain, version: VERSION},\n      this.adapter,\n      this.authenticationCallback\n    );\n  }\n\n  private getDomain(config: AnalyticsConfig) {\n    const domainFromConfig = this.getDomainFromConfig(config);\n    return domainFromConfig || Utils.sanitizePath(window.location.hostname);\n  }\n\n  private setCompletionValues() {\n    if (this.adapter.videoCompletionTracker) {\n      const completed = this.adapter.videoCompletionTracker.addWatched({\n        start: this.sample.videoTimeStart,\n        end: this.sample.videoTimeEnd,\n      } as Timespan);\n      const completedTotal = this.adapter.videoCompletionTracker.getCompletionPercentage();\n\n      if (!Number.isNaN(completed) && !Number.isNaN(completedTotal)) {\n        this.sample.completed = completed;\n        this.sample.completedTotal = completedTotal;\n      }\n    }\n  }\n\n  private sendQualityChange(state: string, duration: number): void {\n    if (this.resetQualityChangeCountIntervalId == null) {\n      this.resetQualityChangeCountIntervalId = window.setInterval(() => {\n        this.adapter.resetQualityChangeCount();\n      }, Settings.ANALYTICS_QUALITY_CHANGE_COUNT_RESET_INTERVAL);\n    }\n\n    this.adapter.increaseQualityChangeCount();\n    if (!this.adapter.isQualityChangeEventEnabled()) {\n      this.setDuration(duration);\n      this.adapter.stateMachineCallbacks.error({\n        ...ErrorCode.QUALITY_CHANGE_THRESHOLD_EXCEEDED,\n        legacyData: undefined,\n        currentTime: undefined,\n        data: {\n          /*TODO additionalData: 'Add description for this error'*/\n        },\n      });\n    } else {\n      this.setDuration(duration);\n      this.setState(state);\n      this.sendAnalyticsRequestAndClearValues();\n    }\n  }\n\n  private clearResetQualityChangeInterval() {\n    if (this.resetQualityChangeCountIntervalId != null) {\n      window.clearInterval(this.resetQualityChangeCountIntervalId);\n      delete this.resetQualityChangeCountIntervalId;\n    }\n  }\n}\n","import {Analytics} from '../core/Analytics';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {CustomDataValues} from '../types/CustomDataValues';\nimport {logger} from '../utils/Logger';\nimport {InternalAdapterAPI} from './internal/InternalAdapterAPI';\n\nexport abstract class Adapter {\n  protected analytics!: Analytics;\n  protected internalAdapter!: InternalAdapterAPI;\n\n  public getCurrentImpressionId(): string | undefined {\n    if (!this.guardAgainstNotInitializedAnalytics()) {\n      return;\n    }\n    return this.analytics.getCurrentImpressionId();\n  }\n\n  public setCustomData(values: CustomDataValues) {\n    if (!this.guardAgainstNotInitializedAnalytics()) {\n      return;\n    }\n    this.internalAdapter.setCustomData(values);\n  }\n\n  public setCustomDataOnce(values: CustomDataValues) {\n    if (!this.guardAgainstNotInitializedAnalytics()) {\n      return;\n    }\n    this.analytics.setCustomDataOnce(values);\n  }\n\n  public sourceChange(config: AnalyticsConfig) {\n    if (!this.guardAgainstNotInitializedAnalytics()) {\n      return;\n    }\n    this.analytics.sourceChange(config);\n  }\n\n  // Checks if analytics is already initialized on this player instance\n  protected hasPlayerAlreadyBeenAugmented(player): boolean {\n    return (player as any).__bitmovinAnalyticsHasBeenSetup;\n  }\n  // Marks the player instance as already instrumented by analytics\n  protected markPlayerInstanceAsAugmented(player) {\n    (player as any).__bitmovinAnalyticsHasBeenSetup = true;\n  }\n\n  private guardAgainstNotInitializedAnalytics(): boolean {\n    if (!this.analytics) {\n      logger.log(\"Bitmovin Analytics: Adapter hasn't been initialized yet\");\n      return false;\n    }\n    return true;\n  }\n}\n","export const MESSAGE_NAMESPACE = 'urn:x-cast:com.bitmovin.analytics.cast';\nexport const ANALYTICS_BACKEND_BASE_URL = 'https://analytics-ingress-global.bitmovin.com';\n\nexport const ANALYTICS_LICENSECALL_TIMEOUT = 1000 * 60;\nexport const ANALYTICS_VIDEOSTART_TIMEOUT = 1000 * 60; // in milliseconds\n\nexport const ANALYTICS_QUALITY_CHANGE_COUNT_THRESHOLD = 50;\nexport const ANALYTICS_QUALITY_CHANGE_COUNT_RESET_INTERVAL = 60 * 60 * 1000;\n\n/**\n * Time (in milliseconds) of consecutive buffering until a REBUFFER_TIMEOUT_ERROR is raised.\n */\nexport const ANALYTICS_REBUFFER_TIMEOUT = 1000 * 60 * 2;\n\n/**\n * minimal time (in seconds) a seek event should have in order to be recogniced as seek\n */\nexport const ANALYTICS_MIN_SEEK_DIFFERENCE_THRESHOLD = 3;\n","import {CollectorConfig} from '../../types/AnalyticsConfig';\nimport {post} from '../../utils/Http';\nimport {ANALYTICS_BACKEND_BASE_URL} from '../../utils/Settings';\nimport {joinUrls} from '../../utils/Utils';\nimport {HttpRequest} from '../httprequesttracking/HttpRequest';\nimport {ErrorData} from './ErrorData';\nimport {ErrorDetail} from './ErrorDetail';\n\nexport class ErrorDetailBackend {\n  public get queue(): ReadonlyArray<ErrorDetail> {\n    return this._queue;\n  }\n\n  public get enabled(): boolean {\n    return this._enabled;\n  }\n\n  public set enabled(value: boolean) {\n    this._enabled = value;\n  }\n\n  public static copyErrorDetailTruncateStringsAndUrls(\n    errorDetail: ErrorDetail,\n    maxStringLength: number,\n    maxUrlLength: number\n  ): ErrorDetail {\n    return {\n      ...errorDetail,\n      message: errorDetail.message?.substr(0, maxStringLength),\n      data: this.copyErrorDataTruncateStrings(errorDetail.data, maxStringLength),\n      httpRequests: errorDetail.httpRequests?.map((request) => this.copyHttpRequestTruncateUrls(request, maxUrlLength)),\n    };\n  }\n\n  public static copyHttpRequestTruncateUrls(httpRequest: HttpRequest, maxLength: number): HttpRequest {\n    return {\n      ...httpRequest,\n      url: httpRequest.url?.substr(0, maxLength),\n      lastRedirectLocation: httpRequest.lastRedirectLocation?.substr(0, maxLength),\n    };\n  }\n\n  public static copyErrorDataTruncateStrings(errorData: ErrorData, maxStringLength: number): ErrorData {\n    return {\n      ...errorData,\n      exceptionMessage: errorData.exceptionMessage?.substr(0, maxStringLength),\n      additionalData: errorData.additionalData?.substr(0, maxStringLength),\n    };\n  }\n\n  public static copyErrorDetailTruncateHttpRequests(errorDetail: ErrorDetail, maxRequests: number): ErrorDetail {\n    return {\n      ...errorDetail,\n      httpRequests: errorDetail.httpRequests?.slice(-maxRequests),\n    };\n  }\n\n  private static MAX_URL_LENGTH = 200;\n  private static MAX_STRING_LENGTH = 400;\n\n  private readonly backendUrl: string;\n  private readonly _queue: ErrorDetail[] = [];\n  private _enabled: boolean = false;\n\n  constructor(collectorConfig: CollectorConfig | undefined) {\n    this.backendUrl = joinUrls(collectorConfig?.backendUrl ?? ANALYTICS_BACKEND_BASE_URL, '/analytics/error');\n  }\n\n  public limitHttpRequestsOfQueuedErrorDetails(max: number) {\n    this._queue.forEach((value, index) => {\n      this._queue[index] = ErrorDetailBackend.copyErrorDetailTruncateHttpRequests(value, max);\n    });\n  }\n\n  public send(errorDetail: ErrorDetail) {\n    const errorDetailCopy = ErrorDetailBackend.copyErrorDetailTruncateStringsAndUrls(\n      errorDetail,\n      ErrorDetailBackend.MAX_STRING_LENGTH,\n      ErrorDetailBackend.MAX_URL_LENGTH\n    );\n    if (this.enabled) {\n      post(this.backendUrl, errorDetailCopy, () => {});\n    } else {\n      this._queue.push(errorDetailCopy);\n    }\n  }\n\n  public flush() {\n    const copy = [...this._queue];\n    let element = copy.shift();\n    while (element != null) {\n      this.removeFromQueue(element);\n      this.send(element);\n      element = copy.shift();\n    }\n  }\n\n  public clear() {\n    this._queue.splice(0, this._queue.length);\n  }\n\n  private removeFromQueue(element: ErrorDetail) {\n    const index = this._queue.findIndex((value) => value === element);\n    if (index >= 0) {\n      this._queue.splice(index, 1);\n    }\n  }\n}\n","import {Subscribable} from '../../core/EventDispatcher';\nimport {CollectorConfig} from '../../types/AnalyticsConfig';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {logger} from '../../utils/Logger';\nimport {getCurrentTimestamp} from '../../utils/Utils';\nimport {VERSION} from '../../Version';\nimport {Feature} from '../Feature';\nimport {HttpRequestTracking} from '../httprequesttracking/HttpRequestTracking';\nimport {ErrorDetail} from './ErrorDetail';\nimport {ErrorDetailBackend} from './ErrorDetailBackend';\nimport {ErrorDetailTrackingConfig} from './ErrorDetailTrackingConfig';\nimport {OnErrorDetailEventObject} from './OnErrorDetailEventObject';\n\nexport interface ErrorDetailTrackingSettingsProvider {\n  readonly licenseKey: string;\n  readonly domain: string;\n  readonly impressionId: string;\n  readonly collectorConfig?: CollectorConfig;\n}\n\nexport class ErrorDetailTracking extends Feature<FeatureConfigContainer, ErrorDetailTrackingConfig> {\n  private errorIndex = 0;\n\n  constructor(\n    private settingsProvider: ErrorDetailTrackingSettingsProvider,\n    private backend: ErrorDetailBackend,\n    private subscribables: Array<Subscribable<OnErrorDetailEventObject>>,\n    private httpRequestTracking: HttpRequestTracking | undefined\n  ) {\n    super();\n    subscribables.forEach((subscribable) => subscribable.subscribe(this.onErrorHandler));\n  }\n\n  public reset(): void {\n    this.httpRequestTracking?.reset();\n    this.errorIndex = 0;\n  }\n\n  public enabled(): void {\n    this.backend.enabled = true;\n    this.backend.flush();\n  }\n\n  public disabled(): void {\n    this.errorIndex = 0;\n    this.httpRequestTracking?.disable();\n    this.backend.clear();\n    this.subscribables.forEach((subscribable) => subscribable.unsubscribe(this.onErrorHandler));\n  }\n\n  public configured(authenticated: boolean, config?: ErrorDetailTrackingConfig): void {\n    const maxRequests = Math.max(config?.numberOfHttpRequests ?? 0, 0);\n    this.httpRequestTracking?.configure(maxRequests);\n    this.backend.limitHttpRequestsOfQueuedErrorDetails(maxRequests);\n  }\n\n  public extractConfig(configContainer: FeatureConfigContainer): ErrorDetailTrackingConfig | undefined {\n    return configContainer.errorDetails;\n  }\n\n  private onErrorHandler = (event: OnErrorDetailEventObject) => {\n    try {\n      if (!this.isEnabled) {\n        return;\n      }\n\n      const httpRequests = this.httpRequestTracking?.httpRequests;\n      const httpRequestsCopy = httpRequests == null ? undefined : [...httpRequests];\n      const errorIndex = this.errorIndex;\n      this.errorIndex++;\n\n      const errorDetail: ErrorDetail = {\n        platform: 'web',\n        licenseKey: this.settingsProvider.licenseKey,\n        domain: this.settingsProvider.domain,\n        impressionId: this.settingsProvider.impressionId,\n        analyticsVersion: VERSION,\n        errorId: errorIndex,\n        timestamp: getCurrentTimestamp(),\n        code: event.code,\n        message: event.message,\n        data: event.errorData ?? {\n          additionalData: undefined,\n          exceptionMessage: undefined,\n          exceptionStacktrace: undefined,\n        },\n        httpRequests: httpRequestsCopy,\n      };\n\n      logger.log(`ErrorDetailTracking.onError: ${JSON.stringify(errorDetail)}`);\n      this.backend.send(errorDetail);\n    } catch (error) {\n      logger.error(`ErrorDetailTracking.onError: Error in handler`, error);\n    }\n  };\n}\n","import {endsWith} from '../utils/Utils';\n\nconst MP4 = 'video/mp4';\nconst WEBM = 'video/webm';\nconst HLS = 'application/x-mpegURL';\nconst DASH = 'application/dash+xml';\n\n// tslint:disable-next-line:variable-name\nexport const MIMETypes = {\n  MP4,\n  WEBM,\n  HLS,\n  DASH,\n};\n\nexport function getMIMETypeFromFileExtension(path: string): string | undefined {\n  path = path.split(/[?#]/)[0].toLowerCase();\n\n  if (endsWith(path, '.m3u8')) {\n    return HLS;\n  }\n  if (endsWith(path, '.mp4') || endsWith(path, '.m4v') || endsWith(path, '.m4a')) {\n    return MP4;\n  }\n  if (endsWith(path, '.webm')) {\n    return WEBM;\n  }\n  if (endsWith(path, '.mpd')) {\n    return DASH;\n  }\n}\n","export enum PlayerSize {\n  Window = 'WINDOW',\n  Fullscreen = 'FULLSCREEN',\n}\n","import {AnalyticsStateMachine} from '../../analyticsStateMachines/AnalyticsStateMachine';\nimport {EventDispatcher} from '../../core/EventDispatcher';\nimport {Event, EventMap} from '../../enums/Event';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {CustomDataValues} from '../../types/CustomDataValues';\nimport {DownloadSpeedInfo} from '../../types/DownloadSpeedInfo';\nimport {DrmPerformanceInfo} from '../../types/DrmPerformanceInfo';\nimport {NoExtraProperties} from '../../types/NoExtraProperties';\nimport {SegmentInfo} from '../../types/SegmentInfo';\nimport {defaultStateMachineCallbacks, StateMachineCallbacks} from '../../types/StateMachineCallbacks';\nimport {logger} from '../../utils/Logger';\nimport {ANALYTICS_QUALITY_CHANGE_COUNT_THRESHOLD} from '../../utils/Settings';\nimport {getCurrentTimestamp} from '../../utils/Utils';\n\nexport abstract class InternalAdapter {\n  public stateMachineCallbacks: StateMachineCallbacks = {...defaultStateMachineCallbacks};\n  // tslint:enable:no-unused-expression\n  protected stateMachine!: AnalyticsStateMachine;\n\n  protected opts: AnalyticsStateMachineOptions;\n  protected _onLicenseKeyReceived: EventDispatcher<{licenseKey: string}> = new EventDispatcher();\n  protected _onLicenseCallFailed: EventDispatcher<{}> = new EventDispatcher();\n\n  protected drmPerformanceInfo: DrmPerformanceInfo | undefined = undefined;\n  protected previousVideoBitrate: number = 0;\n  protected previousAudioBitrate: number = 0;\n  protected qualityChangeCount: number = 0;\n  protected abstract get currentTime(): number;\n\n  get onLicenseKeyReceived() {\n    return this._onLicenseKeyReceived;\n  }\n\n  get onLicenseCallFailed() {\n    return this._onLicenseCallFailed;\n  }\n\n  get downloadSpeedInfo(): DownloadSpeedInfo {\n    return {\n      segmentsDownloadCount: 0,\n      segmentsDownloadSize: 0,\n      segmentsDownloadTime: 0,\n      avgDownloadSpeed: 0,\n      minDownloadSpeed: 0,\n      maxDownloadSpeed: 0,\n      avgTimeToFirstByte: 0,\n    };\n  }\n\n  get segments(): SegmentInfo[] {\n    return [];\n  }\n\n  constructor(opts?: AnalyticsStateMachineOptions) {\n    if (!opts) {\n      opts = {\n        starttime: undefined,\n      };\n    }\n    if (!opts.starttime) {\n      opts.starttime = getCurrentTimestamp();\n    }\n\n    this.opts = opts;\n  }\n\n  public release() {\n    this.stateMachine.resetIntervals();\n    this.stateMachineCallbacks.release();\n    this.resetSourceRelatedState();\n  }\n\n  public eventCallback = <StatemachineEvent extends keyof EventMap, EventData extends EventMap[StatemachineEvent]>(\n    eventType: StatemachineEvent,\n    eventObject: NoExtraProperties<EventMap[StatemachineEvent], EventData>\n  ) => {\n    eventObject = eventObject || {};\n    if (!this.stateMachine) {\n      logger.log(\"Bitmovin Analytics: StateMachine isn't ready yet\");\n    } else {\n      this.stateMachine.callEvent(eventType, eventObject, getCurrentTimestamp());\n    }\n  };\n\n  public getCommonPlaybackInfo() {\n    return {\n      screenHeight: screen.height,\n      screenWidth: screen.width,\n    };\n  }\n\n  public clearValues(): void {\n    // noop by default\n  }\n\n  public clearSegments(): void {\n    // noop by default\n  }\n\n  public increaseQualityChangeCount(): void {\n    this.qualityChangeCount++;\n  }\n\n  public resetQualityChangeCount(): void {\n    this.qualityChangeCount = 0;\n  }\n\n  public resetSourceRelatedState(): void {\n    this.drmPerformanceInfo = undefined;\n  }\n\n  public isQualityChangeEventEnabled(): boolean {\n    return this.qualityChangeCount <= ANALYTICS_QUALITY_CHANGE_COUNT_THRESHOLD;\n  }\n\n  public setCustomData(values: CustomDataValues): void {\n    const previousState = this.stateMachine.currentState;\n\n    if (\n      this.stateMachine.currentState &&\n      (this.stateMachine.currentState === 'PAUSE' || this.stateMachine.currentState === 'PLAYING')\n    ) {\n      this.eventCallback(Event.CUSTOM_DATA_CHANGE, {\n        currentTime: this.currentTime,\n      });\n      this.eventCallback(Event[previousState], {\n        values,\n        currentTime: this.currentTime,\n      });\n    } else {\n      this.stateMachineCallbacks.customdatachange(undefined, undefined, {values});\n    }\n  }\n\n  protected shouldAllowVideoQualityChange(newBitrate: number | undefined): boolean {\n    return (\n      newBitrate != null &&\n      !isNaN(newBitrate) &&\n      this.previousVideoBitrate !== newBitrate &&\n      this.isQualityChangeEventEnabled()\n    );\n  }\n\n  protected setPreviousVideoBitrate(newBitrate: number): void {\n    this.previousVideoBitrate = newBitrate;\n  }\n\n  protected shouldAllowAudioQualityChange(newBitrate: number | undefined): boolean {\n    return (\n      newBitrate != null &&\n      !isNaN(newBitrate) &&\n      this.previousAudioBitrate !== newBitrate &&\n      this.isQualityChangeEventEnabled()\n    );\n  }\n\n  protected setPreviousAudioBitrate(newBitrate: number): void {\n    this.previousAudioBitrate = newBitrate;\n  }\n}\n","export class ErrorCode {\n  public static BITMOVIN_PLAYER_LICENSING_ERROR = new ErrorCode(1103, '');\n  public static SETUP_MISSING_LICENSE_WHITELIST = new ErrorCode(1105, '');\n  public static QUALITY_CHANGE_THRESHOLD_EXCEEDED = new ErrorCode(10000, 'ANALYTICS_QUALITY_CHANGE_THRESHOLD_EXCEEDED');\n  public static BUFFERING_TIMEOUT_REACHED = new ErrorCode(10001, 'ANALYTICS_BUFFERING_TIMEOUT_REACHED');\n  public static VIDEO_STARTUP_TIMEOUT_REACHED = new ErrorCode(10002, 'ANALYTICS_VIDEOSTART_TIMEOUT_REACHED');\n\n  private constructor(public readonly code: number, public readonly message: string) {}\n}\n","/*\n\n  Javascript State Machine Library - https://github.com/jakesgordon/javascript-state-machine\n\n  Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors\n  Released under the MIT license - https://github.com/jakesgordon/javascript-state-machine/blob/master/LICENSE\n\n*/\n\n(function () {\n\n  var StateMachine = {\n\n    //---------------------------------------------------------------------------\n\n    VERSION: \"2.4.0\",\n\n    //---------------------------------------------------------------------------\n\n    Result: {\n      SUCCEEDED:    1, // the event transitioned successfully from one state to another\n      NOTRANSITION: 2, // the event was successfull but no state transition was necessary\n      CANCELLED:    3, // the event was cancelled by the caller in a beforeEvent callback\n      PENDING:      4  // the event is asynchronous and the caller is in control of when the transition occurs\n    },\n\n    Error: {\n      INVALID_TRANSITION: 100, // caller tried to fire an event that was innapropriate in the current state\n      PENDING_TRANSITION: 200, // caller tried to fire an event while an async transition was still pending\n      INVALID_CALLBACK:   300 // caller provided callback function threw an exception\n    },\n\n    WILDCARD: '*',\n    ASYNC: 'async',\n\n    //---------------------------------------------------------------------------\n\n    create: function(cfg, target) {\n\n      var initial      = (typeof cfg.initial == 'string') ? { state: cfg.initial } : cfg.initial; // allow for a simple string, or an object with { state: 'foo', event: 'setup', defer: true|false }\n      var terminal     = cfg.terminal || cfg['final'];\n      var fsm          = target || cfg.target  || {};\n      var events       = cfg.events || [];\n      var callbacks    = cfg.callbacks || {};\n      var map          = {}; // track state transitions allowed for an event { event: { from: [ to ] } }\n      var transitions  = {}; // track events allowed from a state            { state: [ event ] }\n\n      var add = function(e) {\n        var from = Array.isArray(e.from) ? e.from : (e.from ? [e.from] : [StateMachine.WILDCARD]); // allow 'wildcard' transition if 'from' is not specified\n        map[e.name] = map[e.name] || {};\n        for (var n = 0 ; n < from.length ; n++) {\n          transitions[from[n]] = transitions[from[n]] || [];\n          transitions[from[n]].push(e.name);\n\n          map[e.name][from[n]] = e.to || from[n]; // allow no-op transition if 'to' is not specified\n        }\n        if (e.to)\n          transitions[e.to] = transitions[e.to] || [];\n      };\n\n      if (initial) {\n        initial.event = initial.event || 'startup';\n        add({ name: initial.event, from: 'none', to: initial.state });\n      }\n\n      for(var n = 0 ; n < events.length ; n++)\n        add(events[n]);\n\n      for(var name in map) {\n        if (map.hasOwnProperty(name))\n          fsm[name] = StateMachine.buildEvent(name, map[name]);\n      }\n\n      for(var name in callbacks) {\n        if (callbacks.hasOwnProperty(name))\n          fsm[name] = callbacks[name]\n      }\n\n      fsm.current     = 'none';\n      fsm.is          = function(state) { return Array.isArray(state) ? (state.indexOf(this.current) >= 0) : (this.current === state); };\n      fsm.can         = function(event) { return !this.transition && (map[event] !== undefined) && (map[event].hasOwnProperty(this.current) || map[event].hasOwnProperty(StateMachine.WILDCARD)); }\n      fsm.cannot      = function(event) { return !this.can(event); };\n      fsm.transitions = function()      { return (transitions[this.current] || []).concat(transitions[StateMachine.WILDCARD] || []); };\n      fsm.isFinished  = function()      { return this.is(terminal); };\n      fsm.error       = cfg.error || function(name, from, to, args, error, msg, e) { throw e || msg; }; // default behavior when something unexpected happens is to throw an exception, but caller can override this behavior if desired (see github issue #3 and #17)\n      fsm.states      = function() { return Object.keys(transitions).sort() };\n\n      if (initial && !initial.defer)\n        fsm[initial.event]();\n\n      return fsm;\n\n    },\n\n    //===========================================================================\n\n    doCallback: function(fsm, func, name, from, to, args) {\n      if (func) {\n        try {\n          return func.apply(fsm, [name, from, to].concat(args));\n        }\n        catch(e) {\n          return fsm.error(name, from, to, args, StateMachine.Error.INVALID_CALLBACK, \"an exception occurred in a caller-provided callback function\", e);\n        }\n      }\n    },\n\n    beforeAnyEvent:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onbeforeevent'],                       name, from, to, args); },\n    afterAnyEvent:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onafterevent'] || fsm['onevent'],      name, from, to, args); },\n    leaveAnyState:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onleavestate'],                        name, from, to, args); },\n    enterAnyState:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onenterstate'] || fsm['onstate'],      name, from, to, args); },\n    changeState:     function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onchangestate'],                       name, from, to, args); },\n\n    beforeThisEvent: function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onbefore' + name],                     name, from, to, args); },\n    afterThisEvent:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onafter'  + name] || fsm['on' + name], name, from, to, args); },\n    leaveThisState:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onleave'  + from],                     name, from, to, args); },\n    enterThisState:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onenter'  + to]   || fsm['on' + to],   name, from, to, args); },\n\n    beforeEvent: function(fsm, name, from, to, args) {\n      if ((false === StateMachine.beforeThisEvent(fsm, name, from, to, args)) ||\n          (false === StateMachine.beforeAnyEvent( fsm, name, from, to, args)))\n        return false;\n    },\n\n    afterEvent: function(fsm, name, from, to, args) {\n      StateMachine.afterThisEvent(fsm, name, from, to, args);\n      StateMachine.afterAnyEvent( fsm, name, from, to, args);\n    },\n\n    leaveState: function(fsm, name, from, to, args) {\n      var specific = StateMachine.leaveThisState(fsm, name, from, to, args),\n          general  = StateMachine.leaveAnyState( fsm, name, from, to, args);\n      if ((false === specific) || (false === general))\n        return false;\n      else if ((StateMachine.ASYNC === specific) || (StateMachine.ASYNC === general))\n        return StateMachine.ASYNC;\n    },\n\n    enterState: function(fsm, name, from, to, args) {\n      StateMachine.enterThisState(fsm, name, from, to, args);\n      StateMachine.enterAnyState( fsm, name, from, to, args);\n    },\n\n    //===========================================================================\n\n    buildEvent: function(name, map) {\n      return function() {\n\n        var from  = this.current;\n        var to    = map[from] || (map[StateMachine.WILDCARD] != StateMachine.WILDCARD ? map[StateMachine.WILDCARD] : from) || from;\n        var args  = Array.prototype.slice.call(arguments); // turn arguments into pure array\n\n        if (this.transition)\n          return this.error(name, from, to, args, StateMachine.Error.PENDING_TRANSITION, \"event \" + name + \" inappropriate because previous transition did not complete\");\n\n        if (this.cannot(name))\n          return this.error(name, from, to, args, StateMachine.Error.INVALID_TRANSITION, \"event \" + name + \" inappropriate in current state \" + this.current);\n\n        if (false === StateMachine.beforeEvent(this, name, from, to, args))\n          return StateMachine.Result.CANCELLED;\n\n        if (from === to) {\n          StateMachine.afterEvent(this, name, from, to, args);\n          return StateMachine.Result.NOTRANSITION;\n        }\n\n        // prepare a transition method for use EITHER lower down, or by caller if they want an async transition (indicated by an ASYNC return value from leaveState)\n        var fsm = this;\n        this.transition = function() {\n          fsm.transition = null; // this method should only ever be called once\n          fsm.current = to;\n          StateMachine.enterState( fsm, name, from, to, args);\n          StateMachine.changeState(fsm, name, from, to, args);\n          StateMachine.afterEvent( fsm, name, from, to, args);\n          return StateMachine.Result.SUCCEEDED;\n        };\n        this.transition.cancel = function() { // provide a way for caller to cancel async transition if desired (issue #22)\n          fsm.transition = null;\n          StateMachine.afterEvent(fsm, name, from, to, args);\n        }\n\n        var leave = StateMachine.leaveState(this, name, from, to, args);\n        if (false === leave) {\n          this.transition = null;\n          return StateMachine.Result.CANCELLED;\n        }\n        else if (StateMachine.ASYNC === leave) {\n          return StateMachine.Result.PENDING;\n        }\n        else {\n          if (this.transition) // need to check in case user manually called transition() but forgot to return StateMachine.ASYNC\n            return this.transition();\n        }\n\n      };\n    }\n\n  }; // StateMachine\n\n  //===========================================================================\n\n  //======\n  // NODE\n  //======\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = StateMachine;\n    }\n    exports.StateMachine = StateMachine;\n  }\n  //============\n  // AMD/REQUIRE\n  //============\n  else if (typeof define === 'function' && define.amd) {\n    define(function(require) { return StateMachine; });\n  }\n  //========\n  // BROWSER\n  //========\n  else if (typeof window !== 'undefined') {\n    window.StateMachine = StateMachine;\n  }\n  //===========\n  // WEB WORKER\n  //===========\n  else if (typeof self !== 'undefined') {\n    self.StateMachine = StateMachine;\n  }\n\n}());\n","import {ErrorCode} from '../enums/ErrorCode';\nimport {Event, EventMap} from '../enums/Event';\nimport {VideoStartFailedReason} from '../enums/VideoStartFailedReason';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport * as ErrorData from '../types/EventData';\nimport {NoExtraProperties} from '../types/NoExtraProperties';\nimport {StateMachineCallbacks} from '../types/StateMachineCallbacks';\nimport * as Settings from '../utils/Settings';\nimport * as Utils from '../utils/Utils';\n\nconst REBUFFERING_HEARTBEAT_INTERVALS = [3000, 5000, 10000, 30000, 59700];\n\nexport abstract class AnalyticsStateMachine {\n  protected stateMachine: StateMachine.StateMachine & {[key: string]: any};\n  protected onEnterStateTimestamp: number = 0;\n\n  protected readonly videoStartupTimeoutMs: number = Settings.ANALYTICS_VIDEOSTART_TIMEOUT;\n  protected readonly rebufferTimeoutMs: number = Settings.ANALYTICS_REBUFFER_TIMEOUT;\n\n  private rebufferingHeartbeatIntervalHandle?: number;\n  private currentRebufferingIntervalIndex: number = 0;\n  private rebufferingTimeoutHandle?: number;\n  private videoStartTimeout?: number;\n\n  constructor(protected stateMachineCallbacks: StateMachineCallbacks, opts: AnalyticsStateMachineOptions) {\n    this.stateMachine = this.createStateMachine(opts);\n  }\n\n  public abstract createStateMachine(opts: AnalyticsStateMachineOptions): StateMachine.StateMachine;\n  public abstract callEvent<StatemachineEvent extends keyof EventMap, EventData extends EventMap[StatemachineEvent]>(\n    eventType: StatemachineEvent,\n    eventObject: NoExtraProperties<EventMap[StatemachineEvent], EventData>,\n    timestamp: number\n  ): void;\n  public abstract sourceChange(config: any, timestamp: number, currentTime?: number): void;\n\n  public get currentState(): string {\n    return this.stateMachine.current;\n  }\n\n  public resetIntervals() {\n    this.clearVideoStartTimeout();\n    this.clearRebufferingTimeoutHandle(true);\n    this.clearRebufferingHeartbeatHandle();\n  }\n\n  //#region rebuffer timeout\n\n  protected startRebufferingHeartbeatInterval(reset: boolean = true) {\n    this.resetRebufferingHelpers(reset);\n\n    this.startRebufferingTimeoutHandle();\n\n    this.rebufferingHeartbeatIntervalHandle = window.setInterval(() => {\n      if (this.stateMachine.current.toLowerCase() !== 'rebuffering') {\n        this.resetRebufferingHelpers();\n        return;\n      }\n      const timestamp = new Date().getTime();\n      const stateDuration = timestamp - this.onEnterStateTimestamp;\n      this.stateMachineCallbacks.heartbeat(stateDuration, this.stateMachine.current.toLowerCase(), {\n        buffered: stateDuration,\n      });\n      this.onEnterStateTimestamp = timestamp;\n      this.currentRebufferingIntervalIndex = Math.min(\n        this.currentRebufferingIntervalIndex + 1,\n        REBUFFERING_HEARTBEAT_INTERVALS.length - 1\n      );\n      this.startRebufferingHeartbeatInterval(false);\n    }, REBUFFERING_HEARTBEAT_INTERVALS[this.currentRebufferingIntervalIndex]);\n  }\n\n  protected resetRebufferingHelpers(reset: boolean = true) {\n    if (reset) {\n      this.currentRebufferingIntervalIndex = 0;\n    }\n    this.clearRebufferingHeartbeatHandle();\n    this.clearRebufferingTimeoutHandle(reset);\n  }\n\n  protected clearRebufferingHeartbeatHandle() {\n    if (this.rebufferingHeartbeatIntervalHandle != null) {\n      window.clearInterval(this.rebufferingHeartbeatIntervalHandle);\n      this.rebufferingHeartbeatIntervalHandle = undefined;\n    }\n  }\n\n  protected startRebufferingTimeoutHandle() {\n    if (this.currentRebufferingIntervalIndex > 0) {\n      return;\n    }\n    this.rebufferingTimeoutHandle = window.setTimeout(() => {\n      this.callEvent(\n        Event.ERROR,\n        {\n          ...ErrorCode.BUFFERING_TIMEOUT_REACHED,\n          data: {\n            additionalData: `StateMachine timed out after ${this.rebufferTimeoutMs} ms of consecutive buffering.`,\n          },\n        },\n        Utils.getCurrentTimestamp()\n      );\n      this.stateMachineCallbacks.stop_collecting();\n    }, this.rebufferTimeoutMs);\n  }\n\n  protected clearRebufferingTimeoutHandle(reset: boolean) {\n    if (reset && this.rebufferingTimeoutHandle != null) {\n      window.clearTimeout(this.rebufferingTimeoutHandle);\n      this.rebufferingTimeoutHandle = undefined;\n    }\n  }\n  //#endregion\n\n  //#region videoStartupFailed\n\n  protected getVideoStartupFailedEventData(currentTime: number, event?: string, eventObject?: any) {\n    const reason = this.getReasonForVideoStartFailure(event);\n    const eventData: ErrorData.VideoStartFailedEvent = {currentTime, reason};\n    return eventData;\n  }\n\n  protected getReasonForVideoStartFailure(event?: string) {\n    switch (event) {\n      case Event.ERROR:\n        return VideoStartFailedReason.PLAYER_ERROR;\n      case Event.UNLOAD:\n        return VideoStartFailedReason.PAGE_CLOSED;\n      case Event.VIDEOSTART_TIMEOUT:\n        return VideoStartFailedReason.TIMEOUT;\n      default:\n        return VideoStartFailedReason.UNKNOWN;\n    }\n  }\n\n  protected setVideoStartTimeout() {\n    if (this.videoStartTimeout != null) {\n      this.clearVideoStartTimeout();\n    }\n    this.videoStartTimeout = window.setTimeout(() => {\n      this.callEvent(Event.VIDEOSTART_TIMEOUT, {}, Utils.getCurrentTimestamp());\n      this.stateMachineCallbacks.stop_collecting();\n    }, this.videoStartupTimeoutMs);\n  }\n\n  protected clearVideoStartTimeout() {\n    window.clearTimeout(this.videoStartTimeout);\n    this.videoStartTimeout = undefined;\n  }\n  //#endregion\n}\n","import {HTML5AnalyticsStateMachine} from '../../analyticsStateMachines/HTML5AnalyticsStateMachine';\nimport {Analytics} from '../../core/Analytics';\nimport VideoCompletionTracker from '../../core/VideoCompletionTracker';\nimport {Event} from '../../enums/Event';\nimport {getMIMETypeFromFileExtension} from '../../enums/MIMETypes';\nimport {Player} from '../../enums/Player';\nimport {PlayerSize} from '../../enums/PlayerSize';\nimport {getStreamTypeFromMIMEType} from '../../enums/StreamTypes';\nimport {Feature} from '../../features/Feature';\nimport {FeatureConfig} from '../../features/FeatureConfig';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {DrmPerformanceInfo} from '../../types/DrmPerformanceInfo';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {PlaybackInfo} from '../../types/PlaybackInfo';\nimport {QualityLevelInfo} from '../../types/QualityLevelInfo';\nimport {SegmentInfo} from '../../types/SegmentInfo';\nimport {StreamSources} from '../../types/StreamSources';\nimport {SubtitleInfo} from '../../types/SubtitleInfo';\nimport {isVideoInFullscreen} from '../../utils/Utils';\nimport {InternalAdapter} from './InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nexport abstract class HTML5InternalAdapter extends InternalAdapter implements InternalAdapterAPI {\n  get segments(): SegmentInfo[] {\n    return [];\n  }\n\n  private static BUFFERING_TIMECHANGED_TIMEOUT = 1000;\n  public mediaElEventHandlers: Array<{event: string; handler: any}>;\n  public abstract getPlayerVersion: () => string;\n  public readonly videoCompletionTracker: VideoCompletionTracker;\n  protected needsFirstPlayIntent: boolean;\n  private onBeforeUnLoadEvent: boolean = false;\n\n  private bufferingTimeout?: number;\n  private isBuffering: boolean;\n  private lastIsLiveStatus: boolean;\n  private isPaused: boolean;\n  private isSeeking: boolean;\n  private previousMediaTime: number;\n  private previousClientTime: number;\n  private needsReadyEvent: boolean;\n  private mediaElementSet: boolean;\n\n  constructor(protected mediaElement: HTMLVideoElement | null, opts?: AnalyticsStateMachineOptions) {\n    super(opts);\n    this.stateMachine = new HTML5AnalyticsStateMachine(this.stateMachineCallbacks, this.opts);\n    this.mediaElEventHandlers = [];\n    this.bufferingTimeout = undefined;\n    this.isBuffering = false;\n    this.lastIsLiveStatus = false;\n    this.isPaused = false;\n    this.isSeeking = false;\n    this.previousMediaTime = 0;\n    this.previousClientTime = 0;\n    this.needsReadyEvent = true;\n    this.needsFirstPlayIntent = true;\n    this.mediaElementSet = false;\n    this.videoCompletionTracker = new VideoCompletionTracker();\n  }\n  public getPlayerName = () => Player.HTML5;\n  public getPlayerTech = () => 'html5';\n  public getAutoPlay = () => (this.mediaElement ? this.mediaElement.autoplay : false);\n  public getDrmPerformanceInfo = (): DrmPerformanceInfo | undefined => this.drmPerformanceInfo;\n\n  public initialize(analytics: Analytics): Array<Feature<FeatureConfigContainer, FeatureConfig>> {\n    if (this.mediaElement) {\n      this.setMediaElement();\n    }\n    this.registerWindowEvents();\n    return [];\n  }\n\n  public isLive = () => (this.mediaElement ? this.mediaElement.duration === Infinity : false);\n\n  // this seems very generic. one could put it in a helper\n  // and use it in many adapter implementations.\n  public getStreamSources(url: string | undefined): StreamSources {\n    if (!url) {\n      return {};\n    }\n    const streamType = this.getStreamType();\n    switch (streamType) {\n      case 'hls':\n        return {m3u8Url: url};\n      case 'dash':\n        return {mpdUrl: url};\n      default:\n        return {progUrl: url};\n    }\n  }\n\n  public getCurrentPlaybackInfo(): PlaybackInfo {\n    let info: PlaybackInfo = {\n      ...this.getCommonPlaybackInfo(),\n      ...this.getStreamSources(this.getStreamURL()),\n      streamFormat: this.getStreamType(),\n      isLive: this.isLive(),\n      size: isVideoInFullscreen() ? PlayerSize.Fullscreen : PlayerSize.Window,\n      playerTech: this.getPlayerTech(),\n      droppedFrames: 0, // TODO\n      // TODO audioBitrate:\n      // TODO isCasting:\n      // TODO videoTitle: (currently only from the analytics config)\n    };\n\n    if (this.mediaElement) {\n      info = {\n        ...info,\n        videoDuration: this.mediaElement.duration,\n        isMuted: this.mediaElement.muted,\n        videoWindowHeight: this.mediaElement.height,\n        videoWindowWidth: this.mediaElement.width,\n      };\n    }\n\n    const qualityInfo = this.getCurrentQualityLevelInfo();\n    if (qualityInfo) {\n      info = {\n        ...info,\n        videoPlaybackHeight: qualityInfo.height,\n        videoPlaybackWidth: qualityInfo.width,\n        videoBitrate: qualityInfo.bitrate,\n      };\n    }\n\n    return info;\n  }\n\n  protected get currentTime(): number {\n    if (!this.mediaElement) {\n      throw new Error('No media attached');\n    }\n\n    return this.mediaElement.currentTime;\n  }\n\n  /**\n   * Used to setup against the media element.\n   * We need this method to desynchronize construction of this class\n   * and the actual initialization against the media element.\n   * That is because at construction some media engine\n   * may not already have the media element attached, for example\n   * when passing in the DOM element is happening at once with passing the source URL\n   * and can not be decoupled.\n   * We are then awaiting an event from the engine and calling this with the media element\n   * as argument from our sub-class.\n   *\n   * This method can also be called without arguments and then it will perform\n   * initialization against the existing media element (should only be called once, will throw an error otherwise)\n   *\n   * It can also be used to replace the element.\n   *\n   *\n   */\n  public setMediaElement(mediaElement: HTMLVideoElement | null = null) {\n    // replace previously existing, if calld with args\n    if (mediaElement && this.mediaElement) {\n      this.unregisterMediaElement();\n      this.mediaElementSet = false;\n    }\n\n    // if called without args we assume it's already there\n    // we can also be called with args but without any being there before\n    if (mediaElement) {\n      this.mediaElement = mediaElement;\n    }\n\n    if (!this.mediaElement) {\n      throw new Error('No media element owned');\n    }\n\n    if (this.mediaElementSet) {\n      throw new Error('Media element already set (only call this once)');\n    }\n    this.mediaElementSet = true;\n\n    this.registerMediaElement();\n    this.onMaybeReady();\n  }\n  public abstract getCurrentQualityLevelInfo(): QualityLevelInfo | null;\n\n  /**\n   * Can be overriden by sub-classes\n   * @returns {string}\n   *\n   */\n  public getMIMEType(): string | undefined {\n    const streamUrl = this.getStreamURL();\n    if (!streamUrl || streamUrl === undefined) {\n      return;\n    }\n    return getMIMETypeFromFileExtension(streamUrl);\n  }\n\n  /**\n   * Can be overriden by sub-classes\n   * @returns {string}\n   */\n  public getStreamType(): string | undefined {\n    const mimetype = this.getMIMEType();\n    if (mimetype) {\n      return getStreamTypeFromMIMEType(mimetype);\n    }\n  }\n\n  /**\n   * Can be overriden by subclasses.\n   * @returns {string}\n   */\n  public getStreamURL(): string | undefined {\n    const mediaElement = this.mediaElement;\n    if (!mediaElement) {\n      return;\n    }\n\n    return mediaElement.src;\n  }\n\n  public resetMedia() {\n    this.mediaElement = null;\n    this.mediaElEventHandlers = [];\n    window.clearTimeout(this.bufferingTimeout);\n  }\n\n  public registerMediaElement() {\n    const mediaElement = this.mediaElement;\n    if (!mediaElement) {\n      return;\n    }\n\n    this.listenToMediaElementEvent('loadstart', () => {\n      this.eventCallback(Event.READY, {});\n    });\n\n    this.listenToMediaElementEvent('loadedmetadata', () => {\n      // See https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/readyState\n      // HAVE_NOTHING 0 No information is available about the media resource.\n      // HAVE_METADATA 1 Enough of the media resource has been retrieved that\n      // the metadata attributes are initialized. Seeking will no longer raise an exception.\n      // HAVE_CURRENT_DATA 2 Data is available for the current playback position,\n      // but not enough to actually play more than one frame.\n      // HAVE_FUTURE_DATA  3 Data for the current playback position as well as for\n      //  at least a little bit of time into the future is available\n      // (in other words, at least two frames of video, for example).\n      // HAVE_ENOUGH_DATA  4 Enough data is availableand the download rate is high\n      // enoughthat the media can be played through to the end without interruption.\n      if (mediaElement.readyState !== 1) {\n        // we can't really gather any more information at this point\n        return;\n      }\n\n      // silent\n      this.checkQualityLevelAttributes(true);\n\n      // const {duration, autoplay, width, height, videoWidth, videoHeight, muted} = mediaElement;\n\n      // // This is redundant with what we give to updateMetadata method.\n      // // Not sure if there are good reasons to keep that so or if we should better centralize.\n      // const info = {\n      //   type: 'html5',\n      //   isLive: this.isLive(),\n      //   version: this.getPlayerVersion(),\n      //   streamType: this.getStreamType(),\n      //   streamUrl: this.getStreamURL(),\n      //   duration,\n      //   autoplay,\n      //   // HTMLVideoElement.width and HTMLVideoElement.height\n      //   // is a DOMString that reflects the height HTML attribute,\n      //   // which specifies the height of the display area, in CSS pixels.\n      //   // See https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement\n      //   width: width,\n      //   height: height,\n      //   // Returns an unsigned long containing the intrinsic\n      //   // height of the resource in CSS pixels,\n      //   // taking into account the dimensions, aspect ratio,\n      //   // clean aperture, resolution, and so forth,\n      //   // as defined for the format used by the resource.\n      //   // If the element's ready state is HAVE_NOTHING, the value is 0.\n      //   // See https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement\n      //   videoWindowWidth: videoWidth,\n      //   videoWindowHeight: videoHeight,\n      //   muted,\n      // };\n\n      // silence events if we have not yet intended play\n      // if (this.needsFirstPlayIntent_) {\n      //   return;\n      // }\n      if (this.mediaElement != null) {\n        this.videoCompletionTracker.reset();\n        this.videoCompletionTracker.setVideoDuration(this.mediaElement.duration);\n      }\n    });\n\n    // We need the PLAY event to indicate the intent to play\n    // NOTE: use TIMECHANGED event on 'playing' and trigger PLAY as intended in states.dot graph\n\n    this.listenToMediaElementEvent('play', () => {\n      const {currentTime} = mediaElement;\n\n      this.needsFirstPlayIntent = false;\n\n      this.eventCallback(Event.PLAY, {\n        currentTime,\n      });\n    });\n\n    this.listenToMediaElementEvent('pause', () => {\n      this.onPaused();\n    });\n\n    this.listenToMediaElementEvent('playing', () => {\n      const {currentTime} = mediaElement;\n\n      this.isPaused = false;\n\n      // silence events if we have not yet intended play\n      if (this.needsFirstPlayIntent) {\n        return;\n      }\n\n      this.eventCallback(Event.TIMECHANGED, {\n        currentTime,\n      });\n    });\n\n    this.listenToMediaElementEvent('error', () => {\n      const {currentTime, error} = mediaElement;\n\n      this.eventCallback(Event.ERROR, {\n        currentTime,\n        // See https://developer.mozilla.org/en-US/docs/Web/API/MediaError\n        code: error?.code ?? undefined,\n        message: error?.message ?? undefined,\n        data: {},\n      });\n    });\n\n    this.listenToMediaElementEvent('volumechange', () => {\n      const {muted, currentTime} = mediaElement;\n\n      if (muted) {\n        this.eventCallback(Event.MUTE, {\n          currentTime,\n        });\n      } else {\n        this.eventCallback(Event.UN_MUTE, {\n          currentTime,\n        });\n      }\n    });\n\n    this.listenToMediaElementEvent('seeking', () => {\n      const {currentTime} = mediaElement;\n\n      this.eventCallback(Event.SEEK, {\n        currentTime,\n      });\n    });\n\n    this.listenToMediaElementEvent('seeked', () => {\n      const {currentTime} = mediaElement;\n\n      clearTimeout(this.bufferingTimeout);\n\n      this.eventCallback(Event.SEEKED, {\n        currentTime,\n      });\n    });\n\n    this.listenToMediaElementEvent('timeupdate', () => {\n      const {currentTime} = mediaElement;\n\n      this.isBuffering = false;\n      this.isSeeking = false;\n\n      // silence events if we have not yet intended play\n      if (this.needsFirstPlayIntent) {\n        return;\n      }\n\n      if (!this.isPaused) {\n        this.eventCallback(Event.TIMECHANGED, {\n          currentTime,\n        });\n      }\n\n      this.checkQualityLevelAttributes();\n\n      this.checkSeeking();\n\n      // We are doing this in case we can not rely\n      // on the \"stalled\" or \"waiting\" events in a specific browser\n      // and to detect intrinsinc paused states (when we do not get a paused event)\n      // but the player is paused already before attach or is paused from initialization on.\n      this.checkPlayheadProgress();\n\n      this.previousMediaTime = currentTime;\n    });\n\n    // The stalled event is fired when the user agent is trying to fetch media data,\n    // but data is unexpectedly not forthcoming.\n    // https://developer.mozilla.org/en-US/docs/Web/Events/stalled\n    this.listenToMediaElementEvent('stalled', () => {\n      // this event doesn't indicate buffering by definition (interupted playback),\n      // only that data throughput to playout buffers is not as high as expected\n      // It happens on Chrome every once in a while as SourceBuffer's are not fed\n      // as fast as the underlying native player may prefer (but it does not lead to\n      // interuption).\n    });\n\n    // The waiting event is fired when playback has stopped because of a temporary lack of data.\n    // See https://developer.mozilla.org/en-US/docs/Web/Events/waiting\n    this.listenToMediaElementEvent('waiting', () => {\n      // we check here for seeking because a programmatically seek where just\n      // the currentTime has been changed does not trigger a proper seek event\n      this.checkSeeking();\n      this.onBuffering();\n    });\n  }\n\n  /**\n   * Should only be calld when a mediaElement is attached\n   */\n  public listenToMediaElementEvent(event: any, handler: any) {\n    if (!this.mediaElement) {\n      throw new Error('No media attached');\n    }\n\n    const boundHandler = handler.bind(this);\n\n    this.mediaElEventHandlers.push({event, handler: boundHandler});\n    this.mediaElement.addEventListener(event, boundHandler, false);\n  }\n\n  public onMaybeReady() {\n    if (!this.needsReadyEvent || !this.mediaElement) {\n      return;\n    }\n\n    this.needsReadyEvent = false;\n\n    const info = this.getCurrentPlaybackInfo();\n\n    this.videoCompletionTracker.reset();\n    this.videoCompletionTracker.setVideoDuration(this.mediaElement.duration);\n    this.eventCallback(Event.READY, {currentTime: this.currentTime});\n  }\n\n  /**\n   * Should only be calld when a mediaElement is attached\n   */\n  public unregisterMediaElement() {\n    if (!this.mediaElement) {\n      throw new Error('No media attached');\n    }\n\n    const mediaElement = this.mediaElement;\n\n    this.mediaElEventHandlers.forEach((item: {event: string; handler: any}) => {\n      mediaElement.removeEventListener(item.event, item.handler);\n    });\n\n    this.resetMedia();\n  }\n\n  public onBuffering() {\n    if (!this.mediaElement) {\n      throw new Error('No media attached');\n    }\n    const {currentTime} = this.mediaElement;\n\n    // this handler may be called multiple times\n    // for one actual buffering-event occuring so lets guard from\n    // triggering this event redundantly.\n    if (this.isBuffering || (this.isPaused && !this.isSeeking)) {\n      return;\n    }\n\n    if (this.isSeeking) {\n      this.eventCallback(Event.SEEK, {\n        currentTime,\n      });\n    } else {\n      this.eventCallback(Event.START_BUFFERING, {\n        currentTime,\n      });\n    }\n    this.isBuffering = true;\n  }\n\n  public onPaused(currentTime?: number) {\n    if (this.isPaused) {\n      return;\n    }\n    if (!this.mediaElement) {\n      throw new Error('No media attached');\n    }\n\n    if (!currentTime) {\n      currentTime = this.mediaElement.currentTime;\n    }\n\n    this.eventCallback(Event.PAUSE, {\n      currentTime,\n    });\n\n    this.isPaused = true;\n  }\n\n  public registerWindowEvents() {\n    window.addEventListener('beforeunload', this.onPageClose.bind(this));\n    window.addEventListener('unload', this.onPageClose.bind(this));\n  }\n\n  public onPageClose() {\n    if (!this.onBeforeUnLoadEvent) {\n      this.onBeforeUnLoadEvent = true;\n      const mediaElement = this.mediaElement;\n      let currentTime: number | undefined;\n      if (mediaElement != null) {\n        currentTime = mediaElement.currentTime;\n      }\n      this.eventCallback(Event.UNLOAD, {\n        currentTime,\n      });\n    }\n  }\n\n  public checkPlayheadProgress() {\n    if (!this.mediaElement) {\n      throw new Error('No media attached');\n    }\n    const mediaElement = this.mediaElement;\n    if (mediaElement.paused) {\n      this.onPaused();\n    }\n\n    clearTimeout(this.bufferingTimeout);\n\n    this.bufferingTimeout = window.setTimeout(() => {\n      if (mediaElement.paused || (mediaElement.ended && !this.isBuffering)) {\n        return;\n      }\n\n      const timeDelta = mediaElement.currentTime - this.previousMediaTime;\n\n      if (timeDelta < HTML5InternalAdapter.BUFFERING_TIMECHANGED_TIMEOUT) {\n        this.onBuffering();\n      }\n    }, HTML5InternalAdapter.BUFFERING_TIMECHANGED_TIMEOUT);\n  }\n\n  /**\n   * @param {boolean} silent\n   */\n  public checkQualityLevelAttributes(silent = false) {\n    if (!this.mediaElement) {\n      throw new Error('No media attached');\n    }\n\n    const mediaElement = this.mediaElement;\n\n    const qualityLevelInfo = this.getCurrentQualityLevelInfo();\n    if (!qualityLevelInfo) {\n      return;\n    }\n\n    const {bitrate, width, height} = qualityLevelInfo;\n\n    const isLive = this.isLive();\n\n    // Detect a change of the isLive status and update the medaData of the SM\n    if (isLive !== this.lastIsLiveStatus) {\n      this.lastIsLiveStatus = isLive;\n\n      // TODO Call event for ISLIVE_CHANGE (similar to VIDEO_CHANGE)\n      //      The updateMetadata is obsolete, as we introduced the getCurrentPlaybackInfo\n      //      (we don't notify the statemachine about state changes, instead we poll the adapter for the information)\n      // if (!silent) {\n      //   this.stateMachine.updateMetadata();\n      // }\n    }\n\n    if (bitrate != null && this.shouldAllowVideoQualityChange(bitrate)) {\n      this.setPreviousVideoBitrate(bitrate);\n      const eventData = {\n        width,\n        height,\n        bitrate,\n        currentTime: mediaElement.currentTime,\n      };\n\n      if (!silent) {\n        this.eventCallback(Event.VIDEO_CHANGE, eventData);\n      }\n    }\n  }\n\n  public sourceChange(config: any, timestamp: number) {\n    this.stateMachine.sourceChange(config, timestamp, this.mediaElement ? this.mediaElement.currentTime : undefined);\n  }\n\n  public getSelectedSubtitleFromMediaElement(mediaElement: any): SubtitleInfo | undefined {\n    if (mediaElement.textTracks == null) {\n      return undefined;\n    }\n    const textTrackList = mediaElement.textTracks;\n    for (const attr of textTrackList) {\n      if (attr.mode != null && attr.mode === 'showing') {\n        const isSubtitleDisplayed = attr.language != null && attr.language.length > 0;\n        return {\n          enabled: isSubtitleDisplayed,\n          language: isSubtitleDisplayed ? attr.language : undefined,\n        };\n      }\n    }\n    return {\n      enabled: false,\n    };\n  }\n\n  private checkSeeking() {\n    if (!this.mediaElement) {\n      throw new Error('No media attached');\n    }\n    const {currentTime} = this.mediaElement;\n\n    const now = Date.now();\n    const mediaTimeDif =\n      this.previousMediaTime < currentTime\n        ? currentTime - this.previousMediaTime\n        : this.previousMediaTime - currentTime;\n    const clientTimeDif = (now - this.previousClientTime) / 1000;\n\n    /**\n     * if the media difference between the previous one and the current one is much higher than\n     * the difference of the previous and current client time than there is a seek happening\n     */\n    if (mediaTimeDif > clientTimeDif * 2) {\n      this.isSeeking = true;\n      this.onPaused(this.previousMediaTime + clientTimeDif);\n    }\n\n    this.previousClientTime = Date.now();\n  }\n}\n","// @ts-ignore\nexport const VERSION: string = __VERSION__;\n","import {logger} from './Logger';\n\n// tslint:disable-next-line\nexport function post(url: string, body: any, callback: Function, async: boolean = true): void {\n  let xhttp: any;\n  let legacyMode = false;\n\n  if ((window as any).XDomainRequest) {\n    legacyMode = true;\n  }\n\n  if (legacyMode) {\n    xhttp = new (window as any).XDomainRequest();\n  } else {\n    xhttp = new XMLHttpRequest();\n  }\n\n  const responseCallback = () => {\n    // tslint:disable-next-line\n    if (xhttp.readyState == XMLHttpRequest.DONE) {\n      if (xhttp.responseText <= 0) {\n        return;\n      }\n\n      const sampleResponse = JSON.parse(xhttp.responseText);\n\n      callback(sampleResponse);\n    }\n  };\n\n  if (legacyMode) {\n    xhttp.onload = responseCallback;\n  } else {\n    xhttp.onreadystatechange = responseCallback;\n  }\n\n  try {\n    xhttp.open('POST', url, async);\n    if (!legacyMode) {\n      xhttp.setRequestHeader('Content-Type', 'text/plain');\n    }\n    xhttp.send(JSON.stringify(body));\n  } catch (e) {\n    logger.error('Failed to send POST request.', e);\n  }\n}\n","import {AdAnalyticsSample} from '../types/AdAnalyticsSample';\nimport {AdBreakSample} from '../types/AdBreakSample';\nimport {AdSample} from '../types/AdSample';\nimport {Sample} from '../types/Sample';\nimport {Backend} from './Backend';\n\nexport class NoOpBackend implements Backend {\n  public sendRequest(sample: Sample) {}\n  public sendUnloadRequest(sample: Sample) {}\n  public sendRequestSynchronous(sample: Sample) {}\n  public sendAdRequest(sample: AdSample & AdBreakSample & AdAnalyticsSample) {}\n}\n","export interface Subscribable<TArgs> {\n  subscribe(callback: EventHandler<TArgs>): () => void;\n  unsubscribe(callback: EventHandler<TArgs>);\n}\n\ntype EventHandler<TArgs> = (args: TArgs) => void;\n\nexport class EventDispatcher<TArgs> implements Subscribable<TArgs> {\n  private callbacks: Array<EventHandler<TArgs>> = [];\n\n  public subscribe(callback: EventHandler<TArgs>): () => void {\n    this.callbacks.push(callback);\n\n    return () => this.unsubscribe(callback);\n  }\n\n  public dispatch(args: TArgs) {\n    const callbacks = this.callbacks.slice(0);\n    callbacks.forEach((callback) => {\n      callback(args);\n    });\n  }\n\n  public unsubscribe(callback: EventHandler<TArgs>) {\n    const index = this.callbacks.indexOf(callback);\n    if (index > -1) {\n      this.callbacks.splice(index, 1);\n    }\n  }\n\n  public get subscriberCount() {\n    return this.callbacks.length;\n  }\n}\n","import Timespan from '../types/Timespan';\n\nenum TimespanOverlappingType {\n  None,\n  Overlapping,\n  FirstContainedInSecond,\n  SecondContainedInFirst,\n}\n\nexport default class VideoCompletionTracker {\n  private watched: Timespan[] = [];\n  private videoDuration: number | null = null;\n\n  public reset(): void {\n    this.watched = [];\n  }\n\n  /**\n   * sets video Duration\n   * @param videoDuration in sec\n   */\n  public setVideoDuration(videoDuration: number): void {\n    this.videoDuration = videoDuration * 1000;\n  }\n\n  /**\n   * Adds the watched timespan to the tracker\n   * @param watched watched timespan you want to add to the tracker\n   * @returns how much time(video parts which have not been seen yet) was added to the tracker\n   */\n  public addWatched(watched: Timespan): number {\n    if (this.videoDuration == null) {\n      throw new Error('no video duration set for completion tracker');\n    }\n\n    this.watched.push(watched);\n    const overlappingTimespan = this.mergeWatched(this.watched);\n    return (this.getDuration(watched) - overlappingTimespan) / this.videoDuration;\n  }\n\n  /**\n   * returns the relative value of how much the user watch the content of the video\n   */\n  public getCompletionPercentage(): number {\n    if (this.videoDuration == null) {\n      throw new Error('no video duration set for completion tracker');\n    }\n\n    let watched = 0;\n    for (const w of this.watched) {\n      watched += this.getDuration(w);\n    }\n    return watched / this.videoDuration;\n  }\n\n  /**\n   * Recursive Method to merge All Watched Blocks\n   * @param watched\n   *\n   * @returns how much timespan was overlapping while merging the watchBlocks\n   */\n  private mergeWatched(watched: Timespan[]): number {\n    for (let i = 0; i < watched.length; i++) {\n      const time1 = watched[i];\n      for (let k = i + 1; k < watched.length; k++) {\n        const time2 = watched[k];\n        let overlappingTimespan = 0;\n        const overlapType = this.getOverlappingType(time1, time2);\n\n        if (overlapType === TimespanOverlappingType.Overlapping) {\n          this.mergeAndReplace(time1, i, time2, k);\n          overlappingTimespan = this.getOverlappingTimespan(time1, time2);\n        } else if (overlapType === TimespanOverlappingType.FirstContainedInSecond) {\n          this.watched.splice(i, 1);\n          overlappingTimespan = this.getDuration(time1);\n        } else if (overlapType === TimespanOverlappingType.SecondContainedInFirst) {\n          this.watched.splice(k, 1);\n          overlappingTimespan = this.getDuration(time2);\n        }\n        if (overlapType !== TimespanOverlappingType.None) {\n          return overlappingTimespan + this.mergeWatched(this.watched);\n        }\n      }\n    }\n    return 0;\n  }\n\n  private getOverlappingType(first: Timespan, second: Timespan): TimespanOverlappingType {\n    if (\n      (this.isMomentInTimespan(first.end, second) && first.start < second.start) ||\n      (this.isMomentInTimespan(first.start, second) && first.end > second.end)\n    ) {\n      return TimespanOverlappingType.Overlapping;\n    } else if (this.isMomentInTimespan(first.start, second) && this.isMomentInTimespan(first.end, second)) {\n      return TimespanOverlappingType.FirstContainedInSecond;\n    } else if (this.isMomentInTimespan(second.start, first) && this.isMomentInTimespan(second.end, first)) {\n      return TimespanOverlappingType.SecondContainedInFirst;\n    }\n    return TimespanOverlappingType.None;\n  }\n\n  private isMomentInTimespan(moment: number, timespan: Timespan): boolean {\n    return moment >= timespan.start && moment < timespan.end;\n  }\n\n  private mergeAndReplace(first: Timespan, firstIndex: number, second: Timespan, secondIndex: number): void {\n    const end = first.end > second.end ? first.end : second.end;\n    const start = first.start < second.start ? first.start : second.start;\n    const newWatchedTimespan: Timespan = {start, end};\n    this.watched.splice(firstIndex, 1, newWatchedTimespan);\n    this.watched.splice(secondIndex, 1);\n  }\n\n  private getOverlappingTimespan(first: Timespan, second: Timespan): number {\n    const end = first.end < second.end ? first.end : second.end;\n    const start = first.start >= second.start ? first.start : second.start;\n    return end - start;\n  }\n\n  private getDuration(watched: Timespan): number {\n    return Math.abs(watched.end - watched.start);\n  }\n}\n","export interface CustomDataValues {\n  customData1?: string;\n  customData2?: string;\n  customData3?: string;\n  customData4?: string;\n  customData5?: string;\n  customData6?: string;\n  customData7?: string;\n  customData8?: string;\n  customData9?: string;\n  customData10?: string;\n  customData11?: string;\n  customData12?: string;\n  customData13?: string;\n  customData14?: string;\n  customData15?: string;\n  customData16?: string;\n  customData17?: string;\n  customData18?: string;\n  customData19?: string;\n  customData20?: string;\n  customData21?: string;\n  customData22?: string;\n  customData23?: string;\n  customData24?: string;\n  customData25?: string;\n  customData26?: string;\n  customData27?: string;\n  customData28?: string;\n  customData29?: string;\n  customData30?: string;\n  experimentName?: string;\n}\n\n/**\n * Lists all keys of the {@see CustomDataValues} interface.\n */\nexport const customDataValuesKeys: Array<keyof CustomDataValues> = [\n  'customData1',\n  'customData2',\n  'customData3',\n  'customData4',\n  'customData5',\n  'customData6',\n  'customData7',\n  'customData8',\n  'customData9',\n  'customData10',\n  'customData11',\n  'customData12',\n  'customData13',\n  'customData14',\n  'customData15',\n  'customData16',\n  'customData17',\n  'customData18',\n  'customData19',\n  'customData20',\n  'customData21',\n  'customData22',\n  'customData23',\n  'customData24',\n  'customData25',\n  'customData26',\n  'customData27',\n  'customData28',\n  'customData29',\n  'customData30',\n  'experimentName',\n];\n\n/**\n * The number of CustomDataXX fields in {@see CustomDataValues}.\n */\nexport const customDataFieldCount = customDataValuesKeys.filter((i) => i.match('customData\\\\d+')).length;\n","export class EventDebugging {\n  public event: string | undefined;\n  public from: string | undefined;\n  public to: string | undefined;\n  public timestamp: number;\n  public eventObject: any;\n\n  constructor(\n    event: string | undefined,\n    from: string | undefined,\n    to: string | undefined,\n    timestamp: number,\n    eventObject: any\n  ) {\n    this.event = event;\n    this.from = from;\n    this.to = to;\n    this.timestamp = timestamp;\n    this.eventObject = eventObject;\n  }\n}\n","export enum CastTech {\n  AirPlay = 'AirPlay',\n  WebSocket = 'WebSocket',\n  GoogleCast = 'GoogleCast',\n}\n","import {ProgressiveSourceConfig} from '../types/ProgressiveSourceConfig';\nimport {ProgressiveSourceInfo} from '../types/SourceInfo';\n\nexport const getSourceInfoFromBitmovinSourceConfig = (\n  progressive: ProgressiveSourceConfig,\n  player: any\n): ProgressiveSourceInfo => {\n  if (!progressive) {\n    return {\n      progBitrate: undefined,\n      progUrl: undefined,\n    };\n  }\n\n  if (typeof progressive === 'string') {\n    return {\n      progBitrate: 0,\n      progUrl: progressive,\n    };\n  }\n\n  if (Array.isArray(progressive) && progressive.length > 0) {\n    const playbackVideoData = player.getPlaybackVideoData();\n    let progressiveArrayIndex = 0;\n\n    if (playbackVideoData !== null && playbackVideoData !== undefined && !isNaN(+playbackVideoData.id)) {\n      progressiveArrayIndex = +playbackVideoData.id;\n    }\n\n    return {\n      progBitrate: progressive[progressiveArrayIndex].bitrate || 0,\n      progUrl: progressive[progressiveArrayIndex].url,\n    };\n  }\n\n  if (typeof progressive === 'object' && !Array.isArray(progressive)) {\n    return {\n      progBitrate: progressive.bitrate || 0,\n      progUrl: progressive.url,\n    };\n  }\n\n  return {\n    progBitrate: undefined,\n    progUrl: undefined,\n  };\n};\n","import {DownloadSpeedInfo} from '../types/DownloadSpeedInfo';\nimport {SpeedMeasurement} from '../types/SpeedMeasurement';\nimport {Converter} from '../utils/Converter';\nimport {Measure} from './Measure';\n\nexport class DownloadSpeedMeter {\n  protected measures: Measure[];\n\n  constructor() {\n    this.measures = [];\n  }\n\n  public reset(): void {\n    this.measures = [];\n  }\n\n  public addMeasurement(measurement: SpeedMeasurement): void {\n    if (measurement.httpStatus >= 400) {\n      return;\n    }\n    const measure = new Measure(measurement);\n\n    const threshhold = Converter.bitsToBytes(300 * 1000 * 1000); // 300 Megabit per second in bytes\n    if (measure.speed >= threshhold) {\n      return;\n    }\n\n    this.measures.push(measure);\n  }\n\n  public getInfo(): DownloadSpeedInfo {\n    return {\n      segmentsDownloadCount: this.measures.length,\n      segmentsDownloadSize: this.measures.map((m) => m.size).reduce(this.add, 0),\n      segmentsDownloadTime: Math.ceil(this.totalTime() * 1000),\n      avgDownloadSpeed: this.avgSpeed(),\n      minDownloadSpeed: this.minSpeed(),\n      maxDownloadSpeed: this.maxSpeed(),\n      avgTimeToFirstByte: this.avgTimeToFirstByte(),\n    };\n  }\n\n  private add(a: number, b: number): number {\n    return a + b;\n  }\n\n  private avgSpeed(): number {\n    if (this.measures.length === 0) {\n      return 0;\n    }\n    const totalSpeed = this.speeds().reduce((a, b) => {\n      return a + b;\n    }, 0);\n    const numMeasurements = this.measures.length;\n    return this.bytePerSecondToBitPerSecond(totalSpeed / numMeasurements);\n  }\n\n  private bytePerSecondToBitPerSecond(bps: number): number {\n    return Converter.bytesToBits(bps);\n  }\n\n  private minSpeed(): number {\n    if (this.measures.length === 0) {\n      return 0;\n    }\n    return this.bytePerSecondToBitPerSecond(Math.min(...this.speeds()));\n  }\n\n  private speeds(): number[] {\n    return this.measures.map((m) => {\n      return m.speed;\n    });\n  }\n\n  private maxSpeed(): number {\n    if (this.measures.length === 0) {\n      return 0;\n    }\n    return this.bytePerSecondToBitPerSecond(Math.max(...this.speeds()));\n  }\n\n  private totalTime(): number {\n    if (this.measures.length === 0) {\n      return 0;\n    }\n    return this.measures.reduce((a, b) => {\n      return a + b.duration;\n    }, 0);\n  }\n\n  private avgTimeToFirstByte(): number {\n    if (this.measures.length === 0) {\n      return 0;\n    }\n    const avg =\n      this.measures.reduce((a, b) => {\n        return a + b.timeToFirstByte * 1000;\n      }, 0) / this.measures.length;\n\n    return Math.ceil(avg);\n  }\n}\n","import * as StateMachine from 'javascript-state-machine';\nimport {Event, EventMap} from '../enums/Event';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {NoExtraProperties} from '../types/NoExtraProperties';\nimport {StateMachineCallbacks} from '../types/StateMachineCallbacks';\nimport {logger, padRight} from '../utils/Logger';\nimport {AnalyticsStateMachine} from './AnalyticsStateMachine';\n\nenum State {\n  SETUP = 'SETUP',\n  STARTUP = 'STARTUP',\n  READY = 'READY',\n  PLAYING = 'PLAYING',\n  REBUFFERING = 'REBUFFERING',\n  PAUSE = 'PAUSE',\n  QUALITYCHANGE = 'QUALITYCHANGE',\n  PAUSED_SEEKING = 'PAUSED_SEEKING',\n  QUALITYCHANGE_PAUSE = 'QUALITYCHANGE_PAUSE',\n  QUALITYCHANGE_REBUFFERING = 'QUALITYCHANGE_REBUFFERING',\n  END = 'END',\n  ERROR = 'ERROR',\n  AD = 'AD',\n  SOURCE_CHANGING = 'SOURCE_CHANGING',\n  MUTING_READY = 'MUTING_READY',\n  MUTING_PLAY = 'MUTING_PLAY',\n  MUTING_PAUSE = 'MUTING_PAUSE',\n  CASTING = 'CASTING',\n  SUBTITLE_CHANGING = 'SUBTITLE_CHANGING',\n  AUDIOTRACK_CHANGING = 'AUDIOTRACK_CHANGING',\n  EXIT_BEFORE_VIDEOSTART = 'EXIT_BEFORE_VIDEOSTART',\n  CUSTOMDATACHANGE = 'CUSTOMDATACHANGE',\n}\n\nexport class HTML5AnalyticsStateMachine extends AnalyticsStateMachine {\n  private seekStartedAt: any;\n\n  constructor(stateMachineCallbacks: StateMachineCallbacks, opts: AnalyticsStateMachineOptions) {\n    super(stateMachineCallbacks, opts);\n    this.seekStartedAt = null;\n\n    this.createStateMachine(opts);\n  }\n\n  public getAllStates() {\n    return [\n      ...Object.keys(State).map((key) => State[key]),\n      'FINISH_QUALITYCHANGE_PAUSE',\n      'FINISH_QUALITYCHANGE',\n      'FINISH_QUALITYCHANGE_REBUFFERING',\n    ];\n  }\n\n  public getAllStatesBut(states: string[]) {\n    return this.getAllStates().filter((i) => states.indexOf(i) < 0);\n  }\n\n  public createStateMachine(opts: AnalyticsStateMachineOptions) {\n    return StateMachine.create({\n      initial: State.SETUP,\n      error: (eventName, from, to, args, errorCode, errorMessage) => {\n        logger.error('Error in statemachine: ' + errorMessage);\n      },\n      events: [\n        {name: Event.TIMECHANGED, from: State.SETUP, to: State.SETUP},\n        {name: Event.READY, from: [State.SETUP, State.ERROR, State.END, State.SOURCE_CHANGING], to: State.READY},\n        {name: Event.READY, from: State.READY, to: State.READY},\n        {name: Event.READY, from: State.STARTUP, to: State.STARTUP},\n\n        {name: Event.PLAY, from: State.READY, to: State.STARTUP},\n\n        {name: Event.ERROR, from: State.STARTUP, to: State.EXIT_BEFORE_VIDEOSTART},\n        {name: Event.UNLOAD, from: State.STARTUP, to: State.EXIT_BEFORE_VIDEOSTART},\n        {name: Event.VIDEOSTART_TIMEOUT, from: State.STARTUP, to: State.EXIT_BEFORE_VIDEOSTART},\n\n        {name: Event.START_BUFFERING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.END_BUFFERING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.VIDEO_CHANGE, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.AUDIO_CHANGE, from: State.STARTUP, to: State.STARTUP},\n\n        {name: Event.TIMECHANGED, from: State.READY, to: State.STARTUP},\n        {name: Event.TIMECHANGED, from: State.STARTUP, to: State.PLAYING},\n        {name: Event.TIMECHANGED, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.TIMECHANGED, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.TIMECHANGED, from: State.PAUSE, to: State.PAUSE},\n\n        {name: Event.SEEKED, from: State.PAUSE, to: State.PAUSE},\n\n        {name: Event.END_BUFFERING, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.START_BUFFERING, from: State.PLAYING, to: State.REBUFFERING},\n        {name: Event.START_BUFFERING, from: State.REBUFFERING, to: State.REBUFFERING},\n\n        {name: Event.PLAY, from: State.REBUFFERING, to: State.PLAYING},\n        {name: Event.TIMECHANGED, from: State.REBUFFERING, to: State.PLAYING},\n\n        // Ignoring since it's pushed in a live stream\n        {name: Event.SEEK, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.PLAY, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n\n        {name: Event.PAUSE, from: State.PLAYING, to: State.PAUSE},\n        {name: Event.PAUSE, from: State.REBUFFERING, to: State.PAUSE},\n\n        {name: Event.PLAY, from: State.PAUSE, to: State.PLAYING},\n        {name: Event.TIMECHANGED, from: State.PAUSE, to: State.PLAYING},\n\n        {name: Event.VIDEO_CHANGE, from: State.PLAYING, to: State.QUALITYCHANGE},\n        {name: Event.AUDIO_CHANGE, from: State.PLAYING, to: State.QUALITYCHANGE},\n        {name: Event.VIDEO_CHANGE, from: State.QUALITYCHANGE, to: State.QUALITYCHANGE},\n        {name: Event.AUDIO_CHANGE, from: State.QUALITYCHANGE, to: State.QUALITYCHANGE},\n        {name: 'FINISH_QUALITYCHANGE', from: State.QUALITYCHANGE, to: State.PLAYING},\n\n        {name: Event.VIDEO_CHANGE, from: State.PAUSE, to: State.QUALITYCHANGE_PAUSE},\n        {name: Event.AUDIO_CHANGE, from: State.PAUSE, to: State.QUALITYCHANGE_PAUSE},\n        {\n          name: Event.VIDEO_CHANGE,\n          from: State.QUALITYCHANGE_PAUSE,\n          to: State.QUALITYCHANGE_PAUSE,\n        },\n        {\n          name: Event.AUDIO_CHANGE,\n          from: State.QUALITYCHANGE_PAUSE,\n          to: State.QUALITYCHANGE_PAUSE,\n        },\n        {name: 'FINISH_QUALITYCHANGE_PAUSE', from: State.QUALITYCHANGE_PAUSE, to: State.PAUSE},\n\n        {name: Event.SEEK, from: State.PAUSE, to: State.PAUSED_SEEKING},\n        {name: Event.SEEK, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.AUDIO_CHANGE, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.VIDEO_CHANGE, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.START_BUFFERING, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.END_BUFFERING, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.SEEKED, from: State.PAUSED_SEEKING, to: State.PAUSE},\n        {name: Event.TIMECHANGED, from: State.PAUSED_SEEKING, to: State.PLAYING},\n        {name: Event.PAUSE, from: State.PAUSED_SEEKING, to: State.PAUSE},\n\n        {name: Event.END, from: State.PAUSED_SEEKING, to: State.END},\n        {name: Event.END, from: State.PLAYING, to: State.END},\n        {name: Event.END, from: State.PAUSE, to: State.END},\n        {name: Event.PAUSE, from: State.END, to: State.END},\n        {name: Event.SEEK, from: State.END, to: State.END},\n        {name: Event.SEEKED, from: State.END, to: State.END},\n        {name: Event.TIMECHANGED, from: State.END, to: State.END},\n        {name: Event.END_BUFFERING, from: State.END, to: State.END},\n        {name: Event.START_BUFFERING, from: State.END, to: State.END},\n        {name: Event.END, from: State.END, to: State.END},\n\n        // Ignored - Livestreams do a Seek during startup and SEEKED once playback started\n        {name: Event.SEEKED, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.SEEK, from: State.PLAYING, to: State.PLAYING},\n\n        {name: Event.PLAY, from: State.END, to: State.PLAYING},\n\n        {name: Event.ERROR, from: this.getAllStatesBut([State.STARTUP]), to: State.ERROR},\n        {name: Event.PAUSE, from: State.ERROR, to: State.ERROR},\n\n        {name: Event.UNLOAD, from: this.getAllStatesBut([State.STARTUP]), to: State.END},\n\n        {name: Event.SUBTITLE_CHANGE, from: State.PLAYING, to: State.SUBTITLE_CHANGING},\n        {name: Event.SUBTITLE_CHANGE, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.SUBTITLE_CHANGE, from: State.READY, to: State.READY},\n        {name: Event.SUBTITLE_CHANGE, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.SUBTITLE_CHANGE, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.SUBTITLE_CHANGE, from: State.SUBTITLE_CHANGING, to: State.SUBTITLE_CHANGING},\n        {name: Event.TIMECHANGED, from: State.SUBTITLE_CHANGING, to: State.PLAYING},\n\n        {name: Event.AUDIOTRACK_CHANGED, from: State.PLAYING, to: State.AUDIOTRACK_CHANGING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.READY, to: State.READY},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.AUDIOTRACK_CHANGING, to: State.AUDIOTRACK_CHANGING},\n        {name: Event.TIMECHANGED, from: State.AUDIOTRACK_CHANGING, to: State.PLAYING},\n\n        {name: Event.START_AD, from: State.PLAYING, to: State.AD},\n        {name: Event.END_AD, from: State.AD, to: State.PLAYING},\n\n        {name: Event.MUTE, from: State.READY, to: State.MUTING_READY},\n        {name: Event.UN_MUTE, from: State.READY, to: State.MUTING_READY},\n        {name: 'FINISH_MUTING', from: State.MUTING_READY, to: State.READY},\n\n        {name: Event.MUTE, from: State.PLAYING, to: State.MUTING_PLAY},\n        {name: Event.UN_MUTE, from: State.PLAYING, to: State.MUTING_PLAY},\n        {name: 'FINISH_MUTING', from: State.MUTING_PLAY, to: State.PLAYING},\n\n        {name: Event.MUTE, from: State.PAUSE, to: State.MUTING_PAUSE},\n        {name: Event.UN_MUTE, from: State.PAUSE, to: State.MUTING_PAUSE},\n        {name: 'FINISH_MUTING', from: State.MUTING_PAUSE, to: State.PAUSE},\n\n        {name: Event.START_CAST, from: [State.READY, State.PAUSE], to: State.CASTING},\n        {name: Event.PAUSE, from: State.CASTING, to: State.CASTING},\n        {name: Event.PLAY, from: State.CASTING, to: State.CASTING},\n        {name: Event.TIMECHANGED, from: State.CASTING, to: State.CASTING},\n        {name: Event.MUTE, from: State.CASTING, to: State.CASTING},\n        {name: Event.SEEK, from: State.CASTING, to: State.CASTING},\n        {name: Event.SEEKED, from: State.CASTING, to: State.CASTING},\n        {name: Event.END_CAST, from: State.CASTING, to: State.READY},\n\n        {name: Event.SEEK, from: State.READY, to: State.READY},\n        {name: Event.SEEKED, from: State.READY, to: State.READY},\n        {name: Event.SEEKED, from: State.STARTUP, to: State.STARTUP},\n\n        {name: Event.SOURCE_LOADED, from: this.getAllStates(), to: State.SETUP},\n        {name: Event.MANUAL_SOURCE_CHANGE, from: this.getAllStates(), to: State.SOURCE_CHANGING},\n        {name: Event.TIMECHANGED, from: State.SOURCE_CHANGING, to: State.SOURCE_CHANGING},\n        {name: Event.PAUSE, from: State.SOURCE_CHANGING, to: State.SOURCE_CHANGING},\n\n        {name: Event.VIDEO_CHANGE, from: State.REBUFFERING, to: State.QUALITYCHANGE_REBUFFERING},\n        {name: Event.AUDIO_CHANGE, from: State.REBUFFERING, to: State.QUALITYCHANGE_REBUFFERING},\n        {\n          name: Event.VIDEO_CHANGE,\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.QUALITYCHANGE_REBUFFERING,\n        },\n        {\n          name: Event.AUDIO_CHANGE,\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.QUALITYCHANGE_REBUFFERING,\n        },\n        {\n          name: 'FINISH_QUALITYCHANGE_REBUFFERING',\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.REBUFFERING,\n        },\n\n        {name: Event.CUSTOM_DATA_CHANGE, from: [State.PLAYING, State.PAUSE], to: State.CUSTOMDATACHANGE},\n        {name: Event.PLAYING, from: State.CUSTOMDATACHANGE, to: State.PLAYING},\n        {name: Event.PAUSE, from: State.CUSTOMDATACHANGE, to: State.PAUSE},\n\n        {name: Event.PLAYLIST_TRANSITION, from: this.getAllStates(), to: State.STARTUP},\n      ],\n      callbacks: {\n        onenterstate: (event, from, to, timestamp, eventObject) => {\n          if (from === 'none' && opts.starttime) {\n            this.onEnterStateTimestamp = opts.starttime;\n          } else {\n            this.onEnterStateTimestamp = timestamp || new Date().getTime();\n          }\n\n          logger.log('[ENTER] ' + padRight(to, 20) + 'EVENT: ' + padRight(event, 20) + ' from ' + padRight(from, 14));\n          if (eventObject && to !== State.PAUSED_SEEKING) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.START_CAST && to === State.CASTING) {\n            this.stateMachineCallbacks.startCasting(timestamp, eventObject);\n          }\n\n          if (to === State.REBUFFERING) {\n            this.startRebufferingHeartbeatInterval();\n          }\n        },\n        onafterevent: (event, from, to, timestamp, eventObject) => {\n          if (event === Event.MANUAL_SOURCE_CHANGE) {\n            this.stateMachineCallbacks.manualSourceChange(eventObject);\n          }\n          if (event === Event.PLAYLIST_TRANSITION) {\n            this.stateMachineCallbacks.playlistTransition(eventObject);\n          }\n          if (to === State.QUALITYCHANGE_PAUSE) {\n            this.stateMachine.FINISH_QUALITYCHANGE_PAUSE(timestamp);\n          }\n          if (to === State.QUALITYCHANGE) {\n            this.stateMachine.FINISH_QUALITYCHANGE(timestamp);\n          }\n          if (to === State.QUALITYCHANGE_REBUFFERING) {\n            this.stateMachine.FINISH_QUALITYCHANGE_REBUFFERING(timestamp);\n          }\n          if (to === State.MUTING_READY || to === State.MUTING_PLAY || to === State.MUTING_PAUSE) {\n            this.stateMachine.FINISH_MUTING(timestamp);\n          }\n        },\n        onleavestate: (event, from, to, timestamp, eventObject) => {\n          if (from === State.REBUFFERING) {\n            this.resetRebufferingHelpers();\n          }\n\n          if (!timestamp) {\n            return;\n          }\n\n          const stateDuration = timestamp - this.onEnterStateTimestamp;\n\n          if (eventObject && to !== State.PAUSED_SEEKING) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n          }\n\n          if (from === State.READY && to === State.STARTUP) {\n            this.setVideoStartTimeout();\n          } else if (from === State.STARTUP && to === State.PLAYING) {\n            this.clearVideoStartTimeout();\n          }\n\n          const fnName = String(from).toLowerCase();\n          if (to === State.EXIT_BEFORE_VIDEOSTART) {\n            this.clearVideoStartTimeout();\n            const eventData = this.getVideoStartupFailedEventData(timestamp, event, eventObject);\n            const shouldSendSample = event !== Event.ERROR;\n            this.stateMachineCallbacks.videoStartFailed(eventData, shouldSendSample);\n          } else if (from === State.PAUSED_SEEKING) {\n            const seekDuration = timestamp - this.seekStartedAt;\n            this.seekStartedAt = null;\n            this.stateMachineCallbacks[fnName](seekDuration, fnName, eventObject);\n          } else if (event === Event.UNLOAD) {\n            this.stateMachineCallbacks.unload(stateDuration, fnName);\n          } else if (from === State.PAUSE && to !== State.PAUSED_SEEKING) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(event);\n            this.stateMachineCallbacks.pause(stateDuration, fnName);\n          } else {\n            const callbackFunction = this.stateMachineCallbacks[fnName];\n            if (typeof callbackFunction === 'function') {\n              callbackFunction(stateDuration, fnName, eventObject);\n            } else {\n              logger.error('Could not find callback function for ' + fnName);\n            }\n          }\n\n          if (eventObject && to !== State.PAUSED_SEEKING) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.VIDEO_CHANGE) {\n            this.stateMachineCallbacks.videoChange(eventObject);\n          } else if (event === Event.AUDIO_CHANGE) {\n            this.stateMachineCallbacks.audioChange(eventObject);\n          } else if (event === Event.MUTE) {\n            this.stateMachineCallbacks.mute();\n          } else if (event === Event.UN_MUTE) {\n            this.stateMachineCallbacks.unMute();\n          }\n        },\n        onseek: (event, from, to, timestamp) => {\n          this.seekStartedAt = this.seekStartedAt || timestamp;\n        },\n        ontimechanged: (event, from, to, timestamp, eventObject) => {\n          const stateDuration = timestamp - this.onEnterStateTimestamp;\n\n          if (stateDuration > 59700) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n\n            this.stateMachineCallbacks.heartbeat(stateDuration, String(from).toLowerCase(), {played: stateDuration});\n            this.onEnterStateTimestamp = timestamp;\n\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n        },\n        onplayerError: (event, from, to, timestamp, eventObject) => {\n          this.stateMachineCallbacks.error(eventObject);\n        },\n      },\n    });\n  }\n\n  public callEvent<StatemachineEvent extends keyof EventMap, EventData extends EventMap[StatemachineEvent]>(\n    eventType: StatemachineEvent,\n    eventObject: NoExtraProperties<EventMap[StatemachineEvent], EventData>,\n    timestamp: number\n  ): void {\n    const exec = this.stateMachine[eventType];\n\n    if (exec) {\n      exec.call(this.stateMachine, timestamp, eventObject);\n    } else {\n      logger.log('Ignored Event: ' + eventType);\n    }\n  }\n\n  public sourceChange = (config: any, timestamp: number, currentTime?: number) => {\n    this.callEvent(Event.MANUAL_SOURCE_CHANGE, {config, currentTime}, timestamp);\n  };\n}\n","import {MIMETypes} from './MIMETypes';\n\nconst {MP4, WEBM, HLS, DASH} = MIMETypes;\n\nconst mapping = {\n  [MP4]: 'progressive',\n  [WEBM]: 'progressive',\n  [HLS]: 'hls',\n  [DASH]: 'dash',\n};\n\nexport function getStreamTypeFromMIMEType(mimeType: string) {\n  return mapping[mimeType];\n}\n","import {Bitmovin7Adapter} from '../adapters/Bitmovin7Adapter';\nimport {Bitmovin8Adapter} from '../adapters/Bitmovin8Adapter';\nimport {CAFv3Adapter} from '../adapters/CAFv3Adapter';\nimport {DashjsAdapter} from '../adapters/DashjsAdapter';\nimport {HlsAdapter} from '../adapters/HlsAdapter';\nimport {HTMLVideoElementAdapter} from '../adapters/HTMLVideoElementAdapter';\nimport {ShakaAdapter} from '../adapters/ShakaAdapter';\nimport {VideojsAdapter} from '../adapters/VideoJsAdapter';\nimport {CdnProvider} from '../enums/CDNProvider';\nimport {Player} from '../enums/Player';\nimport {VERSION} from '../Version';\n\n// tslint:disable-next-line:variable-name\nconst AnalyticsModule = {\n  name: 'analytics',\n  module: {\n    Analytics: Bitmovin8Adapter,\n  },\n  hooks: {\n    setup: (module: any, player: any) => {\n      const config = player.getConfig();\n      if (!config || config.analytics === false) {\n        return Promise.resolve();\n      }\n      const analyticsModule = module.Analytics;\n      const analyticsModuleInstance = new analyticsModule(player);\n      return Promise.resolve(analyticsModuleInstance);\n    },\n  },\n};\n\nexport {Player as Players};\nexport {CdnProvider as CdnProviders};\nexport {AnalyticsModule as PlayerModule};\nexport {VERSION as version};\nexport {HlsAdapter};\nexport {Bitmovin8Adapter};\nexport {Bitmovin7Adapter};\nexport {VideojsAdapter};\nexport {CAFv3Adapter};\nexport {ShakaAdapter};\nexport {DashjsAdapter};\nexport {HTMLVideoElementAdapter};\nexport {adapters};\n\nconst adapters = {\n  HlsAdapter,\n  Bitmovin8Adapter,\n  Bitmovin7Adapter,\n  VideojsAdapter,\n  ShakaAdapter,\n  DashjsAdapter,\n  CAFv3Adapter,\n  HTMLVideoElementAdapter,\n};\n\nexport default {\n  PlayerModule: AnalyticsModule,\n};\n","import {AdapterAPI} from '../api/AdapterAPI';\nimport {Analytics} from '../core/Analytics';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {logger} from '../utils/Logger';\nimport {Adapter} from './Adapter';\nimport {Bitmovin7InternalAdapter} from './internal/Bitmovin7InternalAdapter';\n\nexport class Bitmovin7Adapter extends Adapter implements AdapterAPI {\n  constructor(player, opts?: AnalyticsStateMachineOptions) {\n    super();\n    this.augment(player, opts);\n  }\n\n  private augment(player, opts?: AnalyticsStateMachineOptions) {\n    if (this.hasPlayerAlreadyBeenAugmented(player)) {\n      logger.errorMessageToUser('Bitmovin Analytics is already hooked up to this player instance');\n      return;\n    }\n    this.markPlayerInstanceAsAugmented(player);\n\n    const that = this;\n    // decorate player to intercept setup\n    const originalSetup = player.setup;\n\n    // tslint:disable-next-line\n    player.setup = function () {\n      const playerSetupPromise = originalSetup.apply(player, arguments);\n\n      if (arguments.length === 0) {\n        return playerSetupPromise;\n      }\n      const config = arguments[0];\n      const analyticsConfig = config.analytics;\n      if (!analyticsConfig) {\n        logger.error('Bitmovin Analytics: No analytics config provided!');\n        return playerSetupPromise;\n      }\n\n      that.internalAdapter = new Bitmovin7InternalAdapter(player, opts);\n      that.analytics = new Analytics(analyticsConfig, that.internalAdapter);\n      (player as any).analytics = that.analytics;\n      that.wrapPlayerLoad(player, that.analytics);\n\n      return playerSetupPromise;\n    };\n  }\n\n  private wrapPlayerLoad(player, analytics: Analytics) {\n    const originalLoad = player.load;\n    // tslint:disable-next-line\n    player.load = function () {\n      if (arguments.length > 0) {\n        const analyticsConfig = arguments[0].analytics;\n        // we reset the analytics and reload with a new config\n        analytics.sourceChange(analyticsConfig);\n      }\n\n      return originalLoad.apply(player, arguments);\n    };\n  }\n}\n","import {logger} from '../utils/Logger';\nimport {Feature} from './Feature';\nimport {FeatureConfig} from './FeatureConfig';\n\nexport class FeatureManager<TConfigContainer> {\n  private features: Array<Feature<TConfigContainer, FeatureConfig>> = [];\n\n  public registerFeatures(features: Array<Feature<TConfigContainer, FeatureConfig>>) {\n    this.features = features;\n  }\n\n  public unregisterFeatures() {\n    this.features.forEach((feature) => feature.disable());\n    this.features = [];\n  }\n\n  public resetFeatures() {\n    this.features.forEach((feature) => feature.reset());\n  }\n\n  public configureFeatures(authenticated: boolean, featureConfigs?: TConfigContainer) {\n    this.features = this.features.filter((feature) => {\n      const config = feature.configure(authenticated, featureConfigs);\n      if (!authenticated || config?.enabled !== true) {\n        logger.log(`Disabling feature ${feature.constructor.name} as it isn't enabled according to license callback.`);\n        feature.disable();\n        return false;\n      }\n      return true;\n    });\n    this.features.forEach((feature) => feature.enabled());\n  }\n}\n","const videoFormatCodecMap: {[format: string]: string[]} = {\n  avc: ['video/mp4; codecs=\"avc1.42000a\"'],\n  vp9: ['video/mp4; codecs=\"vp09.00.50.08\"'],\n  av1: ['video/mp4; codecs=\"av01.0.08M.08\"'],\n  hevc: ['video/mp4; codecs=\"hev1.1.6.L93.B0\"'],\n};\n\nexport class CodecHelper {\n  public static get supportedVideoFormats(): string[] | undefined {\n    if (!('MediaSource' in window)) {\n      return undefined;\n    }\n    const codecs = Object.getOwnPropertyNames(videoFormatCodecMap).filter((format) =>\n      videoFormatCodecMap[format].some((codec) => this.isCodecSupported(codec))\n    );\n    return codecs;\n  }\n\n  public static isCodecSupported(codec: string): boolean {\n    if (!('MediaSource' in window)) {\n      return false;\n    }\n\n    return MediaSource.isTypeSupported(codec);\n  }\n}\n","export enum PAGE_LOAD_TYPE {\n  FOREGROUND = 1,\n  BACKGROUND = 2,\n}\n","import {\n  Ad,\n  AdBreak,\n  AdBreakEvent,\n  AdClickedEvent,\n  AdEvent,\n  AdLinearityChangedEvent,\n  AdManifestLoadedEvent,\n  AdQuartileEvent,\n  AdTagConfig,\n  ErrorEvent,\n} from 'bitmovin-player';\nimport {AdModuleAPI} from '../adapters/internal/ads/AdModuleAPI';\nimport {AdAnalyticsSample} from '../types/AdAnalyticsSample';\nimport {AdBreakSample} from '../types/AdBreakSample';\nimport {AdSample} from '../types/AdSample';\nimport {Sample} from '../types/Sample';\nimport {logger} from '../utils/Logger';\nimport * as Utils from '../utils/Utils';\nimport {ViewportTracker} from '../utils/ViewportTracker';\nimport {Analytics} from './Analytics';\n\nenum AdQuartile {\n  FIRST_QUARTILE = 'firstQuartile',\n  MIDPOINT = 'midpoint',\n  THIRD_QUARTILE = 'thirdQuartile',\n}\n\ndeclare var __VERSION__: any;\n\nexport class AdAnalytics {\n  public static readonly MODULE_NAME = 'ads';\n  private static readonly TIMEOUT_CURRENT_TIME_INTERVAL = 100;\n\n  private onBeforeUnLoadEvent: boolean = false;\n  private analytics: Analytics;\n  private adapter: AdModuleAPI;\n  private viewportTracker: ViewportTracker;\n\n  private activeAdBreakSample?: AdBreakSample;\n  private activeAdSample?: AdSample;\n\n  private adManifestLoadedEvents: AdManifestLoadedEvent[] = [];\n  private adStartupTimestamp?: number;\n  private beginPlayingTimestamp?: number;\n  private enterViewportTimestamp?: number;\n  private isPlaying: boolean = false;\n  private currentTime?: number;\n  private currentTimeInterval?: number;\n  private adPodPosition: number = 0;\n\n  constructor(analytics: Analytics, adapter: AdModuleAPI) {\n    this.analytics = analytics;\n    this.adapter = adapter;\n\n    this.adapter.adCallbacks.onAdStarted = (event) => this.onAdStarted(event);\n    this.adapter.adCallbacks.onAdFinished = (event) => this.onAdFinished(event);\n    this.adapter.adCallbacks.onAdBreakStarted = (event) => this.onAdBreakStarted(event);\n    this.adapter.adCallbacks.onAdBreakFinished = (event) => this.onAdBreakFinished(event);\n    this.adapter.adCallbacks.onAdClicked = (event) => this.onAdClicked(event);\n    this.adapter.adCallbacks.onAdError = (event) => this.onAdError(event);\n    this.adapter.adCallbacks.onAdManifestLoaded = (event) => this.onAdManifestLoaded(event);\n    this.adapter.adCallbacks.onPlay = () => this.onPlay();\n    this.adapter.adCallbacks.onPause = () => this.onPause();\n    this.adapter.adCallbacks.onBeforeUnload = () => this.onBeforeUnload();\n    this.adapter.adCallbacks.onAdSkipped = (event) => this.onAdSkipped(event);\n    this.adapter.adCallbacks.onAdQuartile = (event) => this.onAdQuartile(event);\n\n    this.viewportTracker = new ViewportTracker(this.adapter.getContainer(), () => this.onIntersectionChanged(), 0.5);\n  }\n\n  public onIntersectionChanged() {\n    if (!this.activeAdSample) {\n      return;\n    }\n    if (this.isContainerInViewport()) {\n      this.enterViewportTimestamp = Utils.getCurrentTimestamp();\n    } else {\n      if (this.enterViewportTimestamp) {\n        this.activeAdSample.timeInViewport =\n          (this.activeAdSample.timeInViewport || 0) + Utils.getCurrentTimestamp() - this.enterViewportTimestamp;\n      }\n    }\n  }\n\n  public isContainerInViewport(): boolean {\n    return this.viewportTracker ? this.viewportTracker.isInViewport() : true;\n  }\n\n  public onPlay() {\n    if (this.adapter && this.adapter.isLinearAdActive() && this.activeAdSample) {\n      const timestamp = Utils.getCurrentTimestamp();\n      this.beginPlayingTimestamp = timestamp;\n      this.enterViewportTimestamp = timestamp;\n      this.isPlaying = true;\n    }\n  }\n\n  public onPause() {\n    if (this.adapter && this.adapter.isLinearAdActive() && this.activeAdSample) {\n      this.updatePlayingTime(this.activeAdSample);\n      this.isPlaying = false;\n    }\n  }\n\n  public onAdManifestLoaded(event: AdManifestLoadedEvent) {\n    const adTagConfig = event.adConfig as AdTagConfig;\n    if (adTagConfig && adTagConfig.tag && adTagConfig.tag.type === 'vmap') {\n      this.sendAnalyticsRequest(new AdBreakSample(event.adConfig, event));\n    } else if (event.adBreak) {\n      this.adManifestLoadedEvents.push(event);\n    }\n  }\n\n  public onAdBreakStarted(event: AdBreakEvent) {\n    this.adPodPosition = 0;\n    this.activeAdBreakSample = new AdBreakSample(event.adBreak, this.getAdManifestLoadedEvent(event.adBreak));\n    this.adStartupTimestamp = Utils.getCurrentTimestamp();\n  }\n\n  public onAdBreakFinished(event: AdBreakEvent) {\n    this.resetActiveAd();\n    this.activeAdBreakSample = undefined;\n  }\n\n  public onAdStarted(event: AdEvent) {\n    if (!event.ad.isLinear) {\n      return;\n    }\n\n    this.resetActiveAd();\n    this.activeAdSample = new AdSample(event.ad);\n    this.currentTime = undefined;\n    this.activeAdSample.adStartupTime = this.adStartupTimestamp\n      ? Utils.getCurrentTimestamp() - this.adStartupTimestamp\n      : undefined;\n\n    this.startAd(this.activeAdSample);\n  }\n\n  public onAdFinished(event: AdEvent) {\n    if (!this.activeAdBreakSample || !this.activeAdSample) {\n      return;\n    }\n\n    const adSample = {...this.activeAdSample};\n    adSample.completed = 1;\n    this.resetActiveAd();\n    this.completeAd(this.activeAdBreakSample, adSample, adSample.adDuration);\n  }\n\n  public onAdSkipped(event: AdEvent) {\n    if (!this.activeAdBreakSample || !this.activeAdSample) {\n      return;\n    }\n\n    const adSample = {...this.activeAdSample};\n    adSample.skipped = 1;\n    adSample.skipPosition = this.currentTime;\n    adSample.skipPercentage = Utils.calculatePercentage(\n      this.activeAdSample.skipPosition,\n      this.activeAdSample.adDuration\n    );\n    this.resetActiveAd();\n    this.completeAd(this.activeAdBreakSample, adSample, adSample.skipPosition);\n  }\n\n  public onAdError(event: ErrorEvent) {\n    const {adConfig, adBreak, code, message} = event.data || {\n      adBreak: undefined,\n      adConfig: undefined,\n      code: undefined,\n      message: undefined,\n    };\n\n    const adBreakSample = new AdBreakSample(\n      adBreak || adConfig,\n      adBreak ? this.getAdManifestLoadedEvent(adBreak) : undefined\n    );\n\n    adBreakSample.errorCode = code || event.code;\n    adBreakSample.errorData = JSON.stringify(event.data);\n    adBreakSample.errorMessage = message || event.name;\n\n    let adSample;\n    let errorPosition;\n    if (\n      this.activeAdSample &&\n      adBreak &&\n      adBreak.ads &&\n      (adBreak.ads as any[]).includes((ad: Ad) => ad.id === (this.activeAdSample as AdSample).adId)\n    ) {\n      adSample = this.activeAdSample;\n      errorPosition = adSample.errorPosition = this.currentTime;\n      adSample.errorPercentage = Utils.calculatePercentage(adSample.errorPosition, adSample.adDuration);\n    }\n    this.completeAd(adBreakSample, adSample, errorPosition);\n  }\n\n  public onAdLinearityChanged(event: AdLinearityChangedEvent) {}\n\n  public onAdClicked(event: AdClickedEvent) {\n    if (!this.activeAdSample) {\n      return;\n    }\n    this.activeAdSample.adClickthroughUrl = event.clickThroughUrl;\n    this.activeAdSample.clicked = 1;\n    this.activeAdSample.clickPosition = this.currentTime;\n    this.activeAdSample.clickPercentage = Utils.calculatePercentage(\n      this.activeAdSample.clickPosition,\n      this.activeAdSample.adDuration\n    );\n  }\n\n  public onAdQuartile(event: AdQuartileEvent) {\n    if (!this.activeAdSample) {\n      return;\n    }\n    if (event.quartile === AdQuartile.FIRST_QUARTILE) {\n      this.activeAdSample.quartile1 = 1;\n    } else if (event.quartile === AdQuartile.MIDPOINT) {\n      this.activeAdSample.midpoint = 1;\n    } else if (event.quartile === AdQuartile.THIRD_QUARTILE) {\n      this.activeAdSample.quartile3 = 1;\n    }\n  }\n\n  public onBeforeUnload() {\n    if (this.onBeforeUnLoadEvent) {\n      return;\n    }\n    this.onBeforeUnLoadEvent = true;\n    if (!this.activeAdSample || !this.activeAdBreakSample) {\n      return;\n    }\n\n    const adSample = {...this.activeAdSample};\n    adSample.closed = 1;\n    adSample.closePosition = this.currentTime;\n    adSample.closePercentage = Utils.calculatePercentage(adSample.closePosition, adSample.adDuration);\n    this.resetActiveAd();\n    this.completeAd(this.activeAdBreakSample, adSample, adSample.closePosition);\n  }\n\n  public createNewAdAnalyticsSample(analyticsSample: Sample): AdAnalyticsSample {\n    const moduleInfo = this.adapter.getAdModuleInfo();\n    return {\n      ...new AdAnalyticsSample(analyticsSample),\n      analyticsVersion: __VERSION__,\n      adModule: moduleInfo.name,\n      adModuleVersion: moduleInfo.version,\n      playerStartupTime: this.analytics.playerStartupTime,\n      pageLoadTime: this.analytics.pageLoadTime,\n      autoplay: this.analytics.autoplay,\n      pageLoadType: Utils.getPageLoadType(),\n    };\n  }\n\n  private getAdManifestLoadedEvent(adBreak: AdBreak) {\n    if (!adBreak) {\n      return undefined;\n    }\n    return this.adManifestLoadedEvents.find((i) => i.adBreak && i.adBreak.id === adBreak.id);\n  }\n\n  private sendAnalyticsRequest(adBreakSample: AdBreakSample, adSample?: AdSample) {\n    const sample = {\n      ...this.createNewAdAnalyticsSample(this.analytics.sample),\n      ...adBreakSample,\n      ...(adSample || new AdSample()),\n    };\n    sample.time = Utils.getCurrentTimestamp();\n    sample.adImpressionId = Utils.generateUUID();\n    sample.percentageInViewport = Utils.calculatePercentage(sample.timeInViewport, sample.timePlayed);\n    this.analytics.backend.sendAdRequest(sample);\n  }\n\n  private updatePlayingTime(adSample: AdSample) {\n    const timestamp = Utils.getCurrentTimestamp();\n    if (this.beginPlayingTimestamp && this.isPlaying) {\n      if (adSample.timePlayed !== undefined) {\n        adSample.timePlayed += timestamp - this.beginPlayingTimestamp;\n      }\n      if (this.isContainerInViewport() && this.enterViewportTimestamp && adSample.timeInViewport !== undefined) {\n        adSample.timeInViewport += timestamp - this.enterViewportTimestamp;\n      }\n    }\n  }\n\n  private startAd(adSample: AdSample) {\n    adSample.started = 1;\n    adSample.timePlayed = 0;\n    adSample.timeInViewport = 0;\n    adSample.adPodPosition = this.adPodPosition;\n    const timestamp = Utils.getCurrentTimestamp();\n    this.beginPlayingTimestamp = timestamp;\n    this.enterViewportTimestamp = this.isContainerInViewport() ? timestamp : undefined;\n    this.isPlaying = true;\n    this.currentTime = 0;\n    this.adPodPosition++;\n    this.currentTimeInterval = window.setInterval(() => {\n      try {\n        if (\n          adSample &&\n          adSample.adDuration !== undefined &&\n          adSample.adDuration > 0 &&\n          this.adapter.isLinearAdActive()\n        ) {\n          this.currentTime = Utils.calculateTime(Math.max(this.adapter.currentTime(), 0));\n        }\n      } catch (e) {\n        logger.log('AdStarted monitoring interval failed and got cleared', e);\n        this.resetActiveAd();\n      }\n    }, AdAnalytics.TIMEOUT_CURRENT_TIME_INTERVAL);\n  }\n\n  private completeAd(adBreakSample: AdBreakSample, adSample: AdSample = new AdSample(), exitPosition?: number) {\n    adSample.exitPosition = exitPosition;\n    adSample.playPercentage = Utils.calculatePercentage(adSample.exitPosition, adSample.adDuration);\n\n    // reset startupTimestamp for the next ad, in case there are multiple ads in one ad break\n    this.adStartupTimestamp = Utils.getCurrentTimestamp();\n    this.updatePlayingTime(adSample);\n    this.isPlaying = false;\n    this.sendAnalyticsRequest(adBreakSample, adSample);\n  }\n\n  private resetActiveAd() {\n    window.clearInterval(this.currentTimeInterval);\n    this.currentTime = undefined;\n    this.activeAdSample = undefined;\n  }\n}\n","import * as Utils from '../utils/Utils';\nimport {CustomDataValues} from './CustomDataValues';\nimport {Sample} from './Sample';\n\nexport class AdAnalyticsSample implements CustomDataValues {\n  public adModule?: string;\n  public adModuleVersion?: string;\n  public videoImpressionId?: string;\n  public userAgent?: string;\n  public language?: string;\n  public cdnProvider?: string;\n  public customData1?: string;\n  public customData2?: string;\n  public customData3?: string;\n  public customData4?: string;\n  public customData5?: string;\n  public customData6?: string;\n  public customData7?: string;\n  public customData8?: string;\n  public customData9?: string;\n  public customData10?: string;\n  public customData11?: string;\n  public customData12?: string;\n  public customData13?: string;\n  public customData14?: string;\n  public customData15?: string;\n  public customData16?: string;\n  public customData17?: string;\n  public customData18?: string;\n  public customData19?: string;\n  public customData20?: string;\n  public customData21?: string;\n  public customData22?: string;\n  public customData23?: string;\n  public customData24?: string;\n  public customData25?: string;\n  public customUserId?: string;\n  public experimentName?: string;\n  public domain?: string;\n  public key?: string;\n  public path?: string;\n  public player?: string;\n  public playerKey?: string;\n  public playerTech?: string;\n  public screenHeight?: number;\n  public screenWidth?: number;\n  public version?: string;\n  public size?: string;\n  public userId?: string;\n  public videoId?: string;\n  public videoTitle?: string;\n  public videoWindowHeight?: number;\n  public videoWindowWidth?: number;\n  public playerStartupTime?: number;\n  public analyticsVersion?: string;\n  public pageLoadTime?: number;\n  public pageLoadType?: number;\n  public autoplay?: boolean;\n  public platform: string = 'web';\n  public audioCodec?: string;\n  public videoCodec?: string;\n\n  constructor(sample?: Sample) {\n    if (!sample) {\n      return;\n    }\n    this.videoImpressionId = sample.impressionId;\n    this.userAgent = sample.userAgent;\n    this.language = sample.language;\n    this.cdnProvider = sample.cdnProvider;\n\n    Utils.transferCustomDataFields(sample, this);\n\n    this.customUserId = sample.customUserId;\n    this.domain = sample.domain;\n    this.experimentName = sample.experimentName;\n    this.key = sample.key;\n    this.path = sample.path;\n    this.player = sample.player;\n    this.playerKey = sample.playerKey;\n    this.playerTech = sample.playerTech;\n    this.screenHeight = sample.screenHeight;\n    this.screenWidth = sample.screenWidth;\n    this.version = sample.version;\n    this.size = sample.size;\n    this.userId = sample.userId;\n    this.videoId = sample.videoId;\n    this.videoTitle = sample.videoTitle;\n    this.videoWindowHeight = sample.videoWindowHeight;\n    this.videoWindowWidth = sample.videoWindowWidth;\n    this.audioCodec = sample.audioCodec;\n    this.videoCodec = sample.videoCodec;\n  }\n}\n","import {AdBreak, AdBreakConfig, AdConfig, AdManifestLoadedEvent, AdTagConfig} from 'bitmovin-player';\nimport * as Utils from '../utils/Utils';\n\nexport class AdBreakSample {\n  public adPosition?: string;\n  public adOffset?: string;\n  public adScheduleTime?: number;\n  public adReplaceContentDuration?: number;\n  public adPreloadOffset?: number;\n  public adTagPath?: string;\n  public adTagServer?: string;\n  public adTagType?: string;\n  public adTagUrl?: string;\n  public adIsPersistent?: boolean;\n  public adIdPlayer?: string;\n  public manifestDownloadTime?: number;\n  public errorCode?: number;\n  public errorData?: string;\n  public errorMessage?: string;\n  public adFallbackIndex: number = 0;\n\n  constructor(adConfig?: AdConfig, adManifestLoadedEvent?: AdManifestLoadedEvent) {\n    if (adManifestLoadedEvent) {\n      this.manifestDownloadTime = Utils.calculateTime(adManifestLoadedEvent.downloadTiming.downloadTime);\n    }\n\n    if (adConfig) {\n      this.adReplaceContentDuration = Utils.calculateTimeWithUndefined(adConfig.replaceContentDuration);\n      this.adFallbackIndex = ((adConfig as any).currentFallbackIndex || -1) + 1;\n    }\n\n    const adBreakConfig = adConfig as AdBreakConfig;\n    if (adBreakConfig) {\n      if (adBreakConfig.position === 'pre' || adBreakConfig.position === 'post') {\n        this.adPosition = adBreakConfig.position;\n      } else {\n        this.adPosition = 'mid';\n        this.adOffset = adBreakConfig.position;\n      }\n\n      this.adPreloadOffset = Utils.calculateTimeWithUndefined(adBreakConfig.preloadOffset);\n    }\n\n    const adTagConfig = adConfig as AdTagConfig;\n    if (adTagConfig) {\n      this.adIsPersistent = adTagConfig.persistent;\n      let tag = adTagConfig.tag;\n      if (\n        this.adFallbackIndex > 0 &&\n        adTagConfig.fallbackTags &&\n        adTagConfig.fallbackTags.length >= this.adFallbackIndex\n      ) {\n        tag = adTagConfig.fallbackTags[this.adFallbackIndex - 1];\n      }\n      if (tag) {\n        this.adTagType = tag.type;\n        this.adTagUrl = tag.url;\n      }\n      if (this.adTagUrl) {\n        const adTagDetails = Utils.getHostnameAndPathFromUrl(this.adTagUrl);\n        this.adTagServer = adTagDetails.hostname;\n        this.adTagPath = adTagDetails.path;\n      }\n    }\n\n    const adBreak = adConfig as AdBreak;\n    if (adBreak) {\n      this.adScheduleTime = Utils.calculateTimeWithUndefined(adBreak.scheduleTime);\n      this.adIdPlayer = adBreak.id;\n    }\n  }\n}\n","import {Ad, LinearAd, VastAdData} from 'bitmovin-player';\nimport * as Utils from '../utils/Utils';\n\nexport class AdSample {\n  private static parseSkipAfter(skipAfter?: number) {\n    if (skipAfter === undefined) {\n      return undefined;\n    }\n    if (skipAfter === -1) {\n      return skipAfter;\n    }\n    return Utils.calculateTime(skipAfter);\n  }\n\n  public wrapperAdsCount?: number;\n  public adSkippable?: boolean;\n  public adSkippableAfter?: number;\n  public adClickthroughUrl?: string;\n  public adDescription?: string;\n  public adDuration?: number;\n  public adId?: string;\n  public adImpressionId?: string;\n  public adPlaybackHeight?: number;\n  public adPlaybackWidth?: number;\n  public adStartupTime?: number;\n  public adSystem?: string;\n  public adTitle?: string;\n  public advertiserName?: string;\n  public apiFramework?: string;\n  public audioBitrate?: number;\n  public clicked: number = 0;\n  public clickPosition?: number;\n  public closed: number = 0;\n  public closePosition?: number;\n  public completed: number = 0;\n  public creativeAdId?: string;\n  public creativeId?: string;\n  public dealId?: string;\n  public isLinear?: boolean;\n  public mediaPath?: string;\n  public mediaServer?: string;\n  public mediaUrl?: string;\n  public midpoint: number = 0;\n  public minSuggestedDuration?: number;\n  public percentageInViewport?: number;\n  public quartile1: number = 0;\n  public quartile3: number = 0;\n  public skipped: number = 0;\n  public skipPosition?: number;\n  public started: number = 0;\n  public streamFormat?: string;\n  public surveyUrl?: string;\n  public time?: number;\n  public timeHovered?: number;\n  public timeInViewport?: number;\n  public timePlayed?: number;\n  public timeUntilHover?: number;\n  public universalAdIdRegistry?: string;\n  public universalAdIdValue?: string;\n  public videoBitrate?: number;\n  public adPodPosition?: number;\n  public exitPosition?: number;\n  public playPercentage?: number;\n  public skipPercentage?: number;\n  public clickPercentage?: number;\n  public closePercentage?: number;\n  public errorPosition?: number;\n  public errorPercentage?: number;\n  public timeToContent?: number;\n  public timeFromContent?: number;\n\n  constructor(ad?: Ad) {\n    if (ad) {\n      this.adClickthroughUrl = ad.clickThroughUrl;\n      this.adId = ad.id;\n      this.mediaUrl = ad.mediaFileUrl;\n      const mediaUrlDetails = Utils.getHostnameAndPathFromUrl(this.mediaUrl || '');\n      this.mediaPath = mediaUrlDetails.path;\n      this.mediaServer = mediaUrlDetails.hostname;\n      this.isLinear = ad.isLinear;\n      this.adPlaybackHeight = ad.height;\n      this.adPlaybackWidth = ad.width;\n\n      if (ad.data) {\n        this.videoBitrate = ad.data.bitrate === undefined ? undefined : ad.data.bitrate * 1000;\n        this.streamFormat = ad.data.mimeType;\n        // data.minBitrate\n        // data.maxBitrate\n      }\n\n      const data = ad.data as VastAdData;\n      if (data) {\n        if (data.adSystem) {\n          this.adSystem = data.adSystem.name;\n          // this.adSystemVersion = data.adSystem.version;\n        }\n        if (data.advertiser) {\n          this.advertiserName = data.advertiser.name;\n          // this.advertiserId = data.advertiser.id;\n        }\n        // data.codec\n        // data.delivery\n        // data.pricing\n        this.apiFramework = data.apiFramework;\n\n        if (data.creative) {\n          this.creativeAdId = data.creative.adId;\n          this.creativeId = data.creative.id;\n\n          if (data.creative.universalAdId) {\n            this.universalAdIdRegistry = data.creative.universalAdId.idRegistry;\n            this.universalAdIdValue = data.creative.universalAdId.value;\n          }\n        }\n        this.adDescription = data.adDescription;\n        this.minSuggestedDuration = Utils.calculateTimeWithUndefined(data.minSuggestedDuration);\n        if (data.survey) {\n          this.surveyUrl = data.survey.uri;\n          // data.survey.type;\n        }\n        this.adTitle = data.adTitle;\n        this.wrapperAdsCount = data.wrapperAdIds ? data.wrapperAdIds.length : 0;\n      }\n    }\n    const linearAd = ad as LinearAd;\n    if (linearAd) {\n      this.adSkippableAfter = AdSample.parseSkipAfter(linearAd.skippableAfter);\n      this.adSkippable =\n        linearAd.skippable || (this.adSkippableAfter === undefined ? undefined : this.adSkippableAfter >= 0);\n      this.adDuration = Utils.calculateTime(linearAd.duration);\n    }\n  }\n}\n","import {logger} from './Logger';\nimport * as Utils from './Utils';\n\nexport class ViewportTracker {\n  private onIntersectionChanged: () => void;\n  private observer?: IntersectionObserver;\n  private element: HTMLElement;\n  private inViewport?: boolean = undefined;\n  private threshold: number;\n  private hidden: string | undefined;\n  private visibilityChange?: string;\n\n  constructor(element: HTMLElement, onIntersectionChanged: () => void, threshold: number = 1.0) {\n    this.threshold = threshold;\n    this.onIntersectionChanged = onIntersectionChanged;\n    this.element = element;\n\n    try {\n      const options: IntersectionObserverInit = {\n        root: null,\n        rootMargin: '0px',\n        threshold,\n      };\n      this.observer = new IntersectionObserver((entries, observer) => this.handleIntersect(entries, observer), options);\n      this.observer.observe(element);\n    } catch (error) {\n      logger.log(\"Couldn't create instance of IntersectionObserver. timeInViewport will always be reported as 100%.\");\n    }\n\n    this.hidden = Utils.getHiddenProp();\n    if (this.hidden) {\n      this.visibilityChange = this.hidden.replace('hidden', '') + 'visibilitychange';\n      document.addEventListener(\n        this.visibilityChange,\n        (this.handleVisibilityChange = this.handleVisibilityChange.bind(this)),\n        false\n      );\n    }\n  }\n\n  public isHidden() {\n    return this.hidden && document[this.hidden];\n  }\n\n  public isInViewport(): boolean {\n    return !this.isHidden() && (this.inViewport == null ? true : this.inViewport);\n  }\n\n  public dispose() {\n    if (this.observer) {\n      this.observer.unobserve(this.element);\n      this.observer.disconnect();\n    }\n    if (this.visibilityChange) {\n      document.removeEventListener(this.visibilityChange, this.handleVisibilityChange, false);\n    }\n  }\n\n  private handleVisibilityChange() {\n    this.onIntersectionChanged();\n  }\n\n  private handleIntersect(entries: IntersectionObserverEntry[], observer: IntersectionObserver) {\n    entries.forEach((i) => {\n      if (i.target === this.element) {\n        this.inViewport = !(i.intersectionRatio < this.threshold);\n      }\n    });\n    this.onIntersectionChanged();\n  }\n}\n","import {DeferredLicenseLoadingAdapterAPI} from '../adapters/internal/DeferredLicenseLoadingAdapterAPI';\nimport {AnalyticsConfig, CollectorConfig} from '../types/AnalyticsConfig';\nimport {AuthenticationCallback} from '../types/AuthenticationCallback';\nimport {LicensingRequest} from '../types/LicensingRequest';\nimport {LicenseCall} from '../utils/LicenseCall';\nimport {ANALYTICS_BACKEND_BASE_URL} from '../utils/Settings';\nimport {Backend} from './Backend';\nimport {DebuggingBackend} from './DebuggingBackend';\nimport {LicenseCheckingBackend} from './LicenseCheckingBackend';\nimport {LongPlaytimeFilteringBackend} from './LongPlaytimeFilteringBackend';\nimport {NoOpBackend} from './NoOpBackend';\nimport {SequenceNumberBackend} from './SequenceNumberBackend';\n\ninterface InternalCollectorConfig extends CollectorConfig {\n  wrapBackend: (innerBackend: Backend) => Backend;\n}\n\nexport class BackendFactory {\n  public createBackend(\n    analyticsConfig: AnalyticsConfig,\n    licensingRequest: LicensingRequest,\n    adapter: DeferredLicenseLoadingAdapterAPI,\n    authenticationCallback: AuthenticationCallback\n  ): Backend {\n    if (!this.isEnabled(analyticsConfig)) {\n      return new NoOpBackend();\n    }\n    const inner = this.createInnerBackend(analyticsConfig, licensingRequest, adapter, authenticationCallback);\n    return this.decorateWithDebuggingBackend(analyticsConfig, inner);\n  }\n\n  private decorateWithDebuggingBackend(config: AnalyticsConfig, backend: Backend): Backend {\n    if (config.debug) {\n      return new DebuggingBackend(config, backend);\n    }\n    return backend;\n  }\n\n  private decorateWithBackendFromConfigIfAvailable(analyticsConfig: AnalyticsConfig, innerBackend: Backend): Backend {\n    if (\n      analyticsConfig !== undefined &&\n      analyticsConfig.config !== undefined &&\n      (analyticsConfig.config as InternalCollectorConfig).wrapBackend !== undefined\n    ) {\n      return (analyticsConfig.config as InternalCollectorConfig).wrapBackend(innerBackend);\n    }\n\n    return innerBackend;\n  }\n\n  private isEnabled(analyticsConfig: AnalyticsConfig): boolean {\n    return analyticsConfig.config === undefined || analyticsConfig.config.enabled !== false;\n  }\n\n  private createInnerBackend(\n    analyticsConfig: AnalyticsConfig,\n    licensingRequest: LicensingRequest,\n    adapter: DeferredLicenseLoadingAdapterAPI,\n    authenticationCallback: AuthenticationCallback\n  ): Backend {\n    const backendUrl = (analyticsConfig.config && analyticsConfig.config.backendUrl) || ANALYTICS_BACKEND_BASE_URL;\n    let innerBackend: Backend = new LicenseCheckingBackend(\n      licensingRequest,\n      LicenseCall,\n      backendUrl,\n      adapter,\n      authenticationCallback\n    );\n    innerBackend = this.decorateWithBackendFromConfigIfAvailable(analyticsConfig, innerBackend);\n\n    const sequenceNumberAssigningBackend = new SequenceNumberBackend(innerBackend);\n    return new LongPlaytimeFilteringBackend(sequenceNumberAssigningBackend);\n  }\n}\n","import {LicensingResponse} from '../types/LicensingRequest';\nimport {post} from './Http';\nimport {joinUrls} from './Utils';\n\nexport function LicenseCall(key: string, domain: string, version: string, baseUrl: string): Promise<LicensingResponse> {\n  const licenseServerUrl = joinUrls(baseUrl, '/licensing');\n  const licensingRequest = {\n    analyticsVersion: version,\n    domain,\n    key,\n  };\n\n  return new Promise<LicensingResponse>((resolve) => {\n    post(licenseServerUrl, licensingRequest, (response) => {\n      resolve(response);\n    });\n  });\n}\n","import {AdAnalyticsSample} from '../types/AdAnalyticsSample';\nimport {AdBreakSample} from '../types/AdBreakSample';\nimport {AdSample} from '../types/AdSample';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AnalyticsDebugConfig} from '../types/AnalyticsDebugConfig';\nimport {Sample} from '../types/Sample';\nimport {logger} from '../utils/Logger';\nimport {Backend} from './Backend';\n\nexport class DebuggingBackend implements Backend {\n  private underlying: Backend;\n  private debugFields?: string[];\n\n  constructor(config: AnalyticsConfig, underlying: Backend) {\n    this.underlying = underlying;\n    if (config.debug && (config.debug as AnalyticsDebugConfig).fields) {\n      this.debugFields = (config.debug as AnalyticsDebugConfig).fields;\n    }\n  }\n\n  public sendRequest(sample: Sample) {\n    this.printFields(sample);\n    this.underlying.sendRequest(sample);\n  }\n\n  public sendUnloadRequest(sample: Sample) {\n    this.printFields(sample);\n    this.underlying.sendUnloadRequest(sample);\n  }\n\n  public sendRequestSynchronous(sample: Sample) {\n    this.printFields(sample);\n    this.underlying.sendRequestSynchronous(sample);\n  }\n\n  public sendAdRequest(sample: AdSample & AdBreakSample & AdAnalyticsSample) {\n    this.underlying.sendAdRequest(sample);\n  }\n\n  private printFields(sample: Sample) {\n    if (this.debugFields && this.debugFields.length) {\n      const fields = {};\n      this.debugFields.forEach((f) => (fields[f] = sample[f]));\n      logger.logTable([fields]);\n    }\n  }\n}\n","import {DeferredLicenseLoadingAdapterAPI} from '../adapters/internal/DeferredLicenseLoadingAdapterAPI';\nimport {AdAnalyticsSample} from '../types/AdAnalyticsSample';\nimport {AdBreakSample} from '../types/AdBreakSample';\nimport {AdSample} from '../types/AdSample';\nimport {AuthenticationCallback} from '../types/AuthenticationCallback';\nimport {LicenseCallFunc, LicensingRequest, LicensingResponse, LicensingResult} from '../types/LicensingRequest';\nimport {Sample} from '../types/Sample';\nimport {logger} from '../utils/Logger';\nimport {ANALYTICS_LICENSECALL_TIMEOUT} from '../utils/Settings';\nimport {Backend} from './Backend';\nimport {NoOpBackend} from './NoOpBackend';\nimport {QueueBackend} from './QueueBackend';\nimport {RemoteBackend} from './RemoteBackend';\n\nexport class LicenseCheckingBackend implements Backend {\n  public promise?: Promise<LicensingResponse>;\n  private licenseLazyLoadingTimeoutHandle?: number;\n  private backend: Backend;\n  private info: LicensingRequest;\n\n  constructor(\n    info: LicensingRequest,\n    private licenseCall: LicenseCallFunc,\n    private backendBaseUrl: string,\n    private adapter: DeferredLicenseLoadingAdapterAPI,\n    private authenticationCallback: AuthenticationCallback\n  ) {\n    this.info = {...info};\n    this.backend = new QueueBackend();\n    this.licenseCall = licenseCall;\n\n    if (info.key !== undefined && info.key !== '') {\n      this.promise = this.wrapLicenseCheckPromiseWithCallback(this.performLicenseCheck(), this.authenticationCallback);\n    } else if (adapter.supportsDeferredLicenseLoading === true) {\n      adapter.onLicenseKeyReceived.subscribe(this.licenseKeyReceived);\n      adapter.onLicenseCallFailed.subscribe(this.licenseCallFailed);\n      this.licenseLazyLoadingTimeoutHandle = window.setTimeout(\n        this.licenseLazyLoadingTimeout,\n        ANALYTICS_LICENSECALL_TIMEOUT\n      );\n    } else {\n      authenticationCallback.authenticationCompleted(false, undefined);\n      this.backend = new NoOpBackend();\n    }\n  }\n\n  public performLicenseCheck(): Promise<LicensingResponse> {\n    const {key, domain, version} = this.info;\n    if (!key || key === '') {\n      const error: LicensingResponse = {\n        status: LicensingResult.Denied,\n        message: 'No license key provided',\n      };\n      this.backend = new NoOpBackend();\n      return Promise.resolve(error);\n    }\n\n    return this.licenseCall(key, domain, version, this.backendBaseUrl)\n      .then((result) => {\n        if (result.status === LicensingResult.Granted) {\n          const remoteBackend = new RemoteBackend(true, this.backendBaseUrl, key);\n          (this.backend as QueueBackend).flushTo(remoteBackend);\n          this.backend = remoteBackend;\n        } else {\n          throw new Error(result.message);\n        }\n        return result;\n      })\n      .catch((err: Error) => {\n        if (err.message === 'Ignoring Impression due to DNT Header being set') {\n          logger.error('License Check for Bitmovin Analytics failed because of', err);\n        } else {\n          logger.errorMessageToUser('License Check for Bitmovin Analytics failed because of', err);\n        }\n        this.backend = new NoOpBackend();\n        return {\n          status: LicensingResult.Denied,\n          message: err.message,\n        };\n      });\n  }\n\n  public sendRequest(sample: Sample) {\n    this.backend.sendRequest(sample);\n  }\n  public sendUnloadRequest(sample: Sample) {\n    this.backend.sendUnloadRequest(sample);\n  }\n  public sendRequestSynchronous(sample: Sample) {\n    this.backend.sendRequestSynchronous(sample);\n  }\n  public sendAdRequest(sample: AdSample & AdBreakSample & AdAnalyticsSample) {\n    this.backend.sendAdRequest(sample);\n  }\n\n  private licenseKeyReceived = (eventArgs: {licenseKey: string}) => {\n    clearTimeout(this.licenseLazyLoadingTimeoutHandle);\n    this.unsubscribeFromAdapter();\n    this.info.key = eventArgs.licenseKey;\n    this.promise = this.wrapLicenseCheckPromiseWithCallback(this.performLicenseCheck(), this.authenticationCallback);\n  };\n\n  private licenseCallFailed = () => {\n    clearTimeout(this.licenseLazyLoadingTimeoutHandle);\n    this.unsubscribeFromAdapter();\n    this.backend = new NoOpBackend();\n    this.authenticationCallback.authenticationCompleted(false, undefined);\n  };\n\n  private licenseLazyLoadingTimeout = () => {\n    this.unsubscribeFromAdapter();\n    this.backend = new NoOpBackend();\n    this.authenticationCallback.authenticationCompleted(false, undefined);\n  };\n\n  private unsubscribeFromAdapter() {\n    this.adapter.onLicenseKeyReceived.unsubscribe(this.licenseKeyReceived);\n    this.adapter.onLicenseCallFailed.unsubscribe(this.licenseCallFailed);\n  }\n\n  private wrapLicenseCheckPromiseWithCallback(\n    promise: Promise<LicensingResponse>,\n    authenticationCallback: AuthenticationCallback\n  ): Promise<LicensingResponse> {\n    return promise.then((response) => {\n      authenticationCallback.authenticationCompleted(response.status === LicensingResult.Granted, response.features);\n      return response;\n    });\n  }\n}\n","import {FeatureConfigContainer} from './FeatureConfigContainer';\n\nexport interface LicensingRequest {\n  key?: string;\n  domain: string;\n  version: string;\n}\n\nexport enum LicensingResult {\n  Granted = 'granted',\n  Denied = 'denied',\n  Skip = 'skip',\n}\n\nexport interface LicensingResponse {\n  status: LicensingResult;\n  message: string;\n  features?: FeatureConfigContainer;\n}\n\nexport type LicenseCallFunc = (\n  key: string,\n  domain: string,\n  version: string,\n  baseUrl: string\n) => Promise<LicensingResponse>;\n","import {AdAnalyticsSample} from '../types/AdAnalyticsSample';\nimport {AdBreakSample} from '../types/AdBreakSample';\nimport {AdSample} from '../types/AdSample';\nimport {Sample} from '../types/Sample';\nimport {Backend} from './Backend';\n\nexport class QueueBackend implements Backend {\n  public queue: Sample[] = [];\n  public unloadQueue: Sample[] = [];\n  public syncQueue: Sample[] = [];\n  public adQueue: Array<AdSample & AdBreakSample & AdAnalyticsSample> = [];\n\n  public sendRequest(sample: Sample) {\n    this.queue.push(sample);\n  }\n  public sendUnloadRequest(sample: Sample) {\n    this.unloadQueue.push(sample);\n  }\n  public sendRequestSynchronous(sample: Sample) {\n    this.syncQueue.push(sample);\n  }\n  public sendAdRequest(sample: AdSample & AdBreakSample & AdAnalyticsSample) {\n    this.adQueue.push(sample);\n  }\n\n  public flushTo(backend: Backend) {\n    this.queue.forEach((e) => {\n      backend.sendRequest(e);\n    });\n    this.unloadQueue.forEach((e) => {\n      backend.sendUnloadRequest(e);\n    });\n    this.syncQueue.forEach((e) => {\n      backend.sendRequestSynchronous(e);\n    });\n    this.adQueue.forEach((e) => {\n      backend.sendAdRequest(e);\n    });\n  }\n}\n","import {AdAnalyticsSample} from '../types/AdAnalyticsSample';\nimport {AdBreakSample} from '../types/AdBreakSample';\nimport {AdSample} from '../types/AdSample';\nimport {Sample} from '../types/Sample';\nimport {AnalyticsCall} from '../utils/AnalyticsCall';\nimport {noOp} from '../utils/Utils';\nimport {Backend} from './Backend';\n\nexport class RemoteBackend implements Backend {\n  public analyticsCall: AnalyticsCall;\n  public hasAdModule: boolean;\n\n  constructor(hasAdModule: boolean, backendBaseUrl: string, private licenseKey: string) {\n    this.hasAdModule = hasAdModule;\n    this.analyticsCall = new AnalyticsCall(backendBaseUrl);\n  }\n\n  public sendRequest(sample: Sample) {\n    sample.key = this.licenseKey;\n    this.analyticsCall.sendRequest(sample, noOp);\n  }\n\n  public sendUnloadRequest(sample: Sample) {\n    sample.key = this.licenseKey;\n    this.analyticsCall.sendUnloadRequest(sample);\n  }\n\n  public sendRequestSynchronous(sample: Sample) {\n    sample.key = this.licenseKey;\n    this.analyticsCall.sendRequestSynchronous(sample, noOp);\n  }\n\n  public sendAdRequest(sample: AdSample & AdBreakSample & AdAnalyticsSample) {\n    sample.key = this.licenseKey;\n    if (!this.hasAdModule) {\n      return;\n    }\n    this.analyticsCall.sendAdRequest(sample);\n  }\n}\n","import {AdSample} from '../types/AdSample';\nimport {Sample} from '../types/Sample';\nimport {noOp} from '../utils/Utils';\nimport {post} from './Http';\nimport {joinUrls} from './Utils';\n\nexport class AnalyticsCall {\n  private analyticsServerUrl: string;\n  private adAnalyticsServerUrl: string;\n\n  constructor(baseUrl: string) {\n    this.analyticsServerUrl = joinUrls(baseUrl, 'analytics');\n    this.adAnalyticsServerUrl = joinUrls(baseUrl, 'analytics/a');\n  }\n\n  public sendRequest(sample: Sample, callback: () => void) {\n    post(this.analyticsServerUrl, sample, callback);\n  }\n\n  public sendUnloadRequest(sample: Sample) {\n    this.trySendBeacon((data: Sample) => this.sendRequestSynchronous(data, noOp), this.getAnalyticsServerUrl(), sample);\n  }\n\n  public trySendBeacon(fallbackFunction: (data: any) => void, url: string, data: any) {\n    if (typeof navigator.sendBeacon === 'undefined') {\n      fallbackFunction(data);\n    } else {\n      const success = navigator.sendBeacon(url, JSON.stringify(data));\n      if (!success) {\n        fallbackFunction(data);\n      }\n    }\n  }\n\n  public sendRequestSynchronous(sample: Sample, callback: () => void) {\n    post(this.analyticsServerUrl, sample, callback, false);\n  }\n\n  public sendAdRequest(sample: AdSample) {\n    this.trySendBeacon(\n      (data: AdSample) => post(this.getAdAnalyticsServerUrl(), data, noOp),\n      this.getAdAnalyticsServerUrl(),\n      sample\n    );\n  }\n\n  public getAnalyticsServerUrl() {\n    return this.analyticsServerUrl;\n  }\n\n  public getAdAnalyticsServerUrl() {\n    return this.adAnalyticsServerUrl;\n  }\n}\n","import {Sample} from '../types/Sample';\nimport {Backend} from './Backend';\n\nexport class LongPlaytimeFilteringBackend implements Backend {\n  private backend: Backend;\n\n  constructor(next: Backend) {\n    this.backend = next;\n  }\n\n  public sendRequest(sample: Sample) {\n    if (this.isPlayedAboveThreshold(sample)) {\n      return;\n    }\n    this.backend.sendRequest(sample);\n  }\n\n  public sendUnloadRequest(sample: Sample) {\n    if (this.isPlayedAboveThreshold(sample)) {\n      return;\n    }\n    this.backend.sendUnloadRequest(sample);\n  }\n\n  public sendRequestSynchronous(sample: Sample) {\n    if (this.isPlayedAboveThreshold(sample)) {\n      return;\n    }\n    this.backend.sendRequestSynchronous(sample);\n  }\n\n  public sendAdRequest(sample: any) {\n    this.backend.sendAdRequest(sample);\n  }\n\n  private isPlayedAboveThreshold(sample: Sample): boolean {\n    return (sample.played == null ? 0 : sample.played) >= 90000;\n  }\n}\n","import {AdAnalyticsSample} from '../types/AdAnalyticsSample';\nimport {AdBreakSample} from '../types/AdBreakSample';\nimport {AdSample} from '../types/AdSample';\nimport {Sample} from '../types/Sample';\nimport {Backend} from './Backend';\n\nexport class SequenceNumberBackend implements Backend {\n  private underlying: Backend;\n  private sequenceNumber: number = 0;\n\n  constructor(underlying: Backend) {\n    this.underlying = underlying;\n  }\n\n  public sendRequest(sample: Sample) {\n    this.updateSampleBeforeSending(sample);\n    this.underlying.sendRequest(sample);\n  }\n\n  public sendUnloadRequest(sample: Sample) {\n    this.updateSampleBeforeSending(sample);\n    this.underlying.sendUnloadRequest(sample);\n  }\n\n  public sendRequestSynchronous(sample: Sample) {\n    this.updateSampleBeforeSending(sample);\n    this.underlying.sendRequestSynchronous(sample);\n  }\n\n  public sendAdRequest(sample: AdSample & AdBreakSample & AdAnalyticsSample) {\n    this.underlying.sendAdRequest(sample);\n  }\n\n  private updateSampleBeforeSending(sample: Sample) {\n    sample.sequenceNumber = this.sequenceNumber++;\n  }\n}\n","import {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport * as Utils from '../utils/Utils';\n\nexport const BITMOVIN_ANALYTICS_UUID_COOKIE_NAME = 'bitmovin_analytics_uuid';\n\nexport class SessionPersistenceHandler {\n  public readonly userId: string;\n\n  private readonly cookiesEnabled: boolean;\n  private readonly cookiesDomain: string | null;\n\n  constructor(config: AnalyticsConfig) {\n    const collectorConfig = config.config;\n    this.cookiesEnabled = collectorConfig == null || collectorConfig.cookiesEnabled !== false;\n    if (collectorConfig != null && collectorConfig.cookiesDomain != null) {\n      this.cookiesDomain = collectorConfig.cookiesDomain;\n    } else {\n      this.cookiesDomain = null;\n    }\n\n    if (!this.cookiesEnabled) {\n      this.ensureNoCookiePresent();\n    }\n\n    this.userId = this.setupUserId();\n  }\n\n  private setupUserId() {\n    let userId = Utils.getCookie(BITMOVIN_ANALYTICS_UUID_COOKIE_NAME);\n    if (Utils.isNullOrEmptyString(userId)) {\n      userId = this.createAndSetNewUserId();\n    }\n    return userId;\n  }\n\n  private createAndSetNewUserId() {\n    const generatedId = Utils.generateUUID();\n    this.writeCookie(generatedId);\n    return generatedId;\n  }\n\n  private ensureNoCookiePresent() {\n    const userId = Utils.getCookie(BITMOVIN_ANALYTICS_UUID_COOKIE_NAME);\n    if (Utils.isNullOrEmptyString(userId)) {\n      return;\n    }\n    const cookie = `${BITMOVIN_ANALYTICS_UUID_COOKIE_NAME}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;\n    document.cookie = cookie;\n  }\n\n  private writeCookie(userId: string) {\n    if (!this.cookiesEnabled) {\n      return;\n    }\n    let cookie = `${BITMOVIN_ANALYTICS_UUID_COOKIE_NAME}=${userId}; path=/; expires=\"Mon, 31 Dec 2029 23:00:00 GMT\"; max-age=315400000`;\n\n    if (this.cookiesDomain != null) {\n      cookie += `; domain=${this.cookiesDomain}`;\n    }\n\n    document.cookie = cookie;\n  }\n}\n","import {Bitmovin7AnalyticsStateMachine} from '../../analyticsStateMachines/Bitmovin7AnalyticsStateMachine';\nimport {Analytics} from '../../core/Analytics';\nimport {CastTech} from '../../enums/CastTech';\nimport {Event} from '../../enums/Event';\nimport {Player} from '../../enums/Player';\nimport {PlayerSize} from '../../enums/PlayerSize';\nimport {ErrorDetailBackend} from '../../features/errordetails/ErrorDetailBackend';\nimport {ErrorDetailTracking} from '../../features/errordetails/ErrorDetailTracking';\nimport {Feature} from '../../features/Feature';\nimport {FeatureConfig} from '../../features/FeatureConfig';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {DrmPerformanceInfo} from '../../types/DrmPerformanceInfo';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {PlaybackInfo} from '../../types/PlaybackInfo';\nimport {getSourceInfoFromBitmovinSourceConfig} from '../../utils/BitmovinProgressiveSourceHelper';\nimport {InternalAdapter} from './InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nexport class Bitmovin7InternalAdapter extends InternalAdapter implements InternalAdapterAPI {\n  private onBeforeUnLoadEvent: boolean = false;\n\n  constructor(private player: any, opts?: AnalyticsStateMachineOptions) {\n    super(opts);\n    this.stateMachine = new Bitmovin7AnalyticsStateMachine(this.stateMachineCallbacks, this.opts);\n  }\n\n  public initialize(analytics: Analytics): Array<Feature<FeatureConfigContainer, FeatureConfig>> {\n    this.register();\n    const errorDetailTracking = new ErrorDetailTracking(\n      analytics.errorDetailTrackingSettingsProvider,\n      new ErrorDetailBackend(analytics.errorDetailTrackingSettingsProvider.collectorConfig),\n      [analytics.errorDetailSubscribable],\n      undefined\n    );\n    return [errorDetailTracking];\n  }\n\n  public getPlayerVersion = () => this.player.version;\n  public getPlayerName = () => Player.BITMOVIN;\n  public getPlayerTech = () => this.player.getPlayerType();\n  public getAutoPlay(): boolean {\n    if (this.player.getConfig().playback) {\n      return this.player.getConfig().playback.autoplay || false;\n    }\n    return false;\n  }\n  public getDrmPerformanceInfo = (): DrmPerformanceInfo | undefined => this.drmPerformanceInfo;\n\n  public getCurrentPlaybackInfo(): PlaybackInfo {\n    const info: PlaybackInfo = {\n      ...super.getCommonPlaybackInfo(),\n      size: this.player.isFullscreen() ? PlayerSize.Fullscreen : PlayerSize.Window,\n      playerTech: this.getPlayerTech(),\n      isLive: this.player.isLive(),\n      videoDuration: this.player.getDuration(),\n      streamFormat: this.player.getStreamType(),\n      videoWindowWidth: this.player.getFigure().offsetWidth,\n      videoWindowHeight: this.player.getFigure().offsetHeight,\n      isMuted: this.player.isMuted(),\n      isCasting: this.player.isCasting(),\n      audioLanguage: this.player.getAudio() != null ? this.player.getAudio().lang : null,\n      subtitleEnabled: false,\n      droppedFrames: this.player.isReady() ? this.player.getDroppedFrames() : 0,\n    };\n\n    this.applySubtitleProperties(info);\n    this.applyPlaybackQualityProperties(info);\n    this.applySourceProperties(info);\n    this.applyCastingProperties(info);\n\n    return info;\n  }\n\n  public register() {\n    this.player.addEventHandler(this.player.EVENT.ON_SOURCE_UNLOADED, (event: any) => {\n      this.eventCallback(Event.SOURCE_UNLOADED, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_SOURCE_LOADED, (event: any) => {\n      this.resetSourceRelatedState();\n      this.eventCallback(Event.SOURCE_LOADED, {});\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_READY, () => {\n      this.eventCallback(Event.READY, {});\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_CAST_STARTED, (event: any) => {\n      this.eventCallback(Event.START_CAST, event);\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_CAST_STOPPED, () => {\n      this.eventCallback(Event.END_CAST, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_PLAY, () => {\n      this.eventCallback(Event.PLAY, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_PAUSED, () => {\n      this.eventCallback(Event.PAUSE, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_TIME_CHANGED, () => {\n      this.eventCallback(Event.TIMECHANGED, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_SEEK, () => {\n      this.eventCallback(Event.SEEK, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_SEEKED, () => {\n      this.eventCallback(Event.SEEKED, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_STALL_STARTED, () => {\n      this.eventCallback(Event.START_BUFFERING, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_STALL_ENDED, () => {\n      this.eventCallback(Event.END_BUFFERING, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_AUDIO_PLAYBACK_QUALITY_CHANGED, () => {\n      const quality = this.player.getPlaybackAudioData();\n\n      if (this.shouldAllowAudioQualityChange(quality.bitrate)) {\n        this.setPreviousAudioBitrate(quality.bitrate);\n        this.eventCallback(Event.AUDIO_CHANGE, {\n          bitrate: quality.bitrate,\n          currentTime: this.player.getCurrentTime(),\n        });\n      }\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_VIDEO_PLAYBACK_QUALITY_CHANGED, () => {\n      const quality = this.player.getPlaybackVideoData();\n      if (this.shouldAllowVideoQualityChange(quality.bitrate)) {\n        this.setPreviousVideoBitrate(quality.bitrate);\n        this.eventCallback(Event.VIDEO_CHANGE, {\n          width: quality.width,\n          height: quality.height,\n          bitrate: quality.bitrate,\n          currentTime: this.player.getCurrentTime(),\n        });\n      }\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_FULLSCREEN_ENTER, () => {\n      this.eventCallback(Event.START_FULLSCREEN, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_FULLSCREEN_EXIT, () => {\n      this.eventCallback(Event.END_FULLSCREEN, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_AD_STARTED, () => {\n      this.eventCallback(Event.START_AD, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_AD_FINISHED, () => {\n      this.eventCallback(Event.END_AD, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_MUTED, () => {\n      this.eventCallback(Event.MUTE, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_UNMUTED, () => {\n      this.eventCallback(Event.UN_MUTE, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_ERROR, (event: any) => {\n      this.eventCallback(Event.ERROR, {\n        code: event.code,\n        message: event.message,\n        currentTime: this.player.getCurrentTime(),\n        data: {},\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_PLAYBACK_FINISHED, () => {\n      this.eventCallback(Event.PLAYBACK_FINISHED, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_DOWNLOAD_FINISHED, (event: any) => {\n      if (event.downloadType.indexOf('drm/license/') === 0) {\n        this.drmPerformanceInfo = {\n          drmType: event.downloadType.replace('drm/license/', ''),\n          drmLoadTime: event.downloadTime * 1000,\n        };\n      }\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_AUDIO_CHANGED, (event: any) => {\n      this.eventCallback(Event.AUDIOTRACK_CHANGED, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    this.player.addEventHandler(this.player.EVENT.ON_SUBTITLE_CHANGED, (event: any) => {\n      this.eventCallback(Event.SUBTITLE_CHANGE, {\n        currentTime: this.player.getCurrentTime(),\n      });\n    });\n\n    const handlePageClose = () => {\n      if (!this.onBeforeUnLoadEvent) {\n        this.onBeforeUnLoadEvent = true;\n        let currentTime: number | undefined;\n        if (this.player != null) {\n          currentTime = this.player.getCurrentTime();\n        }\n        this.eventCallback(Event.UNLOAD, {\n          currentTime,\n        });\n      }\n    };\n\n    window.addEventListener('beforeunload', handlePageClose);\n    window.addEventListener('unload', handlePageClose);\n  }\n\n  public sourceChange(config: any, timestamp: number) {\n    this.stateMachine.sourceChange(config, timestamp, this.player.getCurrentTime());\n  }\n  protected get currentTime(): number {\n    return this.player.getCurrentTime();\n  }\n\n  private applySourceProperties(info: PlaybackInfo) {\n    const source = this.player.getConfig().source;\n    if (source == null) {\n      return;\n    }\n    info.videoTitle = source.title;\n    info.mpdUrl = source.dash;\n    info.m3u8Url = source.hls;\n\n    const progSourceInfo = getSourceInfoFromBitmovinSourceConfig(source.progressive, this.player);\n    info.progUrl = progSourceInfo.progUrl;\n    if (this.player.getStreamType() === 'progressive') {\n      info.videoBitrate = progSourceInfo.progBitrate;\n    }\n  }\n\n  private applySubtitleProperties(info: PlaybackInfo) {\n    const subtitle = this.player.getSubtitle() || {};\n\n    info.subtitleEnabled = subtitle.id != null;\n    info.subtitleLanguage = subtitle.lang;\n  }\n\n  private applyPlaybackQualityProperties(info: PlaybackInfo) {\n    const videoQuality = this.player.getPlaybackVideoData();\n    if (videoQuality !== null) {\n      info.videoBitrate = videoQuality.bitrate;\n      info.videoPlaybackHeight = videoQuality.height;\n      info.videoPlaybackWidth = videoQuality.width;\n    }\n\n    const audioQuality = this.player.getPlaybackAudioData();\n    if (audioQuality !== null) {\n      info.audioBitrate = audioQuality.bitrate;\n    }\n  }\n\n  private applyCastingProperties(info: PlaybackInfo) {\n    const isCasting = this.player.isCasting() || this.player.isAirplayActive() || false;\n    info.isCasting = isCasting;\n    if (!isCasting) {\n      return;\n    }\n\n    // AirPlay\n    if (this.player.isAirplayActive()) {\n      info.castTech = CastTech.AirPlay;\n      return;\n    }\n\n    // Casting Tech from RemoteControlConfig\n    const remoteControlConfig = this.player.getConfig().remotecontrol;\n    if (remoteControlConfig === null || remoteControlConfig === undefined) {\n      return;\n    }\n\n    switch (remoteControlConfig.type) {\n      case 'googlecast':\n        info.castTech = CastTech.GoogleCast;\n        break;\n      case 'websocket':\n        info.castTech = CastTech.WebSocket;\n        break;\n    }\n  }\n}\n","import * as StateMachine from 'javascript-state-machine';\nimport {Event, EventMap} from '../enums/Event';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {NoExtraProperties} from '../types/NoExtraProperties';\nimport {StateMachineCallbacks} from '../types/StateMachineCallbacks';\nimport {EventDebugging} from '../utils/EventDebugging';\nimport {logger, padRight} from '../utils/Logger';\nimport {AnalyticsStateMachine} from './AnalyticsStateMachine';\n\nenum State {\n  SETUP = 'SETUP',\n  STARTUP = 'STARTUP',\n  READY = 'READY',\n  PLAYING = 'PLAYING',\n  REBUFFERING = 'REBUFFERING',\n  PAUSE = 'PAUSE',\n  QUALITYCHANGE = 'QUALITYCHANGE',\n  PAUSED_SEEKING = 'PAUSED_SEEKING',\n  PLAY_SEEKING = 'PLAY_SEEKING',\n  END_PLAY_SEEKING = 'END_PLAY_SEEKING',\n  QUALITYCHANGE_PAUSE = 'QUALITYCHANGE_PAUSE',\n  QUALITYCHANGE_REBUFFERING = 'QUALITYCHANGE_REBUFFERING',\n  END = 'END',\n  ERROR = 'ERROR',\n  AD = 'AD',\n  MUTING_READY = 'MUTING_READY',\n  MUTING_PLAY = 'MUTING_PLAY',\n  MUTING_PAUSE = 'MUTING_PAUSE',\n  CASTING = 'CASTING',\n  SOURCE_CHANGING = 'SOURCE_CHANGING',\n  SUBTITLE_CHANGING = 'SUBTITLE_CHANGING',\n  AUDIOTRACK_CHANGING = 'AUDIOTRACK_CHANGING',\n  CUSTOMDATACHANGE = 'CUSTOMDATACHANGE',\n}\n\nexport class Bitmovin7AnalyticsStateMachine extends AnalyticsStateMachine {\n  public static PAUSE_SEEK_DELAY = 200;\n  public static SEEKED_PAUSE_DELAY = 300;\n\n  private debuggingStates: EventDebugging[] = [];\n  private enabledDebugging = false;\n\n  private pausedTimestamp: any;\n  private seekTimestamp: number;\n  private seekedTimestamp: number;\n  private seekedTimeout: number;\n\n  private seekStarted: boolean;\n  private seekEnded: boolean;\n\n  constructor(stateMachineCallbacks: StateMachineCallbacks, opts: AnalyticsStateMachineOptions) {\n    super(stateMachineCallbacks, opts);\n    this.pausedTimestamp = null;\n    this.seekTimestamp = 0;\n    this.seekedTimestamp = 0;\n    this.seekedTimeout = 0;\n    this.seekStarted = false;\n    this.seekEnded = false;\n  }\n\n  public getAllStates() {\n    return [\n      ...Object.keys(State).map((key) => State[key]),\n      'FINISH_PLAY_SEEKING',\n      'PLAY_SEEK',\n      'FINISH_QUALITYCHANGE_PAUSE',\n      'FINISH_QUALITYCHANGE',\n      'FINISH_QUALITYCHANGE_REBUFFERING',\n    ];\n  }\n\n  public sourceChange = (config: any, timestamp: number, currentTime?: number) => {\n    this.callEvent(Event.MANUAL_SOURCE_CHANGE, {config, currentTime}, timestamp);\n  };\n\n  public createStateMachine(opts: AnalyticsStateMachineOptions) {\n    return StateMachine.create({\n      initial: State.SETUP,\n      error: (eventName, from, to, args, errorCode, errorMessage) => {\n        logger.error('Error in statemachine: ' + errorMessage);\n      },\n      events: [\n        {name: Event.READY, from: [State.SETUP, State.ERROR], to: State.READY},\n        {name: Event.PLAY, from: State.READY, to: State.STARTUP},\n\n        {name: Event.START_BUFFERING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.END_BUFFERING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.VIDEO_CHANGE, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.AUDIO_CHANGE, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.TIMECHANGED, from: State.STARTUP, to: State.PLAYING},\n\n        {name: Event.TIMECHANGED, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.END_BUFFERING, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.START_BUFFERING, from: State.PLAYING, to: State.REBUFFERING},\n        {name: Event.END_BUFFERING, from: State.REBUFFERING, to: State.PLAYING},\n        {name: Event.TIMECHANGED, from: State.REBUFFERING, to: State.REBUFFERING},\n\n        {name: Event.PAUSE, from: State.PLAYING, to: State.PAUSE},\n        {name: Event.PAUSE, from: State.REBUFFERING, to: State.PAUSE},\n        {name: Event.PLAY, from: State.PAUSE, to: State.PLAYING},\n\n        {name: Event.VIDEO_CHANGE, from: State.PLAYING, to: State.QUALITYCHANGE},\n        {name: Event.AUDIO_CHANGE, from: State.PLAYING, to: State.QUALITYCHANGE},\n        {name: Event.VIDEO_CHANGE, from: State.QUALITYCHANGE, to: State.QUALITYCHANGE},\n        {name: Event.AUDIO_CHANGE, from: State.QUALITYCHANGE, to: State.QUALITYCHANGE},\n        {name: 'FINISH_QUALITYCHANGE', from: State.QUALITYCHANGE, to: State.PLAYING},\n\n        {name: Event.VIDEO_CHANGE, from: State.PAUSE, to: State.QUALITYCHANGE_PAUSE},\n        {name: Event.AUDIO_CHANGE, from: State.PAUSE, to: State.QUALITYCHANGE_PAUSE},\n        {\n          name: Event.VIDEO_CHANGE,\n          from: State.QUALITYCHANGE_PAUSE,\n          to: State.QUALITYCHANGE_PAUSE,\n        },\n        {\n          name: Event.AUDIO_CHANGE,\n          from: State.QUALITYCHANGE_PAUSE,\n          to: State.QUALITYCHANGE_PAUSE,\n        },\n        {name: 'FINISH_QUALITYCHANGE_PAUSE', from: State.QUALITYCHANGE_PAUSE, to: State.PAUSE},\n\n        {name: Event.SEEK, from: State.PAUSE, to: State.PAUSED_SEEKING},\n        {name: Event.SEEK, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.AUDIO_CHANGE, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.VIDEO_CHANGE, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.START_BUFFERING, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.END_BUFFERING, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.SEEKED, from: State.PAUSED_SEEKING, to: State.PAUSE},\n        {name: Event.PLAY, from: State.PAUSED_SEEKING, to: State.PLAYING},\n        {name: Event.PAUSE, from: State.PAUSED_SEEKING, to: State.PAUSE},\n\n        {name: 'PLAY_SEEK', from: State.PAUSE, to: State.PLAY_SEEKING},\n        {name: 'PLAY_SEEK', from: State.PAUSED_SEEKING, to: State.PLAY_SEEKING},\n        {name: 'PLAY_SEEK', from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.SEEK, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.AUDIO_CHANGE, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.VIDEO_CHANGE, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.START_BUFFERING, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.END_BUFFERING, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.SEEKED, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n\n        // We are ending the seek\n        {name: Event.PLAY, from: State.PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n\n        {name: Event.START_BUFFERING, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.END_BUFFERING, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.SEEKED, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.TIMECHANGED, from: State.END_PLAY_SEEKING, to: State.PLAYING},\n\n        {name: Event.END, from: State.PLAY_SEEKING, to: State.END},\n        {name: Event.END, from: State.PAUSED_SEEKING, to: State.END},\n        {name: Event.END, from: State.PLAYING, to: State.END},\n        {name: Event.END, from: State.PAUSE, to: State.END},\n        {name: Event.SEEK, from: State.END, to: State.END},\n        {name: Event.SEEKED, from: State.END, to: State.END},\n        {name: Event.TIMECHANGED, from: State.END, to: State.END},\n        {name: Event.END_BUFFERING, from: State.END, to: State.END},\n        {name: Event.START_BUFFERING, from: State.END, to: State.END},\n        {name: Event.END, from: State.END, to: State.END},\n\n        {name: Event.PLAY, from: State.END, to: State.STARTUP},\n\n        {name: Event.ERROR, from: this.getAllStates(), to: State.ERROR},\n\n        {name: Event.SEEK, from: State.END_PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: 'FINISH_PLAY_SEEKING', from: State.END_PLAY_SEEKING, to: State.PLAYING},\n\n        {name: Event.UNLOAD, from: this.getAllStates(), to: State.END},\n\n        {name: Event.START_AD, from: State.PLAYING, to: State.AD},\n        {name: Event.END_AD, from: State.AD, to: State.PLAYING},\n\n        {name: Event.MUTE, from: State.READY, to: State.MUTING_READY},\n        {name: Event.UN_MUTE, from: State.READY, to: State.MUTING_READY},\n        {name: 'FINISH_MUTING', from: State.MUTING_READY, to: State.READY},\n\n        {name: Event.MUTE, from: State.PLAYING, to: State.MUTING_PLAY},\n        {name: Event.UN_MUTE, from: State.PLAYING, to: State.MUTING_PLAY},\n        {name: 'FINISH_MUTING', from: State.MUTING_PLAY, to: State.PLAYING},\n\n        {name: Event.MUTE, from: State.PAUSE, to: State.MUTING_PAUSE},\n        {name: Event.UN_MUTE, from: State.PAUSE, to: State.MUTING_PAUSE},\n        {name: 'FINISH_MUTING', from: State.MUTING_PAUSE, to: State.PAUSE},\n\n        {name: Event.START_CAST, from: [State.READY, State.PAUSE, State.PLAYING], to: State.CASTING},\n        {name: Event.PAUSE, from: State.CASTING, to: State.CASTING},\n        {name: Event.PLAY, from: State.CASTING, to: State.CASTING},\n        {name: Event.PLAYING, from: State.CASTING, to: State.CASTING},\n        {name: Event.TIMECHANGED, from: State.CASTING, to: State.CASTING},\n        {name: Event.MUTE, from: State.CASTING, to: State.CASTING},\n        {name: Event.UN_MUTE, from: State.CASTING, to: State.CASTING},\n        {name: Event.SEEK, from: State.CASTING, to: State.CASTING},\n        {name: Event.SEEKED, from: State.CASTING, to: State.CASTING},\n        {name: Event.END_CAST, from: State.CASTING, to: State.READY},\n\n        {name: Event.SEEK, from: State.READY, to: State.READY},\n        {name: Event.SEEKED, from: State.READY, to: State.READY},\n        {name: Event.SEEKED, from: State.STARTUP, to: State.STARTUP},\n\n        {name: Event.MANUAL_SOURCE_CHANGE, from: this.getAllStates(), to: State.SOURCE_CHANGING},\n        {name: Event.SOURCE_UNLOADED, from: this.getAllStates(), to: State.SOURCE_CHANGING},\n\n        {name: Event.READY, from: State.SOURCE_CHANGING, to: State.READY},\n\n        // {name: Events.SOURCE_LOADED, from: State.SETUP, to: State.SETUP},\n        // {name: Events.SOURCE_LOADED, from: State.READY, to: State.READY},\n\n        {name: Event.VIDEO_CHANGE, from: State.REBUFFERING, to: State.QUALITYCHANGE_REBUFFERING},\n        {name: Event.AUDIO_CHANGE, from: State.REBUFFERING, to: State.QUALITYCHANGE_REBUFFERING},\n        {\n          name: Event.VIDEO_CHANGE,\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.QUALITYCHANGE_REBUFFERING,\n        },\n        {\n          name: Event.AUDIO_CHANGE,\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.QUALITYCHANGE_REBUFFERING,\n        },\n        {\n          name: 'FINISH_QUALITYCHANGE_REBUFFERING',\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.REBUFFERING,\n        },\n        {name: Event.AUDIOTRACK_CHANGED, from: State.PLAYING, to: State.AUDIOTRACK_CHANGING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.AUDIOTRACK_CHANGING, to: State.AUDIOTRACK_CHANGING},\n        {name: Event.TIMECHANGED, from: State.AUDIOTRACK_CHANGING, to: State.PLAYING},\n\n        {name: Event.SUBTITLE_CHANGE, from: State.PLAYING, to: State.SUBTITLE_CHANGING},\n        {name: Event.SUBTITLE_CHANGE, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.SUBTITLE_CHANGE, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.SUBTITLE_CHANGE, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.SUBTITLE_CHANGE, from: State.SUBTITLE_CHANGING, to: State.SUBTITLE_CHANGING},\n        {name: Event.TIMECHANGED, from: State.SUBTITLE_CHANGING, to: State.PLAYING},\n\n        {name: Event.CUSTOM_DATA_CHANGE, from: [State.PLAYING, State.PAUSE], to: State.CUSTOMDATACHANGE},\n        {name: Event.PLAYING, from: State.CUSTOMDATACHANGE, to: State.PLAYING},\n        {name: Event.PAUSE, from: State.CUSTOMDATACHANGE, to: State.PAUSE},\n      ],\n      callbacks: {\n        onpause: (event, from, to, timestamp) => {\n          if (from === State.PLAYING) {\n            this.pausedTimestamp = timestamp;\n          }\n        },\n        onbeforeevent: (event, from, to, timestamp, eventObject) => {\n          if (event === Event.SEEK && from === State.PAUSE) {\n            if (!this.seekStarted) {\n              this.seekTimestamp = timestamp;\n              this.seekStarted = true;\n            }\n            const elapsedTime = timestamp - this.pausedTimestamp;\n            if (elapsedTime < Bitmovin7AnalyticsStateMachine.PAUSE_SEEK_DELAY && elapsedTime > 0) {\n              this.stateMachine.PLAY_SEEK(timestamp);\n              return false;\n            }\n          }\n\n          if (event === Event.SEEK) {\n            window.clearTimeout(this.seekedTimeout);\n          }\n\n          if (event === Event.SEEKED && from === State.PAUSED_SEEKING) {\n            this.seekedTimestamp = timestamp;\n            this.seekEnded = true;\n            this.seekedTimeout = window.setTimeout(() => {\n              this.stateMachine.pause(timestamp, eventObject);\n            }, Bitmovin7AnalyticsStateMachine.SEEKED_PAUSE_DELAY);\n            return false;\n          }\n\n          if (from === State.REBUFFERING && to === State.QUALITYCHANGE_REBUFFERING) {\n            return false;\n          }\n        },\n        onafterevent: (event, from, to, timestamp) => {\n          if (to === State.QUALITYCHANGE_PAUSE) {\n            this.stateMachine.FINISH_QUALITYCHANGE_PAUSE(timestamp);\n          }\n          if (to === State.QUALITYCHANGE) {\n            this.stateMachine.FINISH_QUALITYCHANGE(timestamp);\n          }\n          if (to === State.QUALITYCHANGE_REBUFFERING) {\n            this.stateMachine.FINISH_QUALITYCHANGE_REBUFFERING(timestamp);\n          }\n          if (to === State.MUTING_READY || to === State.MUTING_PLAY || to === State.MUTING_PAUSE) {\n            this.stateMachine.FINISH_MUTING(timestamp);\n          }\n        },\n        onenterstate: (\n          event: string | undefined,\n          from: string | undefined,\n          to: string | undefined,\n          timestamp: number,\n          eventObject: any\n        ) => {\n          if (from === 'none' && opts.starttime) {\n            this.onEnterStateTimestamp = opts.starttime;\n          } else {\n            this.onEnterStateTimestamp = timestamp || new Date().getTime();\n          }\n\n          logger.log('[ENTER] ' + padRight(to, 20) + 'EVENT: ' + padRight(event, 20) + ' from ' + padRight(from, 14));\n          if (\n            eventObject &&\n            to !== State.PAUSED_SEEKING &&\n            to !== State.PLAY_SEEKING &&\n            to !== State.END_PLAY_SEEKING\n          ) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.START_CAST && to === State.CASTING) {\n            this.stateMachineCallbacks.startCasting(timestamp, eventObject);\n          }\n\n          if (to === State.REBUFFERING) {\n            this.startRebufferingHeartbeatInterval();\n          }\n        },\n        onleavestate: (event, from, to, timestamp, eventObject) => {\n          if (from === State.REBUFFERING) {\n            this.resetRebufferingHelpers();\n          }\n\n          if (!timestamp) {\n            return;\n          }\n          this.addStatesToLog(event, from, to, timestamp, eventObject);\n          const stateDuration = timestamp - this.onEnterStateTimestamp;\n\n          if (\n            eventObject &&\n            to !== State.PAUSED_SEEKING &&\n            to !== State.PLAY_SEEKING &&\n            to !== State.END_PLAY_SEEKING\n          ) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n          }\n\n          if (event === 'PLAY_SEEK' && from === State.PAUSE) {\n            return true;\n          }\n\n          const fnName = String(from).toLowerCase();\n          if (from === State.END_PLAY_SEEKING || from === State.PAUSED_SEEKING) {\n            const seekDuration = this.seekedTimestamp - this.seekTimestamp;\n            if (this.seekStarted && this.seekEnded && to !== State.PLAY_SEEKING) {\n              this.seekEnded = this.seekStarted = false;\n              this.stateMachineCallbacks[fnName](seekDuration, fnName, eventObject);\n            }\n          } else if (event === Event.UNLOAD) {\n            this.stateMachineCallbacks.unload(stateDuration, fnName);\n          } else if (from === State.PAUSE && to !== State.PAUSED_SEEKING) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(event);\n            this.stateMachineCallbacks.pause(stateDuration, fnName);\n          } else {\n            const callbackFunction = this.stateMachineCallbacks[fnName];\n            if (typeof callbackFunction === 'function') {\n              callbackFunction(stateDuration, fnName, eventObject);\n            } else {\n              logger.error('Could not find callback function for ' + fnName);\n            }\n          }\n\n          if (\n            eventObject &&\n            to !== State.PAUSED_SEEKING &&\n            to !== State.PLAY_SEEKING &&\n            to !== State.END_PLAY_SEEKING\n          ) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.VIDEO_CHANGE) {\n            this.stateMachineCallbacks.videoChange(eventObject);\n          } else if (event === Event.AUDIO_CHANGE) {\n            this.stateMachineCallbacks.audioChange(eventObject);\n          } else if (event === Event.MUTE) {\n            this.stateMachineCallbacks.mute();\n          } else if (event === Event.UN_MUTE) {\n            this.stateMachineCallbacks.unMute();\n          } else if (event === Event.MANUAL_SOURCE_CHANGE) {\n            this.stateMachineCallbacks.manualSourceChange(eventObject);\n          }\n        },\n        onseek: (event, from, to, timestamp) => {\n          if (!this.seekStarted) {\n            this.seekTimestamp = timestamp;\n            this.seekStarted = true;\n          }\n        },\n        onseeked: (event, from, to, timestamp) => {\n          this.seekedTimestamp = timestamp;\n          this.seekEnded = true;\n        },\n        ontimechanged: (event, from, to, timestamp, eventObject) => {\n          const stateDuration = timestamp - this.onEnterStateTimestamp;\n\n          if (stateDuration > 59700) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n\n            this.stateMachineCallbacks.heartbeat(stateDuration, String(from).toLowerCase(), {played: stateDuration});\n            this.onEnterStateTimestamp = timestamp;\n\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n        },\n        onplayerError: (event, from, to, timestamp, eventObject) => {\n          this.stateMachineCallbacks.error(eventObject);\n        },\n      },\n    });\n  }\n\n  public callEvent<StatemachineEvent extends keyof EventMap, EventData extends EventMap[StatemachineEvent]>(\n    eventType: StatemachineEvent,\n    eventObject: NoExtraProperties<EventMap[StatemachineEvent], EventData>,\n    timestamp: number\n  ): void {\n    const exec = this.stateMachine[eventType];\n\n    if (exec) {\n      try {\n        exec.call(this.stateMachine, timestamp, eventObject);\n      } catch (e) {\n        logger.error('Exception occured in State Machine callback ' + eventType, exec, eventObject, e);\n      }\n    } else {\n      logger.log('Ignored Event: ' + eventType);\n    }\n  }\n\n  public addStatesToLog(\n    event: string | undefined,\n    from: string | undefined,\n    to: string | undefined,\n    timestamp: number,\n    eventObject: any\n  ) {\n    if (this.enabledDebugging) {\n      this.debuggingStates.push(new EventDebugging(event, from, to, timestamp, eventObject));\n    }\n  }\n\n  public getStates() {\n    return this.debuggingStates;\n  }\n\n  public setEnabledDebugging(enabled: boolean) {\n    this.enabledDebugging = enabled;\n  }\n}\n","import {ErrorCode} from './ErrorCode';\n\nexport class VideoStartFailedReason {\n  public static PAGE_CLOSED = new VideoStartFailedReason('PAGE_CLOSED', null);\n  public static PLAYER_ERROR = new VideoStartFailedReason('PLAYER_ERROR', null);\n  public static TIMEOUT = new VideoStartFailedReason('TIMEOUT', ErrorCode.VIDEO_STARTUP_TIMEOUT_REACHED);\n  public static UNKNOWN = new VideoStartFailedReason('UNKNOWN', null);\n\n  private constructor(public readonly reason: string, public readonly errorCode: ErrorCode | null) {}\n}\n","import {FeatureConfig} from './FeatureConfig';\n\nexport abstract class Feature<TConfigContainer, TConfig extends FeatureConfig> {\n  private _config?: TConfig = undefined;\n  private _isEnabled: boolean = true;\n\n  public get config(): TConfig | undefined {\n    return this._config;\n  }\n\n  public get isEnabled(): boolean {\n    return this._isEnabled;\n  }\n\n  public abstract reset(): void;\n  public abstract enabled(): void;\n  public abstract disabled(): void;\n  public abstract configured(authenticated: boolean, config?: TConfig): void;\n\n  public disable() {\n    this._isEnabled = false;\n    this.disabled();\n  }\n\n  public configure(authenticated: boolean, configContainer?: TConfigContainer): TConfig | undefined {\n    if (configContainer != null) {\n      this._config = this.extractConfig(configContainer);\n    }\n    this.configured(authenticated, this._config);\n    return this._config;\n  }\n\n  public abstract extractConfig(configContainer: TConfigContainer): TConfig | undefined;\n}\n","import {AnalyticsConfig} from './AnalyticsConfig';\nimport {CustomDataValues} from './CustomDataValues';\nimport * as EventData from './EventData';\nimport {Sample} from './Sample';\n\nexport interface StateMachineCallbacks {\n  setup: (duration: number, state: string) => void;\n  startup: (duration: number, state: string) => void;\n  playing: (duration: number, state: string) => void;\n  heartbeat: (duration: number, state: string, payload: Pick<Sample, 'played'> | Pick<Sample, 'buffered'>) => void;\n  qualitychange: (duration: number, state: string) => void;\n  qualitychange_pause: (duration: number, state: string) => void;\n  qualitychange_rebuffering: (duration: number, state: string) => void;\n  videoChange: (event: any) => void;\n  audioChange: (event: any) => void;\n  audiotrack_changing: () => void;\n  pause: (duration: number, state: string) => void;\n  paused_seeking: (duration: number, state: string) => void;\n  end_play_seeking: (duration: number, state: string) => void;\n  rebuffering: (duration: number, state: string) => void;\n  error: (event: Readonly<EventData.ErrorEvent>) => void;\n  end: (duration: number, state: string) => void;\n  unload: (duration: number, state: string) => void;\n  ad: (duration: number, state: string) => void;\n  mute: () => void;\n  unMute: () => void;\n  subtitle_changing: () => void;\n  setVideoTimeEndFromEvent: (event: any) => void;\n  setVideoTimeStartFromEvent: (event: any) => void;\n  videoStartFailed: (event: Readonly<EventData.VideoStartFailedEvent>, sendRequest: boolean) => void;\n  source_changing: (duration: number, state: string, event: any) => void;\n  ready: (duration: number, state: string, event: any) => void;\n  startCasting: (duration: number, event: any) => void;\n  casting: (duration: number, event: any) => void;\n  manualSourceChange: (event: {config: AnalyticsConfig}) => void;\n  initialSourceChange: (event: {config: AnalyticsConfig}) => void;\n  muting_ready: (duration: number, state: string, event: any) => void;\n  stop_collecting: () => void;\n  customdatachange: (duration?: number, state?: string, event?: {values: CustomDataValues}) => void;\n  release: () => void;\n  playlistTransition: (event: Readonly<EventData.AnalyticsEventBase>) => void;\n}\n\n// tslint:disable:no-unused-expression\nexport const defaultStateMachineCallbacks: StateMachineCallbacks = {\n  setup: (time: number, state: string) => void {},\n  startup: (time: number, state: string) => void {},\n  playing: (time: number, state: string) => void {},\n  heartbeat: (time: number, state: string, payload: Pick<Sample, 'played'> | Pick<Sample, 'buffered'>) => void {},\n  qualitychange: (time: number, state: string) => void {},\n  qualitychange_pause: (time: number, state: string) => void {},\n  qualitychange_rebuffering: (time: number, state: string) => void {},\n  videoChange: (event: any) => void {},\n  audioChange: (event: any) => void {},\n  audiotrack_changing: () => void {},\n  pause: (time: number, state: string) => void {},\n  paused_seeking: (time: number, state: string) => void {},\n  end_play_seeking: (time: number, state: string) => void {},\n  rebuffering: (time: number, state: string) => void {},\n  error: (event: Readonly<EventData.ErrorEvent>) => void {},\n  end: (time: number, state: string) => void {},\n  unload: (time: number, state: string) => void {},\n  ad: (time: number, state: string) => void {},\n  mute: () => void {},\n  unMute: () => void {},\n  subtitle_changing: () => void {},\n  setVideoTimeEndFromEvent: (event: any) => void {},\n  setVideoTimeStartFromEvent: (event: any) => void {},\n  videoStartFailed: (event: Readonly<EventData.VideoStartFailedEvent>, sendRequest: boolean) => void {},\n  source_changing: (time: number, state: string, event: any) => void {},\n  ready: (time: number, state: string, event: any) => void {},\n  startCasting: (time: number, event: any) => void {},\n  casting: (duration: number, event: any) => void {},\n  manualSourceChange: (event: {config: AnalyticsConfig}) => void {},\n  initialSourceChange: (event: {config: AnalyticsConfig}) => void {},\n  muting_ready: (time: number, state: string, event: any) => void {},\n  stop_collecting: () => void {},\n  customdatachange: (time?: number, state?: string, event?: {values: CustomDataValues}) => void {},\n  release: () => void {},\n  playlistTransition: (event: Readonly<EventData.AnalyticsEventBase>) => void {},\n};\n","import {PlayerAPI, PlayerConfig} from 'bitmovin-player';\nimport {AdapterAPI} from '../api/AdapterAPI';\nimport {Analytics} from '../core/Analytics';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {logger} from '../utils/Logger';\nimport {Adapter} from './Adapter';\nimport {Bitmovin8InternalAdapter} from './internal/Bitmovin8InternalAdapter';\n\nexport class Bitmovin8Adapter extends Adapter implements AdapterAPI {\n  constructor(player: any, opts?: AnalyticsStateMachineOptions) {\n    super();\n\n    if (this.hasPlayerAlreadyBeenAugmented(player)) {\n      logger.errorMessageToUser('Bitmovin Analytics is already hooked up to this player instance');\n      return;\n    }\n    this.markPlayerInstanceAsAugmented(player);\n\n    const playerConfig: PlayerConfig = (player as PlayerAPI).getConfig();\n    let analyticsConfig: AnalyticsConfig = (playerConfig as any).analytics;\n    if (analyticsConfig === undefined) {\n      analyticsConfig = {};\n    }\n\n    analyticsConfig.playerKey = analyticsConfig.playerKey || playerConfig.key;\n\n    this.internalAdapter = new Bitmovin8InternalAdapter(player, opts);\n    this.analytics = new Analytics(analyticsConfig, this.internalAdapter);\n    (player as any).analytics = this.analytics;\n    this.wrapPlayerLoad(player, this.analytics);\n  }\n\n  private wrapPlayerLoad(player: PlayerAPI, analytics: Analytics) {\n    const originalLoad = player.load;\n    // @ts-ignore\n    player.load = (...args: Parameters<typeof player.load>): Promise<void> => {\n      if (args.length > 0) {\n        const analyticsConfig = (args[0] as any).analytics;\n        // we reset the analytics and reload with a new config\n        analytics.sourceChange(analyticsConfig);\n      }\n\n      return originalLoad.apply(player, args);\n    };\n  }\n}\n","import {PlayerAPI, PlayerEventBase, SeekEvent, UserInteractionEvent} from 'bitmovin-player';\nimport {Bitmovin8AnalyticsStateMachine} from '../../analyticsStateMachines/Bitmovin8AnalyticsStateMachine';\nimport {Analytics} from '../../core/Analytics';\nimport {DownloadSpeedMeter} from '../../core/DownloadSpeedMeter';\nimport {SegmentTracker} from '../../core/SegmentTracker';\nimport VideoCompletionTracker from '../../core/VideoCompletionTracker';\nimport {CastTech} from '../../enums/CastTech';\nimport {ErrorCode} from '../../enums/ErrorCode';\nimport {Event} from '../../enums/Event';\nimport {Player} from '../../enums/Player';\nimport {PlayerSize} from '../../enums/PlayerSize';\nimport {ErrorDetailBackend} from '../../features/errordetails/ErrorDetailBackend';\nimport {ErrorDetailTracking} from '../../features/errordetails/ErrorDetailTracking';\nimport {Feature} from '../../features/Feature';\nimport {FeatureConfig} from '../../features/FeatureConfig';\nimport {HttpRequestTracking} from '../../features/httprequesttracking/HttpRequestTracking';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {DownloadSpeedInfo} from '../../types/DownloadSpeedInfo';\nimport {DrmPerformanceInfo} from '../../types/DrmPerformanceInfo';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {PlaybackInfo} from '../../types/PlaybackInfo';\nimport {SegmentInfo} from '../../types/SegmentInfo';\nimport {getSourceInfoFromBitmovinSourceConfig} from '../../utils/BitmovinProgressiveSourceHelper';\nimport {logger} from '../../utils/Logger';\nimport * as AnalyticsSettings from '../../utils/Settings';\nimport {AdModuleAPI} from './ads/AdModuleAPI';\nimport {Bitmovin8AdModule} from './ads/Bitmovin8AdModule';\nimport {Bitmovin8HttpRequestTrackingAdapter} from './Bitmovin8HttpRequestTrackingAdapter';\nimport {Bitmovin8SegmentTrackerAdapter} from './Bitmovin8SegmentTrackerAdapter';\nimport {Bitmovin8SpeedMeterAdapter} from './Bitmovin8SpeedMeterAdapter';\nimport {InternalAdapter} from './InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nenum ViewMode {\n  Inline = 'inline',\n  Fullscreen = 'fullscreen',\n  PictureInPicture = 'pictureinpicture',\n}\n\nexport class Bitmovin8InternalAdapter extends InternalAdapter implements InternalAdapterAPI {\n  get downloadSpeedInfo(): DownloadSpeedInfo {\n    return this.speedMeter.getInfo();\n  }\n\n  get segments(): SegmentInfo[] {\n    return this.segmentTracker.getSegments();\n  }\n\n  get adModule(): AdModuleAPI | undefined {\n    return this._adModule;\n  }\n\n  get supportsDeferredLicenseLoading(): boolean {\n    return true;\n  }\n  public readonly videoCompletionTracker: VideoCompletionTracker;\n\n  private onBeforeUnLoadEvent: boolean = false;\n  private speedMeter: DownloadSpeedMeter;\n  private segmentTracker: SegmentTracker;\n  private _adModule?: AdModuleAPI;\n  private lastTrackedCurrentTime: number | undefined;\n  private httpRequestTrackingAdapter: Bitmovin8HttpRequestTrackingAdapter;\n\n  constructor(private player: PlayerAPI, opts?: AnalyticsStateMachineOptions) {\n    super(opts);\n    this.stateMachine = new Bitmovin8AnalyticsStateMachine(this.stateMachineCallbacks, this.opts);\n    this.speedMeter = new Bitmovin8SpeedMeterAdapter(player, new DownloadSpeedMeter()).getDownloadSpeedMeter();\n    this.segmentTracker = new Bitmovin8SegmentTrackerAdapter(player, new SegmentTracker()).getSegmentTracker();\n    this.httpRequestTrackingAdapter = new Bitmovin8HttpRequestTrackingAdapter(player);\n    this.videoCompletionTracker = new VideoCompletionTracker();\n  }\n  protected get currentTime(): number {\n    try {\n      if (this.player !== null && this.player.getCurrentTime !== null) {\n        return this.player.getCurrentTime();\n      }\n    } catch {\n      logger.warning('Analytics Collector attempted to access player, but player is not available anymore');\n    }\n    return this.lastTrackedCurrentTime ? this.lastTrackedCurrentTime : 0;\n  }\n\n  public initialize(analytics: Analytics): Array<Feature<FeatureConfigContainer, FeatureConfig>> {\n    this.register();\n\n    const requestTracking = new HttpRequestTracking([this.httpRequestTrackingAdapter]);\n    const errorDetailTracking = new ErrorDetailTracking(\n      analytics.errorDetailTrackingSettingsProvider,\n      new ErrorDetailBackend(analytics.errorDetailTrackingSettingsProvider.collectorConfig),\n      [analytics.errorDetailSubscribable],\n      requestTracking\n    );\n    return [errorDetailTracking];\n  }\n\n  public clearValues(): void {\n    this.speedMeter.reset();\n  }\n\n  public clearSegments(): void {\n    this.segmentTracker.reset();\n  }\n\n  public getPlayerVersion = () => this.player.version;\n  public getPlayerName = () => Player.BITMOVIN;\n  public getPlayerTech = () => this.player.getPlayerType();\n  public getAutoPlay(): boolean {\n    if (this.player.getConfig().playback) {\n      return (this.player.getConfig() as any).playback.autoplay || false;\n    }\n    return false;\n  }\n  public getDrmPerformanceInfo = (): DrmPerformanceInfo | undefined => this.drmPerformanceInfo;\n\n  public getCurrentPlaybackInfo(): PlaybackInfo {\n    const info: PlaybackInfo = {\n      ...super.getCommonPlaybackInfo(),\n      size: this.player.getViewMode() === ViewMode.Fullscreen ? PlayerSize.Fullscreen : PlayerSize.Window,\n      playerTech: this.getPlayerTech(),\n      isLive: this.player.isLive(),\n      videoDuration: this.player.getDuration(),\n      streamFormat: this.player.getStreamType(),\n      videoWindowWidth: this.player.getContainer().offsetWidth,\n      videoWindowHeight: this.player.getContainer().offsetHeight,\n      isMuted: this.player.isMuted(),\n      isCasting: this.player.isCasting(),\n      audioLanguage: this.player.getAudio() != null ? this.player.getAudio().lang : undefined,\n      subtitleEnabled: false,\n      droppedFrames: this.player.getSource() != null ? this.player.getDroppedVideoFrames() : 0,\n    };\n\n    this.applySubtitleProperties(info);\n    this.applyPlaybackQualityProperties(info);\n    this.applyCastingProperties(info);\n    this.applySourceProperties(info);\n\n    return info;\n  }\n\n  public register() {\n    this.player.on(this.player.exports.PlayerEvent.SourceUnloaded, (event: any) => {\n      this.segmentTracker.reset();\n      this.eventCallback(Event.SOURCE_UNLOADED, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.SourceLoaded, (event: any) => {\n      this.videoCompletionTracker.reset();\n      this.resetSourceRelatedState();\n      this.videoCompletionTracker.setVideoDuration(this.player.getDuration());\n      this.eventCallback(Event.SOURCE_LOADED, {});\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.CastStarted, (event: any) => {\n      this.eventCallback(Event.START_CAST, event);\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.CastStopped, () => {\n      this.eventCallback(Event.END_CAST, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.Play, (e: UserInteractionEvent) => {\n      if (e.issuer !== 'ui-seek') {\n        this.eventCallback(Event.PLAY, {\n          currentTime: this.currentTime,\n        });\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.Playing, (e: UserInteractionEvent) => {\n      if (e.issuer !== 'advertising-api') {\n        this.eventCallback(Event.PLAYING, {\n          currentTime: this.currentTime,\n        });\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.Paused, (e: UserInteractionEvent) => {\n      if (e.issuer !== 'ui-seek') {\n        this.eventCallback(Event.PAUSE, {\n          currentTime: this.currentTime,\n        });\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.TimeChanged, (e: PlayerEventBase) => {\n      this.lastTrackedCurrentTime = this.player.getCurrentTime();\n      this.eventCallback(Event.TIMECHANGED, {\n        currentTime: this.lastTrackedCurrentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.Seek, (e: UserInteractionEvent) => {\n      if (this.allowSeeking(e)) {\n        this.eventCallback(Event.SEEK, {\n          currentTime: this.currentTime,\n        });\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.Seeked, () => {\n      this.eventCallback(Event.SEEKED, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.StallStarted, () => {\n      this.eventCallback(Event.START_BUFFERING, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.StallEnded, () => {\n      this.eventCallback(Event.END_BUFFERING, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.AudioPlaybackQualityChanged, () => {\n      const quality = this.player.getPlaybackAudioData();\n\n      if (this.shouldAllowAudioQualityChange(quality.bitrate)) {\n        this.setPreviousAudioBitrate(quality.bitrate);\n        this.eventCallback(Event.AUDIO_CHANGE, {\n          bitrate: quality.bitrate,\n          currentTime: this.currentTime,\n          codec: (quality as any).codec,\n        });\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.VideoPlaybackQualityChanged, () => {\n      const quality = this.player.getPlaybackVideoData();\n\n      if (this.shouldAllowVideoQualityChange(quality.bitrate)) {\n        this.setPreviousVideoBitrate(quality.bitrate);\n        this.eventCallback(Event.VIDEO_CHANGE, {\n          width: quality.width,\n          height: quality.height,\n          bitrate: quality.bitrate,\n          currentTime: this.currentTime,\n          codec: (quality as any).codec,\n        });\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.ViewModeChanged, (e: any) => {\n      if (e.to === 'fullscreen') {\n        this.eventCallback(Event.START_FULLSCREEN, {\n          currentTime: this.currentTime,\n        });\n      } else if (e.from === 'fullscreen') {\n        this.eventCallback(Event.END_FULLSCREEN, {\n          currentTime: this.currentTime,\n        });\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.AdStarted, (event: any) => {\n      this.eventCallback(Event.START_AD, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.AdFinished, (event: any) => {\n      this.eventCallback(Event.END_AD, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.AdSkipped, (event: any) => {\n      this.eventCallback(Event.END_AD, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.AdError, (event: any) => {\n      this.eventCallback(Event.END_AD, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.Muted, () => {\n      this.eventCallback(Event.MUTE, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.Unmuted, () => {\n      this.eventCallback(Event.UN_MUTE, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.Error, (event: any) => {\n      this.eventCallback(Event.ERROR, {\n        code: event.code,\n        message: event.name,\n        legacyData: event.data,\n        currentTime: this.currentTime,\n        data: {\n          additionalData: JSON.stringify(event.data),\n        },\n      });\n      if (\n        event.code === ErrorCode.BITMOVIN_PLAYER_LICENSING_ERROR.code ||\n        event.code === ErrorCode.SETUP_MISSING_LICENSE_WHITELIST.code\n      ) {\n        this._onLicenseCallFailed.dispatch({});\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.PlaybackFinished, () => {\n      this.eventCallback(Event.PLAYBACK_FINISHED, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.DownloadFinished, (event: any) => {\n      if (event.downloadType.indexOf('drm/license/') === 0) {\n        this.drmPerformanceInfo = {\n          drmType: event.downloadType.replace('drm/license/', ''),\n          drmLoadTime: event.downloadTime * 1000,\n        };\n      }\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.AudioChanged, (event: any) => {\n      this.eventCallback(Event.AUDIOTRACK_CHANGED, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.SubtitleEnabled, (event: any) => {\n      this.eventCallback(Event.SUBTITLE_CHANGE, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    this.player.on(this.player.exports.PlayerEvent.SubtitleDisabled, (event: any) => {\n      this.eventCallback(Event.SUBTITLE_CHANGE, {\n        currentTime: this.currentTime,\n      });\n    });\n\n    // @ts-ignore\n    this.player.on(this.player.exports.PlayerEvent.LicenseValidated, (event: any) => {\n      if (event.data.analytics && event.data.analytics.key !== undefined) {\n        this._onLicenseKeyReceived.dispatch({licenseKey: event.data.analytics.key});\n      } else {\n        this._onLicenseCallFailed.dispatch({});\n      }\n    });\n\n    let handleCollectorUnload = () => {\n      if (!this.onBeforeUnLoadEvent) {\n        this.onBeforeUnLoadEvent = true;\n        // we use here the last tracked video time as we cannot be sure if the player is still working at this place\n        const currentTime = this.lastTrackedCurrentTime;\n        this.eventCallback(Event.UNLOAD, {currentTime});\n      }\n      this.release();\n    };\n    handleCollectorUnload = handleCollectorUnload.bind(true);\n\n    this.player.on(this.player.exports.PlayerEvent.Destroy, handleCollectorUnload);\n    window.addEventListener('beforeunload', handleCollectorUnload);\n    window.addEventListener('unload', handleCollectorUnload);\n\n    this._adModule = new Bitmovin8AdModule(this.player);\n  }\n\n  public sourceChange(config, timestamp) {\n    this.stateMachine.sourceChange(config, timestamp, this.currentTime);\n  }\n\n  public onError(): void {\n    this.clearSegments();\n  }\n\n  private applySourceProperties(info: PlaybackInfo) {\n    const source = this.player.getSource();\n    if (source == null) {\n      return;\n    }\n\n    info.videoTitle = source.title;\n    info.mpdUrl = source.dash;\n    info.m3u8Url = source.hls;\n\n    const progSourceInfo = getSourceInfoFromBitmovinSourceConfig(source.progressive, this.player);\n    info.progUrl = progSourceInfo.progUrl;\n    if (this.player.getStreamType() === 'progressive') {\n      info.videoBitrate = progSourceInfo.progBitrate;\n    }\n  }\n\n  private applySubtitleProperties(info: PlaybackInfo) {\n    let enabledSubtitle;\n    if (this.player.subtitles) {\n      enabledSubtitle = this.player.subtitles.list().find((s) => s.enabled === true);\n    }\n\n    info.subtitleEnabled = enabledSubtitle != null;\n    info.subtitleLanguage = enabledSubtitle != null ? enabledSubtitle.lang : null;\n  }\n\n  private applyPlaybackQualityProperties(info: PlaybackInfo) {\n    const videoQuality = this.player.getPlaybackVideoData();\n    if (videoQuality !== null) {\n      info.videoBitrate = videoQuality.bitrate;\n      info.videoPlaybackHeight = videoQuality.height;\n      info.videoPlaybackWidth = videoQuality.width;\n      info.videoCodec = (videoQuality as any).codec;\n    }\n\n    const audioQuality = this.player.getPlaybackAudioData();\n    if (audioQuality !== null) {\n      info.audioBitrate = audioQuality.bitrate;\n      info.audioCodec = (audioQuality as any).codec;\n    }\n  }\n\n  private applyCastingProperties(info: PlaybackInfo) {\n    const isCasting = this.player.isCasting() || this.player.isAirplayActive() || false;\n    info.isCasting = isCasting;\n    if (!isCasting) {\n      return;\n    }\n\n    // AirPlay\n    if (this.player.isAirplayActive()) {\n      info.castTech = CastTech.AirPlay;\n      return;\n    }\n\n    // Casting Tech from RemoteControlConfig\n    const remoteControlConfig = this.player.getConfig().remotecontrol;\n    if (remoteControlConfig === null || remoteControlConfig === undefined) {\n      return;\n    }\n\n    switch (remoteControlConfig.type) {\n      case 'googlecast':\n        info.castTech = CastTech.GoogleCast;\n        break;\n      case 'websocket':\n        info.castTech = CastTech.WebSocket;\n        break;\n    }\n  }\n\n  // with this check we ignore seek events which are smaller than the Threshold\n  // mainly to ignore keyboard triggered seeks\n  private allowSeeking(e: UserInteractionEvent): boolean {\n    const seekEvent = e as SeekEvent;\n    const seekDifference = Math.abs(seekEvent.position - seekEvent.seekTarget);\n    return seekDifference > AnalyticsSettings.ANALYTICS_MIN_SEEK_DIFFERENCE_THRESHOLD;\n  }\n}\n","import * as StateMachine from 'javascript-state-machine';\nimport {Event, EventMap} from '../enums/Event';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {NoExtraProperties} from '../types/NoExtraProperties';\nimport {StateMachineCallbacks} from '../types/StateMachineCallbacks';\nimport {EventDebugging} from '../utils/EventDebugging';\nimport {logger, padRight} from '../utils/Logger';\nimport {noOp} from '../utils/Utils';\nimport {AnalyticsStateMachine} from './AnalyticsStateMachine';\n\nenum State {\n  SETUP = 'SETUP',\n  STARTUP = 'STARTUP',\n  READY = 'READY',\n  PLAYING = 'PLAYING',\n  REBUFFERING = 'REBUFFERING',\n  PAUSE = 'PAUSE',\n  QUALITYCHANGE = 'QUALITYCHANGE',\n  PLAY_SEEKING = 'PLAY_SEEKING',\n  END_PLAY_SEEKING = 'END_PLAY_SEEKING',\n  QUALITYCHANGE_PAUSE = 'QUALITYCHANGE_PAUSE',\n  QUALITYCHANGE_REBUFFERING = 'QUALITYCHANGE_REBUFFERING',\n  END = 'END',\n  ERROR = 'ERROR',\n  /** This event is called when an ad is played directly after the player startup phase */\n  AD_STARTUP = 'AD_STARTUP',\n  AD_READY = 'AD_READY',\n  AD_PAUSE = 'AD_PAUSE',\n  AD_PLAYING = 'AD_PLAYING',\n  MUTING_READY = 'MUTING_READY',\n  MUTING_PLAY = 'MUTING_PLAY',\n  MUTING_PAUSE = 'MUTING_PAUSE',\n  CASTING = 'CASTING',\n  SOURCE_CHANGING = 'SOURCE_CHANGING',\n  INITIAL_SOURCE_CHANGE = 'INITIAL_SOURCE_CHANGE',\n  SOURCE_LOADED = 'SOURCE_LOADED',\n  SUBTITLE_CHANGING = 'SUBTITLE_CHANGING',\n  AUDIOTRACK_CHANGING = 'AUDIOTRACK_CHANGING',\n  EXIT_BEFORE_VIDEOSTART = 'EXIT_BEFORE_VIDEOSTART',\n  CUSTOMDATACHANGE = 'CUSTOMDATACHANGE',\n}\n\nexport class Bitmovin8AnalyticsStateMachine extends AnalyticsStateMachine {\n  private debuggingStates: EventDebugging[] = [];\n  private enabledDebugging = false;\n\n  private seekTimestamp: number;\n  private seekedTimestamp: number;\n  private seekStarted: boolean;\n  private seekEnded: boolean;\n\n  constructor(stateMachineCallbacks: StateMachineCallbacks, opts: AnalyticsStateMachineOptions) {\n    super(stateMachineCallbacks, opts);\n    this.seekTimestamp = 0;\n    this.seekedTimestamp = 0;\n    this.seekStarted = false;\n    this.seekEnded = false;\n  }\n\n  public getAllStatesBut(states: string[]) {\n    return this.getAllStates().filter((i) => states.indexOf(i) < 0);\n  }\n\n  public getAllStates() {\n    return Object.keys(State).map((key) => State[key]);\n  }\n\n  public sourceChange = (config: any, timestamp: number, currentTime?: number) => {\n    this.callEvent(Event.MANUAL_SOURCE_CHANGE, {config, currentTime}, timestamp);\n  };\n\n  public createStateMachine(opts: AnalyticsStateMachineOptions): StateMachine.StateMachine {\n    return StateMachine.create({\n      initial: State.SETUP,\n      error: (eventName, from, to, args, errorCode, errorMessage) => {\n        logger.error('Error in statemachine: ' + errorMessage);\n      },\n      events: [\n        // {name: Event.SOURCE_LOADED, from: [State.SETUP, State.ERROR, State.SOURCE_CHANGING], to: State.READY},\n        {\n          name: Event.SOURCE_LOADED,\n          from: [State.SETUP, State.ERROR, State.SOURCE_CHANGING, State.INITIAL_SOURCE_CHANGE],\n          to: State.READY,\n        },\n\n        {name: Event.PLAY, from: State.READY, to: State.STARTUP},\n        {name: Event.PLAYING, from: State.READY, to: State.PLAYING},\n        {name: Event.READY, from: State.READY, to: State.READY},\n        {name: Event.VIDEO_CHANGE, from: State.READY, to: State.READY},\n        {name: Event.AUDIO_CHANGE, from: State.READY, to: State.READY},\n\n        {name: Event.ERROR, from: [State.STARTUP, State.AD_STARTUP], to: State.EXIT_BEFORE_VIDEOSTART},\n        {name: Event.UNLOAD, from: [State.STARTUP, State.AD_STARTUP], to: State.EXIT_BEFORE_VIDEOSTART},\n        {name: Event.VIDEOSTART_TIMEOUT, from: State.STARTUP, to: State.EXIT_BEFORE_VIDEOSTART},\n\n        {name: Event.PLAY, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.PLAYING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.TIMECHANGED, from: State.STARTUP, to: State.PLAYING},\n        {name: Event.START_BUFFERING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.END_BUFFERING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.VIDEO_CHANGE, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.AUDIO_CHANGE, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.READY, from: State.STARTUP, to: State.STARTUP},\n\n        {name: Event.PLAYING, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.TIMECHANGED, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.END_BUFFERING, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.START_BUFFERING, from: State.PLAYING, to: State.REBUFFERING},\n        {name: Event.END_BUFFERING, from: State.REBUFFERING, to: State.PLAYING},\n        {name: Event.TIMECHANGED, from: State.REBUFFERING, to: State.REBUFFERING},\n\n        {name: Event.PAUSE, from: State.PLAYING, to: State.PAUSE},\n        {name: Event.PAUSE, from: State.REBUFFERING, to: State.PAUSE},\n        {name: Event.PLAY, from: State.PAUSE, to: State.PLAYING},\n\n        {name: Event.VIDEO_CHANGE, from: State.PLAYING, to: State.QUALITYCHANGE},\n        {name: Event.AUDIO_CHANGE, from: State.PLAYING, to: State.QUALITYCHANGE},\n        {name: Event.VIDEO_CHANGE, from: State.QUALITYCHANGE, to: State.QUALITYCHANGE},\n        {name: Event.AUDIO_CHANGE, from: State.QUALITYCHANGE, to: State.QUALITYCHANGE},\n        {name: 'FINISH_QUALITYCHANGE', from: State.QUALITYCHANGE, to: State.PLAYING},\n\n        {name: Event.VIDEO_CHANGE, from: State.PAUSE, to: State.QUALITYCHANGE_PAUSE},\n        {name: Event.AUDIO_CHANGE, from: State.PAUSE, to: State.QUALITYCHANGE_PAUSE},\n        {\n          name: Event.VIDEO_CHANGE,\n          from: State.QUALITYCHANGE_PAUSE,\n          to: State.QUALITYCHANGE_PAUSE,\n        },\n        {\n          name: Event.AUDIO_CHANGE,\n          from: State.QUALITYCHANGE_PAUSE,\n          to: State.QUALITYCHANGE_PAUSE,\n        },\n        {name: 'FINISH_QUALITYCHANGE_PAUSE', from: State.QUALITYCHANGE_PAUSE, to: State.PAUSE},\n\n        //#region Seeking\n\n        // start seeking\n        {name: Event.SEEK, from: State.PLAYING, to: State.PLAY_SEEKING},\n\n        // mark the seeked as finished\n        {name: Event.PLAY, from: State.PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.PLAYING, from: State.PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.SEEKED, from: State.PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n\n        // seek while previous seek not completed\n        {name: Event.SEEK, from: State.END_PLAY_SEEKING, to: State.PLAY_SEEKING},\n\n        // seek completely finished and cont playing\n        {name: Event.PLAYING, from: State.END_PLAY_SEEKING, to: State.PLAYING},\n        {name: Event.TIMECHANGED, from: State.END_PLAY_SEEKING, to: State.PLAYING},\n\n        //#region disable transitions\n        // disable tranitions in PLAY_SEEKING\n        {name: Event.SEEK, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.AUDIO_CHANGE, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.VIDEO_CHANGE, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.START_BUFFERING, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.END_BUFFERING, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        // disable transitions in END_PLAY_SEEKING\n        {name: Event.START_BUFFERING, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.END_BUFFERING, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.SEEKED, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.PLAY, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        // disable Seek events during PAUSE\n        {name: Event.SEEK, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.SEEKED, from: State.PAUSE, to: State.PAUSE},\n\n        // ignore seeked during Playing because of not allowed keyboard seeking\n        {name: Event.SEEKED, from: State.PLAYING, to: State.PLAYING},\n\n        //#endregion\n        //#endregion\n\n        {name: Event.END, from: State.PLAY_SEEKING, to: State.END},\n        {name: Event.END, from: State.PLAYING, to: State.END},\n        {name: Event.END, from: State.PAUSE, to: State.END},\n        {name: Event.SEEK, from: State.END, to: State.END},\n        {name: Event.SEEKED, from: State.END, to: State.END},\n        {name: Event.TIMECHANGED, from: State.END, to: State.END},\n        {name: Event.END_BUFFERING, from: State.END, to: State.END},\n        {name: Event.START_BUFFERING, from: State.END, to: State.END},\n        {name: Event.END, from: State.END, to: State.END},\n\n        {name: Event.PLAY, from: State.END, to: State.STARTUP},\n\n        {name: Event.ERROR, from: this.getAllStatesBut([State.STARTUP]), to: State.ERROR},\n\n        {name: Event.UNLOAD, from: this.getAllStatesBut([State.STARTUP, State.AD_STARTUP]), to: State.END},\n\n        {name: Event.CUSTOM_DATA_CHANGE, from: [State.PLAYING, State.PAUSE], to: State.CUSTOMDATACHANGE},\n        {name: Event.PLAYING, from: State.CUSTOMDATACHANGE, to: State.PLAYING},\n        {name: Event.PAUSE, from: State.CUSTOMDATACHANGE, to: State.PAUSE},\n\n        {name: Event.SUBTITLE_CHANGE, from: State.PLAYING, to: State.SUBTITLE_CHANGING},\n        {name: Event.SUBTITLE_CHANGE, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.SUBTITLE_CHANGE, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.SUBTITLE_CHANGE, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.SUBTITLE_CHANGE, from: State.SUBTITLE_CHANGING, to: State.SUBTITLE_CHANGING},\n        {name: Event.TIMECHANGED, from: State.SUBTITLE_CHANGING, to: State.PLAYING},\n\n        {name: Event.AUDIOTRACK_CHANGED, from: State.PLAYING, to: State.AUDIOTRACK_CHANGING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.AUDIOTRACK_CHANGING, to: State.AUDIOTRACK_CHANGING},\n        {name: Event.TIMECHANGED, from: State.AUDIOTRACK_CHANGING, to: State.PLAYING},\n\n        // #region Ads\n        {name: Event.START_AD, from: State.STARTUP, to: State.AD_STARTUP},\n        {name: Event.END_AD, from: State.AD_STARTUP, to: State.STARTUP},\n        {name: Event.PLAY, from: State.AD_STARTUP, to: State.AD_STARTUP},\n        {name: Event.PAUSE, from: State.AD_STARTUP, to: State.AD_STARTUP},\n\n        {name: Event.START_AD, from: State.READY, to: State.AD_READY},\n        /** After the pre-rolls, the main content will always start playing, no matter if autoplay: true/false */\n        {name: Event.END_AD, from: State.AD_READY, to: State.STARTUP},\n        {name: Event.PLAY, from: State.AD_READY, to: State.AD_READY},\n        {name: Event.PAUSE, from: State.AD_READY, to: State.AD_READY},\n\n        {name: Event.START_AD, from: State.PAUSE, to: State.AD_PAUSE},\n        {name: Event.END_AD, from: State.AD_PAUSE, to: State.PAUSE},\n        {name: Event.PLAY, from: State.AD_PAUSE, to: State.AD_PAUSE},\n        {name: Event.PAUSE, from: State.AD_PAUSE, to: State.AD_PAUSE},\n\n        {name: Event.START_AD, from: State.PLAYING, to: State.AD_PLAYING},\n        {name: Event.END_AD, from: State.AD_PLAYING, to: State.PLAYING},\n        {name: Event.PLAY, from: State.AD_PLAYING, to: State.AD_PLAYING},\n        {name: Event.PAUSE, from: State.AD_PLAYING, to: State.AD_PLAYING},\n        {name: Event.END, from: State.AD_PLAYING, to: State.END},\n\n        // Ignore timechanged events during ads\n        {name: Event.TIMECHANGED, from: State.AD_STARTUP, to: State.AD_STARTUP},\n        {name: Event.TIMECHANGED, from: State.AD_READY, to: State.AD_READY},\n        {name: Event.TIMECHANGED, from: State.AD_PAUSE, to: State.AD_PAUSE},\n        {name: Event.TIMECHANGED, from: State.AD_PLAYING, to: State.AD_PLAYING},\n\n        // Ignore End Ad events when no ad has started\n        {name: Event.END_AD, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.END_AD, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.END_AD, from: State.READY, to: State.READY},\n        {name: Event.END_AD, from: State.STARTUP, to: State.STARTUP},\n        // #endregion\n\n        {name: Event.MUTE, from: State.READY, to: State.MUTING_READY},\n        {name: Event.UN_MUTE, from: State.READY, to: State.MUTING_READY},\n        {name: 'FINISH_MUTING', from: State.MUTING_READY, to: State.READY},\n\n        {name: Event.MUTE, from: State.PLAYING, to: State.MUTING_PLAY},\n        {name: Event.UN_MUTE, from: State.PLAYING, to: State.MUTING_PLAY},\n        {name: 'FINISH_MUTING', from: State.MUTING_PLAY, to: State.PLAYING},\n\n        {name: Event.MUTE, from: State.PAUSE, to: State.MUTING_PAUSE},\n        {name: Event.UN_MUTE, from: State.PAUSE, to: State.MUTING_PAUSE},\n        {name: 'FINISH_MUTING', from: State.MUTING_PAUSE, to: State.PAUSE},\n\n        {name: Event.START_CAST, from: [State.READY, State.PAUSE, State.PLAYING], to: State.CASTING},\n        {name: Event.PAUSE, from: State.CASTING, to: State.CASTING},\n        {name: Event.PLAY, from: State.CASTING, to: State.CASTING},\n        {name: Event.PLAYING, from: State.CASTING, to: State.CASTING},\n        {name: Event.TIMECHANGED, from: State.CASTING, to: State.CASTING},\n        {name: Event.MUTE, from: State.CASTING, to: State.CASTING},\n        {name: Event.UN_MUTE, from: State.CASTING, to: State.CASTING},\n        {name: Event.SEEK, from: State.CASTING, to: State.CASTING},\n        {name: Event.SEEKED, from: State.CASTING, to: State.CASTING},\n        {name: Event.END_CAST, from: State.CASTING, to: State.READY},\n\n        {name: Event.SEEK, from: State.READY, to: State.READY},\n        {name: Event.SEEKED, from: State.READY, to: State.READY},\n        {name: Event.SEEKED, from: State.STARTUP, to: State.STARTUP},\n\n        {\n          name: Event.MANUAL_SOURCE_CHANGE,\n          from: this.getAllStatesBut([State.SETUP]),\n          to: State.SOURCE_CHANGING,\n        },\n        {\n          name: Event.MANUAL_SOURCE_CHANGE,\n          from: State.SETUP,\n          to: State.INITIAL_SOURCE_CHANGE,\n        },\n        {name: Event.SOURCE_UNLOADED, from: this.getAllStates(), to: State.SOURCE_CHANGING},\n\n        // {name: Event.READY, from: State.SOURCE_CHANGING, to: State.READY},\n\n        {name: Event.VIDEO_CHANGE, from: State.REBUFFERING, to: State.QUALITYCHANGE_REBUFFERING},\n        {name: Event.AUDIO_CHANGE, from: State.REBUFFERING, to: State.QUALITYCHANGE_REBUFFERING},\n        {\n          name: Event.VIDEO_CHANGE,\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.QUALITYCHANGE_REBUFFERING,\n        },\n        {\n          name: Event.AUDIO_CHANGE,\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.QUALITYCHANGE_REBUFFERING,\n        },\n        {\n          name: 'FINISH_QUALITYCHANGE_REBUFFERING',\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.REBUFFERING,\n        },\n      ],\n      callbacks: {\n        onbeforeevent: (event, from, to, timestamp, eventObject) => {\n          if (from === State.REBUFFERING && to === State.QUALITYCHANGE_REBUFFERING) {\n            return false;\n          }\n        },\n        onafterevent: (event, from, to, timestamp, eventObject) => {\n          if (event === Event.MANUAL_SOURCE_CHANGE && from === State.SETUP) {\n            this.stateMachineCallbacks.initialSourceChange(eventObject);\n          } else if (event === Event.MANUAL_SOURCE_CHANGE) {\n            this.stateMachineCallbacks.manualSourceChange(eventObject);\n          }\n\n          if (to === State.QUALITYCHANGE_PAUSE) {\n            this.stateMachine.FINISH_QUALITYCHANGE_PAUSE(timestamp);\n          }\n          if (to === State.QUALITYCHANGE) {\n            this.stateMachine.FINISH_QUALITYCHANGE(timestamp);\n          }\n          if (to === State.QUALITYCHANGE_REBUFFERING) {\n            this.stateMachine.FINISH_QUALITYCHANGE_REBUFFERING(timestamp);\n          }\n          if (to === State.MUTING_READY || to === State.MUTING_PLAY || to === State.MUTING_PAUSE) {\n            this.stateMachine.FINISH_MUTING(timestamp);\n          }\n        },\n        onenterstate: (\n          event: string | undefined,\n          from: string | undefined,\n          to: string | undefined,\n          timestamp: number,\n          eventObject: any\n        ) => {\n          if (from === 'none' && opts.starttime) {\n            this.onEnterStateTimestamp = opts.starttime;\n          } else {\n            this.onEnterStateTimestamp = timestamp || new Date().getTime();\n          }\n\n          logger.log(\n            '[ENTER ' +\n              timestamp +\n              '] ' +\n              padRight(to, 20) +\n              'EVENT: ' +\n              padRight(event, 20) +\n              ' from ' +\n              padRight(from, 20)\n          );\n          if (\n            eventObject &&\n            to !== State.END_PLAY_SEEKING &&\n            from !== State.PLAY_SEEKING &&\n            !(event === Event.SEEK && from === State.END_PLAY_SEEKING)\n          ) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.START_CAST && to === State.CASTING) {\n            this.stateMachineCallbacks.startCasting(timestamp, eventObject);\n          }\n\n          if (to === State.REBUFFERING) {\n            this.startRebufferingHeartbeatInterval();\n          }\n        },\n        onleavestate: (event, from, to, timestamp, eventObject) => {\n          if (from === State.REBUFFERING) {\n            this.resetRebufferingHelpers();\n          }\n\n          if (!timestamp) {\n            return;\n          }\n\n          logger.log(\n            '[LEAVE ' +\n              timestamp +\n              '] ' +\n              padRight(from, 20) +\n              'EVENT: ' +\n              padRight(event, 20) +\n              ' to ' +\n              padRight(to, 20)\n          );\n\n          this.addStatesToLog(event, from, to, timestamp, eventObject);\n          const stateDuration = timestamp - this.onEnterStateTimestamp;\n\n          if (eventObject && to !== State.END_PLAY_SEEKING) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n          }\n\n          if ((from === State.READY || from === State.AD_STARTUP) && to === State.STARTUP) {\n            this.setVideoStartTimeout();\n          } else if (from === State.STARTUP && (to === State.PLAYING || to === State.AD_STARTUP)) {\n            this.clearVideoStartTimeout();\n          }\n\n          const fnName = String(from).toLowerCase();\n          if (to === State.EXIT_BEFORE_VIDEOSTART) {\n            this.clearVideoStartTimeout();\n            const eventData = this.getVideoStartupFailedEventData(timestamp, event, eventObject);\n            const shouldSendSample = event !== Event.ERROR;\n            this.stateMachineCallbacks.videoStartFailed(eventData, shouldSendSample);\n          } else if (from === State.END_PLAY_SEEKING) {\n            const seekDuration = this.seekedTimestamp - this.seekTimestamp;\n\n            // do not enter here if\n            // 1. no seek has started because of SEEK\n            // 2. no seek has ended because of SEEKED event\n            // 3. leave of END_PLAY_SEEKING was triggered by another SEEK event (continuous seeking)\n            if (this.seekStarted && this.seekEnded && event !== Event.SEEK) {\n              this.seekStarted = this.seekEnded = false;\n              this.stateMachineCallbacks.end_play_seeking(seekDuration, fnName);\n            }\n          } else if (event === Event.UNLOAD) {\n            this.stateMachineCallbacks.unload(stateDuration, fnName);\n          } else if (\n            from === State.AD_PAUSE ||\n            from === State.AD_READY ||\n            from === State.AD_PLAYING ||\n            from === State.AD_STARTUP\n          ) {\n            this.stateMachineCallbacks.ad(stateDuration, 'ad');\n          } else if (event === Event.START_AD && from === State.STARTUP) {\n            noOp();\n          } else if (event === Event.SOURCE_LOADED && from === State.INITIAL_SOURCE_CHANGE) {\n            noOp();\n          } else if (from !== State.ERROR) {\n            const callbackFunction = this.stateMachineCallbacks[fnName];\n            if (typeof callbackFunction === 'function') {\n              try {\n                callbackFunction(stateDuration, fnName, eventObject);\n              } catch (e) {\n                logger.error('Exception occured in State Machine callback ' + fnName, eventObject, e);\n              }\n            } else {\n              logger.error('Could not find callback function for ' + fnName);\n            }\n          }\n\n          if (\n            eventObject &&\n            to !== State.END_PLAY_SEEKING &&\n            from !== State.PLAY_SEEKING &&\n            to !== State.PLAY_SEEKING\n          ) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.VIDEO_CHANGE) {\n            this.stateMachineCallbacks.videoChange(eventObject);\n          } else if (event === Event.AUDIO_CHANGE) {\n            this.stateMachineCallbacks.audioChange(eventObject);\n          } else if (event === Event.MUTE) {\n            this.stateMachineCallbacks.mute();\n          } else if (event === Event.UN_MUTE) {\n            this.stateMachineCallbacks.unMute();\n          }\n        },\n        onseek: (event, from, to, timestamp) => {\n          if (!this.seekStarted) {\n            this.seekTimestamp = timestamp;\n            this.seekStarted = true;\n          }\n        },\n        onseeked: (event, from, to, timestamp) => {\n          this.seekedTimestamp = timestamp;\n          this.seekEnded = true;\n        },\n        ontimechanged: (event, from, to, timestamp, eventObject) => {\n          if (this.stateMachine.current !== 'PLAYING') {\n            return;\n          }\n\n          const stateDuration = timestamp - this.onEnterStateTimestamp;\n\n          if (stateDuration > 59700) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n\n            this.stateMachineCallbacks.heartbeat(stateDuration, String(from).toLowerCase(), {played: stateDuration});\n            this.onEnterStateTimestamp = timestamp;\n\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n        },\n        onplayerError: (event, from, to, timestamp, eventObject) => {\n          this.stateMachineCallbacks.error(eventObject);\n        },\n      },\n    });\n  }\n\n  public callEvent<StatemachineEvent extends keyof EventMap, EventData extends EventMap[StatemachineEvent]>(\n    eventType: StatemachineEvent,\n    eventObject: NoExtraProperties<EventMap[StatemachineEvent], EventData>,\n    timestamp: number\n  ): void {\n    const exec = this.stateMachine[eventType];\n\n    if (exec) {\n      try {\n        exec.call(this.stateMachine, timestamp, eventObject);\n      } catch (e) {\n        logger.error('Exception occured in State Machine callback ' + eventType, exec, eventObject, e);\n      }\n    } else {\n      logger.log('Ignored Event: ' + eventType);\n    }\n  }\n\n  public addStatesToLog(\n    event: string | undefined,\n    from: string | undefined,\n    to: string | undefined,\n    timestamp: number,\n    eventObject: any\n  ) {\n    if (this.enabledDebugging) {\n      this.debuggingStates.push(new EventDebugging(event, from, to, timestamp, eventObject));\n    }\n  }\n\n  public getStates() {\n    return this.debuggingStates;\n  }\n\n  public setEnabledDebugging(enabled: boolean) {\n    this.enabledDebugging = enabled;\n  }\n}\n","import * as Utils from './Utils';\n\nexport class Converter {\n  public static bytesToBits(bytes: number): number {\n    return bytes * 8;\n  }\n  public static bitsToBytes(bits: number): number {\n    return Math.round(bits / 8);\n  }\n  public static bytesToKiloBytes(bytes: number): number {\n    return Utils.calculateTime(bytes * 1000);\n  }\n  public static kiloBytesToMegaBytes(kiloByte: number): number {\n    return kiloByte * 1000;\n  }\n}\n","import {SpeedMeasurement} from '../types/SpeedMeasurement';\n\nexport class Measure implements SpeedMeasurement {\n  private download: SpeedMeasurement;\n\n  get speed(): number {\n    return this.download.size / this.download.duration;\n  }\n  get duration(): number {\n    return this.download.duration;\n  }\n  get size(): number {\n    return this.download.size;\n  }\n  get timeToFirstByte(): number {\n    return this.download.timeToFirstByte;\n  }\n  get timestamp(): Date {\n    return this.download.timestamp;\n  }\n\n  get httpStatus(): number {\n    return this.download.httpStatus;\n  }\n\n  constructor(download: SpeedMeasurement) {\n    this.download = download;\n  }\n}\n","import {SegmentInfo} from '../types/SegmentInfo';\n\nexport class SegmentTracker {\n  protected segments: SegmentInfo[];\n\n  constructor() {\n    this.segments = [];\n  }\n\n  public reset(): void {\n    this.segments = [];\n  }\n\n  public addSegment(segment: SegmentInfo): void {\n    this.segments.push(segment);\n  }\n\n  public removeSegment(url: string): void {\n    this.segments = this.segments.filter((s) => s.url !== url);\n  }\n\n  public getSegments(): SegmentInfo[] {\n    return this.segments;\n  }\n}\n","import {Subscribable} from '../../core/EventDispatcher';\nimport {logger} from '../../utils/Logger';\nimport {Queue} from '../../utils/Queue';\nimport {HttpRequest} from './HttpRequest';\nimport {OnDownloadFinishedEventObject} from './OnDownloadFinishedEventObject';\n\nexport class HttpRequestTracking {\n  private static DEFAULT_MAX_REQUESTS = 10;\n  private _maxRequests: number = HttpRequestTracking.DEFAULT_MAX_REQUESTS;\n  private _httpRequestQueue = new Queue<HttpRequest>();\n\n  public get maxRequests(): number {\n    return this._maxRequests;\n  }\n\n  public get httpRequests(): ReadonlyArray<HttpRequest> {\n    return this._httpRequestQueue.items;\n  }\n\n  constructor(private subscribables: Array<Subscribable<OnDownloadFinishedEventObject>>) {\n    subscribables.forEach((subscribable) => subscribable.subscribe(this.onDownloadFinishedHandler));\n  }\n\n  public configure(maxRequests: number) {\n    this._maxRequests = maxRequests;\n    this._httpRequestQueue.limit(maxRequests);\n  }\n\n  public disable() {\n    this.subscribables.forEach((subscribable) => subscribable.unsubscribe(this.onDownloadFinishedHandler));\n    this._httpRequestQueue.clear();\n  }\n\n  public reset() {\n    this._httpRequestQueue.clear();\n  }\n\n  private onDownloadFinishedHandler = (event: OnDownloadFinishedEventObject) => {\n    try {\n      logger.log(`HttpRequestTracking.onDownloadFinished: ${JSON.stringify(event.httpRequest)}`);\n      this.addRequest(event.httpRequest);\n    } catch (error) {\n      logger.error(`HttpRequestTracking.onDownloadFinished: Error in handler`, error);\n    }\n  };\n\n  private addRequest(httpRequest: HttpRequest) {\n    this._httpRequestQueue.offer(httpRequest);\n    this._httpRequestQueue.limit(this._maxRequests);\n  }\n}\n","export class Queue<T> {\n  private readonly _items: T[] = [];\n\n  public get items(): ReadonlyArray<T> {\n    return this._items;\n  }\n\n  public get length() {\n    return this._items.length;\n  }\n\n  public offer(item: T) {\n    this._items.push(item);\n  }\n\n  public poll(): T | undefined {\n    return this._items.shift();\n  }\n\n  public clear() {\n    this._items.splice(0);\n  }\n\n  public limit(maxElements: number) {\n    while (this._items.length > maxElements) {\n      this.poll();\n    }\n  }\n}\n","import {PlayerAPI, UserInteractionEvent} from 'bitmovin-player';\nimport {AdCallbacks, AdModuleAPI} from './AdModuleAPI';\n\nexport class Bitmovin8AdModule implements AdModuleAPI {\n  public adCallbacks = new AdCallbacks();\n\n  constructor(private player: PlayerAPI) {\n    this.register();\n  }\n\n  public isLinearAdActive = () => {\n    if (this.player.ads) {\n      return (this.player.ads as any).isLinearAdActive() || false;\n    }\n    return false;\n  };\n  public getContainer = () => this.player.getContainer();\n  public getAdModuleInfo = () => {\n    if (this.player.ads) {\n      return (this.player.ads as any).getModuleInfo();\n    }\n    return {name: undefined, version: undefined};\n  };\n  public currentTime = () => this.player.getCurrentTime();\n\n  private register() {\n    this.player.on(this.player.exports.PlayerEvent.Play, (e: UserInteractionEvent) => {\n      if (e.issuer === 'advertising-api') {\n        this.adCallbacks.onPlay(e.issuer);\n      }\n    });\n    this.player.on(this.player.exports.PlayerEvent.Paused, (e: UserInteractionEvent) => {\n      if (e.issuer === 'advertising-api') {\n        this.adCallbacks.onPause(e.issuer);\n      }\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdStarted, (event: any) => {\n      this.adCallbacks.onAdStarted(event);\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdFinished, (event: any) => {\n      this.adCallbacks.onAdFinished(event);\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdBreakStarted, (event: any) => {\n      this.adCallbacks.onAdBreakStarted(event);\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdBreakFinished, (event: any) => {\n      this.adCallbacks.onAdBreakFinished(event);\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdClicked, (event: any) => {\n      this.adCallbacks.onAdClicked(event);\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdQuartile, (event: any) => {\n      this.adCallbacks.onAdQuartile(event);\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdSkipped, (event: any) => {\n      this.adCallbacks.onAdSkipped(event);\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdError, (event: any) => {\n      this.adCallbacks.onAdError(event);\n    });\n    this.player.on(this.player.exports.PlayerEvent.AdManifestLoaded, (event: any) => {\n      this.adCallbacks.onAdManifestLoaded(event);\n    });\n    const handlePageClose = () => {\n      this.adCallbacks.onBeforeUnload();\n    };\n    window.addEventListener('beforeunload', handlePageClose);\n    window.addEventListener('unload', handlePageClose);\n  }\n}\n","export class AdCallbacks {\n  public onAdStarted = (event: any) => {};\n  public onAdFinished = (event: any) => {};\n  public onAdBreakStarted = (event: any) => {};\n  public onAdBreakFinished = (event: any) => {};\n  public onAdClicked = (event: any) => {};\n  public onAdError = (event: any) => {};\n  public onAdManifestLoaded = (event: any) => {};\n  public onAdQuartile = (event: any) => {};\n  public onAdSkipped = (event: any) => {};\n  public onPlay = (issuer?: string) => {};\n  public onPause = (issuer?: string) => {};\n  public onBeforeUnload = () => {};\n}\n\nexport interface AdModuleAPI {\n  readonly adCallbacks: AdCallbacks;\n  isLinearAdActive: () => boolean;\n  getContainer: () => HTMLElement;\n  getAdModuleInfo: () => {name?: string; version?: string};\n  currentTime: () => number;\n}\n","import {DownloadFinishedEvent, PlayerAPI, PlayerExports} from 'bitmovin-player';\nimport {EventDispatcher, Subscribable} from '../../core/EventDispatcher';\nimport {HttpRequestType} from '../../features/httprequesttracking/HttpRequestType';\nimport {OnDownloadFinishedEventObject} from '../../features/httprequesttracking/OnDownloadFinishedEventObject';\nimport {calculateTimeWithUndefined, getCurrentTimestamp} from '../../utils/Utils';\n\nexport class Bitmovin8HttpRequestTrackingAdapter implements Subscribable<OnDownloadFinishedEventObject> {\n  private eventDispatcher = new EventDispatcher<OnDownloadFinishedEventObject>();\n  private playerExports: PlayerExports;\n\n  constructor(player: PlayerAPI) {\n    this.playerExports = player.exports;\n    player.on(this.playerExports.PlayerEvent.DownloadFinished, (event) =>\n      this.onDownloadFinished(event as DownloadFinishedEvent)\n    );\n  }\n\n  public subscribe(callback: (args: OnDownloadFinishedEventObject) => void): () => void {\n    return this.eventDispatcher.subscribe(callback);\n  }\n\n  public unsubscribe(callback: (args: OnDownloadFinishedEventObject) => void) {\n    this.eventDispatcher.unsubscribe(callback);\n  }\n\n  private onDownloadFinished(event?: DownloadFinishedEvent) {\n    this.eventDispatcher.dispatch({\n      httpRequest: {\n        downloadTime: calculateTimeWithUndefined(event?.downloadTime) ?? 0,\n        httpStatus: event?.httpStatus ?? 0,\n        success: event?.success ?? false,\n        timestamp: getCurrentTimestamp(),\n        url: event?.url,\n        size: event?.size,\n        timeToFirstByte: calculateTimeWithUndefined(event?.timeToFirstByte),\n        type: this.mapHttpRequestType(event?.downloadType),\n      },\n    });\n  }\n\n  private mapHttpRequestType(downloadType?: string): HttpRequestType {\n    switch (downloadType) {\n      case this.playerExports.HttpRequestType.MANIFEST_DASH:\n        return HttpRequestType.MANIFEST_DASH;\n      case this.playerExports.HttpRequestType.MANIFEST_HLS_MASTER:\n        return HttpRequestType.MANIFEST_HLS_MASTER;\n      case this.playerExports.HttpRequestType.MANIFEST_HLS_VARIANT:\n        return HttpRequestType.MANIFEST_HLS_VARIANT;\n      case this.playerExports.HttpRequestType.MANIFEST_SMOOTH:\n        return HttpRequestType.MANIFEST_SMOOTH;\n      case this.playerExports.HttpRequestType.MANIFEST_ADS:\n        return HttpRequestType.MANIFEST_ADS;\n      case this.playerExports.HttpRequestType.MEDIA_AUDIO:\n        return HttpRequestType.MEDIA_AUDIO;\n      case this.playerExports.HttpRequestType.MEDIA_VIDEO:\n        return HttpRequestType.MEDIA_VIDEO;\n      case this.playerExports.HttpRequestType.MEDIA_SUBTITLES:\n        return HttpRequestType.MEDIA_SUBTITLES;\n      case this.playerExports.HttpRequestType.MEDIA_THUMBNAILS:\n        return HttpRequestType.MEDIA_THUMBNAILS;\n      case this.playerExports.HttpRequestType.DRM_LICENSE_WIDEVINE:\n        return HttpRequestType.DRM_LICENSE_WIDEVINE;\n      case this.playerExports.HttpRequestType.DRM_LICENSE_PLAYREADY:\n        return HttpRequestType.DRM_LICENSE_PLAYREADY;\n      case this.playerExports.HttpRequestType.DRM_LICENSE_FAIRPLAY:\n        return HttpRequestType.DRM_LICENSE_FAIRPLAY;\n      case this.playerExports.HttpRequestType.DRM_LICENSE_PRIMETIME:\n        return HttpRequestType.DRM_LICENSE_PRIMETIME;\n      case this.playerExports.HttpRequestType.DRM_LICENSE_CLEARKEY:\n        return HttpRequestType.DRM_LICENSE_CLEARKEY;\n      case this.playerExports.HttpRequestType.DRM_CERTIFICATE_FAIRPLAY:\n        return HttpRequestType.DRM_CERTIFICATE_FAIRPLAY;\n      case this.playerExports.HttpRequestType.KEY_HLS_AES:\n        return HttpRequestType.KEY_HLS_AES;\n      case this.playerExports.HttpRequestType.TIME_SYNC:\n        return HttpRequestType.TIME_SYNC;\n      default:\n        return HttpRequestType.UNKNOWN;\n    }\n  }\n}\n","export enum HttpRequestType {\n  DRM_LICENSE_WIDEVINE = 'DRM_LICENSE_WIDEVINE',\n  DRM_OTHER = 'DRM_OTHER',\n  MEDIA_THUMBNAILS = 'MEDIA_THUMBNAILS',\n  MEDIA_VIDEO = 'MEDIA_VIDEO',\n  MEDIA_AUDIO = 'MEDIA_AUDIO',\n  MEDIA_PROGRESSIVE = 'MEDIA_PROGRESSIVE',\n  MEDIA_SUBTITLES = 'MEDIA_SUBTITLES',\n  MANIFEST_DASH = 'MANIFEST_DASH',\n  MANIFEST_HLS = 'MANIFEST_HLS',\n  MANIFEST_HLS_MASTER = 'MANIFEST_HLS_MASTER',\n  MANIFEST_HLS_VARIANT = 'DRM_LICENSMANIFEST_HLS_VARIANTE_WIDEVINE',\n  MANIFEST_SMOOTH = 'MANIFEST_SMOOTH',\n  MANIFEST = 'MANIFEST',\n  KEY_HLS_AES = 'KEY_HLS_AES',\n  UNKNOWN = 'UNKNOWN',\n  TIME_SYNC = 'TIME_SYNC',\n  DRM_CERTIFICATE_FAIRPLAY = 'DRM_CERTIFICATE_FAIRPLAY',\n  DRM_LICENSE_CLEARKEY = 'DRM_LICENSE_CLEARKEY',\n  DRM_LICENSE_PRIMETIME = 'DRM_LICENSE_PRIMETIME',\n  DRM_LICENSE_FAIRPLAY = 'DRM_LICENSE_FAIRPLAY',\n  DRM_LICENSE_PLAYREADY = 'DRM_LICENSE_PLAYREADY',\n  MANIFEST_ADS = 'MANIFEST_ADS',\n}\n","import {PlayerAPI} from 'bitmovin-player';\nimport {SegmentTracker} from '../../core/SegmentTracker';\nimport {SegmentInfo} from '../../types/SegmentInfo';\nimport * as Utils from '../../utils/Utils';\n\ninterface DownloadFinishedEvent {\n  attempt?: number;\n  downloadType?: string;\n  httpStatus: number;\n  mimeType?: string;\n  success: boolean;\n  timestamp: number;\n  type: string;\n  url: string;\n}\n\ninterface SegmentPlaybackEvent {\n  duration?: number;\n  mediaInfo?: any;\n  mimeType?: string;\n  playbackTime?: number;\n  representationId?: string;\n  timestamp?: number;\n  type?: string;\n  uid?: string;\n  url?: string;\n}\n\nexport class Bitmovin8SegmentTrackerAdapter {\n  private segmentTracker: SegmentTracker;\n\n  constructor(player: PlayerAPI, segmentTracker: SegmentTracker) {\n    this.segmentTracker = segmentTracker;\n\n    player.on(player.exports.PlayerEvent.DownloadFinished, (event) => this.handleOnDownloadFinishEvent(event));\n    player.on(player.exports.PlayerEvent.SegmentPlayback, (event) => this.handleSegmentPlaybackEvent(event));\n  }\n\n  public getSegmentTracker(): SegmentTracker {\n    return this.segmentTracker;\n  }\n\n  public handleOnDownloadFinishEvent(event: DownloadFinishedEvent & any) {\n    if (event.downloadType.indexOf('media/video') === 0) {\n      const url = event.url;\n      const segment: SegmentInfo = {\n        name: Utils.getURLResourceName(url),\n        url,\n        timestamp: event.timestamp,\n      };\n      this.segmentTracker.addSegment(segment);\n    }\n  }\n\n  public handleSegmentPlaybackEvent = (event: SegmentPlaybackEvent & any) => {\n    this.segmentTracker.removeSegment(event.url);\n  };\n}\n","import {PlayerAPI} from 'bitmovin-player';\nimport {DownloadSpeedMeter} from '../../core/DownloadSpeedMeter';\n\nexport class Bitmovin8SpeedMeterAdapter {\n  private meter: DownloadSpeedMeter;\n\n  constructor(player: PlayerAPI, meter: DownloadSpeedMeter) {\n    this.meter = meter;\n    player.on(player.exports.PlayerEvent.DownloadFinished, (event) => this.handleOnDownloadFinishEvent(event));\n  }\n\n  public getDownloadSpeedMeter(): DownloadSpeedMeter {\n    return this.meter;\n  }\n\n  public handleOnDownloadFinishEvent(event: any) {\n    if (!event.success) {\n      return;\n    }\n    if (event.downloadType.indexOf('media/video') === 0) {\n      this.meter.addMeasurement({\n        duration: event.downloadTime,\n        size: event.size,\n        timeToFirstByte: event.timeToFirstByte,\n        timestamp: new Date(),\n        httpStatus: event.httpStatus,\n      });\n    }\n  }\n}\n","import {AdapterAPI} from '../api/AdapterAPI';\nimport {Analytics} from '../core/Analytics';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {logger} from '../utils/Logger';\nimport {Adapter} from './Adapter';\nimport {CAFv3InternalAdapter} from './internal/CAFv3InternalAdapter';\n\nexport class CAFv3Adapter extends Adapter implements AdapterAPI {\n  constructor(config: AnalyticsConfig, player: any, opts?: AnalyticsStateMachineOptions) {\n    super();\n    if (this.hasPlayerAlreadyBeenAugmented(player)) {\n      logger.errorMessageToUser('Bitmovin Analytics is already hooked up to this player instance');\n      return;\n    }\n    this.markPlayerInstanceAsAugmented(player);\n    this.internalAdapter = new CAFv3InternalAdapter(player, opts);\n    this.analytics = new Analytics(config, this.internalAdapter);\n  }\n}\n","import {HTML5AnalyticsStateMachine} from '../../analyticsStateMachines/HTML5AnalyticsStateMachine';\nimport {Analytics} from '../../core/Analytics';\nimport {Event} from '../../enums/Event';\nimport {Player} from '../../enums/Player';\nimport {ErrorDetailBackend} from '../../features/errordetails/ErrorDetailBackend';\nimport {ErrorDetailTracking} from '../../features/errordetails/ErrorDetailTracking';\nimport {Feature} from '../../features/Feature';\nimport {FeatureConfig} from '../../features/FeatureConfig';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {DrmPerformanceInfo} from '../../types/DrmPerformanceInfo';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {PlaybackInfo} from '../../types/PlaybackInfo';\nimport {InternalAdapter} from './InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nexport class CAFv3InternalAdapter extends InternalAdapter implements InternalAdapterAPI {\n  private playerManager;\n  private queueManager;\n  private mediaInformation;\n  private activeAudioTrack;\n  private activeTextTracks;\n  private currentItem;\n  private currentItemIndex = 0;\n  private isSeeking: boolean;\n\n  constructor(protected context: any, opts?: AnalyticsStateMachineOptions) {\n    super(opts);\n    this.stateMachine = new HTML5AnalyticsStateMachine(this.stateMachineCallbacks, this.opts);\n    this.playerManager = context.getPlayerManager();\n    this.queueManager = context.getPlayerManager().getQueueManager();\n    this.isSeeking = false;\n  }\n\n  public initialize(analytics: Analytics): Array<Feature<FeatureConfigContainer, FeatureConfig>> {\n    this.register();\n    const errorDetailTracking = new ErrorDetailTracking(\n      analytics.errorDetailTrackingSettingsProvider,\n      new ErrorDetailBackend(analytics.errorDetailTrackingSettingsProvider.collectorConfig),\n      [analytics.errorDetailSubscribable],\n      undefined\n    );\n    return [errorDetailTracking];\n  }\n\n  public getPlayerVersion(): string {\n    return (window as any).cast && (window as any).cast.framework ? (window as any).cast.framework.VERSION : 'unknown';\n  }\n\n  public getPlayerName = () => Player.CHROMECAST_SHAKA;\n  public getPlayerTech = () => 'html5';\n  public getAutoPlay = () => (this.currentItem && this.currentItem.autoplay ? this.currentItem.autoplay : false);\n  public getDrmPerformanceInfo = (): DrmPerformanceInfo | undefined => this.drmPerformanceInfo;\n\n  public sourceChange(config: any, timestamp: number) {\n    this.stateMachine.sourceChange(config, timestamp, this.playerManager.getCurrentTimeSec());\n  }\n\n  public getCurrentPlaybackInfo(): PlaybackInfo {\n    const stats = (this.playerManager as any).getStats();\n\n    const info: PlaybackInfo = {\n      isLive: this.mediaInformation ? this.mediaInformation.streamType === 'LIVE' : undefined,\n      playerTech: this.getPlayerTech(),\n      videoDuration: this.mediaInformation ? this.mediaInformation.duration : undefined,\n      videoPlaybackHeight: stats.height,\n      videoPlaybackWidth: stats.width,\n      audioCodec: this.activeAudioTrack ? this.activeAudioTrack.trackContentType : undefined,\n      audioLanguage: this.activeAudioTrack ? this.activeAudioTrack.language : undefined,\n      subtitleLanguage: this.activeTextTracks ? this.activeTextTracks.map((t) => t.language).join(',') : undefined,\n      droppedFrames: 0, // TODO\n    };\n\n    return info;\n  }\n\n  public register() {\n    this.playerManager.addEventListener('PLAYER_LOAD_COMPLETE', (event) => {\n      const audioTracksManager = this.playerManager.getAudioTracksManager();\n      this.activeAudioTrack = audioTracksManager.getActiveTrack();\n\n      // captions\n      const textTracksManager = this.playerManager.getTextTracksManager();\n      this.activeTextTracks = textTracksManager.getActiveTracks();\n\n      const queueManager = this.playerManager.getQueueManager();\n      this.currentItem = queueManager.getCurrentItem();\n\n      this.mediaInformation = event.media;\n\n      this.eventCallback(Event.READY, {});\n    });\n\n    this.playerManager.addEventListener('PLAY', (event) => {\n      this.eventCallback(Event.PLAY, {\n        currentTime: event.currentMediaTime,\n      });\n    });\n\n    this.playerManager.addEventListener('PAUSE', (event) => {\n      this.onPaused(this.playerManager.getCurrentTimeSec());\n    });\n\n    this.playerManager.addEventListener('ERROR', (event) => {\n      const errorData = event.error != null ? JSON.stringify(event.error) : undefined;\n      this.eventCallback(Event.ERROR, {\n        currentTime: this.playerManager.getCurrentTimeSec(),\n        code: event.detailedErrorCode,\n        message: event.reason,\n        legacyData: errorData,\n        data: {additionalData: errorData},\n      });\n    });\n\n    this.playerManager.addEventListener('SEEKING', (event) => {\n      this.isSeeking = true;\n      this.onPaused(event.currentMediaTime);\n      this.eventCallback(Event.SEEK, {\n        currentTime: event.currentMediaTime,\n      });\n    });\n\n    this.playerManager.addEventListener('SEEKED', (event) => {\n      this.isSeeking = false;\n      this.eventCallback(Event.SEEKED, {\n        currentTime: event.currentMediaTime,\n      });\n    });\n\n    // Fired when the browser is trying to fetch media data,\n    // but did not receive a response. The cast.framework.events.EventType.BUFFERING\n    // event is implemented consistently across stream types, and should be used instead\n    // of 'stalled' when trying to check if the player is buffering.\n    this.playerManager.addEventListener('STALLED', (event) => {});\n\n    this.playerManager.addEventListener('BUFFERING', (event) => {\n      if (!this.isSeeking && event.isBuffering) {\n        this.eventCallback(Event.START_BUFFERING, {\n          currentTime: this.currentTime,\n        });\n      }\n    });\n\n    this.playerManager.addEventListener('TIME_UPDATE', (event) => {\n      if (!this.isSeeking) {\n        this.eventCallback(Event.TIMECHANGED, {\n          currentTime: event.currentMediaTime,\n        });\n      }\n    });\n\n    this.playerManager.addEventListener('REQUEST_LOAD', (event) => {\n      if (this.queueManager.getCurrentItemIndex() !== this.currentItemIndex) {\n        this.currentItemIndex++;\n        this.eventCallback(Event.PLAYLIST_TRANSITION, {\n          currentTime: this.playerManager.getCurrentTimeSec(),\n        });\n      }\n    });\n  }\n\n  public onPaused(currentTime?: number) {\n    this.eventCallback(Event.PAUSE, {\n      currentTime,\n    });\n  }\n  protected get currentTime(): number {\n    return this.playerManager.getCurrentTimeSec();\n  }\n}\n","import {AdapterAPI} from '../api/AdapterAPI';\nimport {Analytics} from '../core/Analytics';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {logger} from '../utils/Logger';\nimport {Adapter} from './Adapter';\nimport {DashjsInternalAdapter} from './internal/DashjsInternalAdapter';\n\nexport class DashjsAdapter extends Adapter implements AdapterAPI {\n  constructor(config: AnalyticsConfig, player: any, opts?: AnalyticsStateMachineOptions) {\n    super();\n    if (this.hasPlayerAlreadyBeenAugmented(player)) {\n      logger.errorMessageToUser('Bitmovin Analytics is already hooked up to this player instance');\n      return;\n    }\n    this.markPlayerInstanceAsAugmented(player);\n    this.internalAdapter = new DashjsInternalAdapter(player, opts);\n    this.analytics = new Analytics(config, this.internalAdapter);\n  }\n}\n","import {Analytics} from '../../core/Analytics';\nimport {Event} from '../../enums/Event';\nimport {MIMETypes} from '../../enums/MIMETypes';\nimport {Player} from '../../enums/Player';\nimport {ErrorDetailBackend} from '../../features/errordetails/ErrorDetailBackend';\nimport {ErrorDetailTracking} from '../../features/errordetails/ErrorDetailTracking';\nimport {Feature} from '../../features/Feature';\nimport {FeatureConfig} from '../../features/FeatureConfig';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {QualityLevelInfo} from '../../types/QualityLevelInfo';\nimport {HTML5InternalAdapter} from './HTML5InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nexport class DashjsInternalAdapter extends HTML5InternalAdapter implements InternalAdapterAPI {\n  constructor(private mediaPlayer: any, opts?: AnalyticsStateMachineOptions) {\n    super(null, opts);\n  }\n\n  /**\n   * @override\n   */\n  public initialize(analytics: Analytics): Array<Feature<FeatureConfigContainer, FeatureConfig>> {\n    super.initialize(analytics);\n    let videoEl: HTMLVideoElement | null = null;\n    let canPlay = false;\n    try {\n      videoEl = this.mediaPlayer.getVideoElement();\n    } catch (e) {} // tslint:disable-line:no-empty\n\n    if (!videoEl) {\n      this.mediaPlayer.on(\n        'canPlay',\n        () => {\n          if (canPlay) {\n            return;\n          }\n          videoEl = this.mediaPlayer.getVideoElement();\n          canPlay = true;\n          this.setMediaElement(videoEl);\n          this.registerMediaElementEventsForDashJS();\n        },\n        this\n      );\n    } else {\n      this.setMediaElement(videoEl);\n      this.registerMediaElementEventsForDashJS();\n    }\n    const errorDetailTracking = new ErrorDetailTracking(\n      analytics.errorDetailTrackingSettingsProvider,\n      new ErrorDetailBackend(analytics.errorDetailTrackingSettingsProvider.collectorConfig),\n      [analytics.errorDetailSubscribable],\n      undefined\n    );\n    return [errorDetailTracking];\n  }\n\n  public registerMediaElementEventsForDashJS() {\n    const mediaElement = this.mediaElement;\n\n    if (!mediaElement) {\n      return;\n    }\n\n    this.listenToMediaElementEvent('playing', () => {\n      const {currentTime} = mediaElement;\n      this.needsFirstPlayIntent = false;\n      this.eventCallback(Event.TIMECHANGED, {\n        currentTime,\n      });\n    });\n  }\n\n  public getPlayerName = () => Player.DASHJS;\n  public getPlayerVersion = () => this.mediaPlayer.getVersion();\n\n  /**\n   * @override\n   */\n  public getMIMEType() {\n    return MIMETypes.DASH;\n  }\n  /**\n   * @override\n   */\n  public getStreamURL(): string | undefined {\n    if (!this.mediaPlayer) {\n      return;\n    }\n\n    const source = this.mediaPlayer.getSource();\n    if (source) {\n      return source.toString();\n    }\n  }\n  /**\n   * Implemented by sub-class to deliver current quality-level info\n   * specific to media-engine.\n   * @override\n   * @returns {QualityLevelInfo}\n   */\n  public getCurrentQualityLevelInfo(): QualityLevelInfo | null {\n    if (!this.mediaPlayer) {\n      return null;\n    }\n\n    const videoBitrateInfoList = this.mediaPlayer.getBitrateInfoListFor('video');\n    const currentVideoQualityIndex = this.mediaPlayer.getQualityFor('video');\n    const currentVideoQuality = videoBitrateInfoList[currentVideoQualityIndex];\n\n    if (currentVideoQuality == null) {\n      return null;\n    }\n\n    const {width, height, bitrate} = currentVideoQuality;\n    return {\n      width,\n      height,\n      bitrate,\n    };\n  }\n}\n","import {AdapterAPI} from '../api/AdapterAPI';\nimport {Analytics} from '../core/Analytics';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {logger} from '../utils/Logger';\nimport {Adapter} from './Adapter';\nimport {HlsInternalAdapter} from './internal/HlsInternalAdapter';\n\nexport class HlsAdapter extends Adapter implements AdapterAPI {\n  constructor(config: AnalyticsConfig, player: any, opts?: AnalyticsStateMachineOptions) {\n    super();\n    if (this.hasPlayerAlreadyBeenAugmented(player)) {\n      logger.errorMessageToUser('Bitmovin Analytics is already hooked up to this player instance');\n      return;\n    }\n    this.markPlayerInstanceAsAugmented(player);\n    this.internalAdapter = new HlsInternalAdapter(player, opts);\n    this.analytics = new Analytics(config, this.internalAdapter);\n  }\n}\n","import {Analytics} from '../../core/Analytics';\nimport {DownloadSpeedMeter} from '../../core/DownloadSpeedMeter';\nimport {Event} from '../../enums/Event';\nimport {MIMETypes} from '../../enums/MIMETypes';\nimport {Player} from '../../enums/Player';\nimport {ErrorDetailBackend} from '../../features/errordetails/ErrorDetailBackend';\nimport {ErrorDetailTracking} from '../../features/errordetails/ErrorDetailTracking';\nimport {Feature} from '../../features/Feature';\nimport {FeatureConfig} from '../../features/FeatureConfig';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {DownloadSpeedInfo} from '../../types/DownloadSpeedInfo';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {PlaybackInfo} from '../../types/PlaybackInfo';\nimport {QualityLevelInfo} from '../../types/QualityLevelInfo';\nimport {SubtitleInfo} from '../../types/SubtitleInfo';\nimport {HlsSpeedMeterAdapter} from './HlsSpeedMeterAdapter';\nimport {HTML5InternalAdapter} from './HTML5InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nexport class HlsInternalAdapter extends HTML5InternalAdapter implements InternalAdapterAPI {\n  get downloadSpeedInfo(): DownloadSpeedInfo {\n    return this.speedMeter.getInfo();\n  }\n\n  private speedMeter: DownloadSpeedMeter;\n\n  constructor(private hls: Hls, opts?: AnalyticsStateMachineOptions) {\n    super(null, opts);\n    this.resetMedia();\n    this.speedMeter = new HlsSpeedMeterAdapter(hls, new DownloadSpeedMeter()).getDownloadSpeedMeter();\n  }\n\n  public initialize(analytics: Analytics): Array<Feature<FeatureConfigContainer, FeatureConfig>> {\n    super.initialize(analytics);\n    this.registerHlsEvents();\n    const errorDetailTracking = new ErrorDetailTracking(\n      analytics.errorDetailTrackingSettingsProvider,\n      new ErrorDetailBackend(analytics.errorDetailTrackingSettingsProvider.collectorConfig),\n      [analytics.errorDetailSubscribable],\n      undefined\n    );\n    return [errorDetailTracking];\n  }\n\n  public clearValues(): void {\n    this.speedMeter.reset();\n  }\n\n  public getPlayerName = () => Player.HLSJS;\n  public getPlayerVersion = () => (this.hls as any).constructor.version;\n\n  public getCurrentQualityLevelInfo(): QualityLevelInfo | null {\n    if (!this.hls.levels) {\n      return null;\n    }\n    const currentLevelObj = this.hls.levels[this.hls.currentLevel];\n    if (!currentLevelObj) {\n      return null;\n    }\n\n    const bitrate = currentLevelObj.bitrate;\n    const width = currentLevelObj.width;\n    const height = currentLevelObj.height;\n\n    return {\n      bitrate,\n      width,\n      height,\n    };\n  }\n\n  /**\n   * @override\n   */\n  public isLive = () => {\n    const hls = this.hls;\n    if (!hls.levels || !hls.currentLevel) {\n      return false;\n    }\n    if (hls.currentLevel < 0) {\n      return false;\n    }\n    const currentLevelObj = hls.levels[hls.currentLevel];\n    if (!currentLevelObj) {\n      return false;\n    }\n    return currentLevelObj.details.live;\n  };\n\n  /**\n   * @override\n   */\n  public getMIMEType() {\n    return MIMETypes.HLS;\n  }\n\n  /**\n   * @override\n   */\n  public getStreamURL() {\n    // @ts-ignore\n    return this.hls.url;\n  }\n\n  public registerHlsEvents() {\n    const hls = this.hls as any;\n\n    hls.on(hls.constructor.Events.MEDIA_ATTACHING, this.onMediaAttaching.bind(this));\n    hls.on(hls.constructor.Events.MEDIA_DETACHING, this.onMediaDetaching.bind(this));\n    hls.on(hls.constructor.Events.MANIFEST_LOADING, this.onManifestLoading.bind(this));\n    hls.on(hls.constructor.Events.AUDIO_TRACK_SWITCHED, this.onAudioTrackSwitched.bind(this));\n    hls.on(hls.constructor.Events.SUBTITLE_TRACK_SWITCH, this.onSubtitleLanguageSwitched.bind(this));\n    hls.on(hls.constructor.Events.DESTROYING, this.release.bind(this));\n    hls.on(hls.constructor.Events.ERROR, this.onHlsError.bind(this));\n\n    // media is already attached, event has been triggered before\n    // or we are in the event handler of this event itself.\n    // we can not know how the stacktrace to this constructor will look like.\n    // therefore we will guard from this case in\n    // the onMediaAttaching method (avoid running it twice)\n    if (hls.media) {\n      this.onMediaAttaching();\n      this.onManifestLoading();\n    }\n  }\n\n  public onMediaAttaching() {\n    // in case we are called again (when we are triggering this ourselves\n    // but from the event handler of MEDIA_ATTACHING) we should not run again.\n    if (this.mediaElement) {\n      return;\n    }\n\n    this.mediaElement = this.hls.media;\n\n    this.registerMediaElement();\n    this.onMaybeReady();\n  }\n\n  public onMediaDetaching() {\n    this.unregisterMediaElement();\n  }\n\n  public onManifestLoading() {\n    this.onMaybeReady();\n  }\n\n  public getCurrentPlaybackInfo(): PlaybackInfo {\n    const selectedSubtitle = this.getSelectedSubtitleLanguage();\n\n    const info: PlaybackInfo = {\n      ...super.getCurrentPlaybackInfo(),\n      audioLanguage: this.getSelectedAudioLanguage(),\n      subtitleEnabled: selectedSubtitle != null ? selectedSubtitle.enabled : undefined,\n      subtitleLanguage: selectedSubtitle != null ? selectedSubtitle.language : undefined,\n    };\n\n    return info;\n  }\n\n  /**\n   * errorData: { type : error type, details : error details, fatal : if true, hls.js cannot/will not try to recover, if false, hls.js will try to recover,other error specific data }\n   * https://hls-js.netlify.com/api-docs/file/src/events.js.html#lineNumber98\n   */\n  public onHlsError(errorName, errorData) {\n    const isFatal = errorData ? errorData.fatal : true;\n    if (isFatal) {\n      const mediaElement = this.mediaElement;\n      let currentTime;\n      if (mediaElement != null) {\n        currentTime = mediaElement.currentTime;\n      }\n\n      const errorMessage = errorData != null ? `${errorData.type}: ${errorData.details}` : undefined;\n      this.eventCallback(Event.ERROR, {\n        currentTime,\n        code: this.getErrorCodeFromHlsErrorType(errorData.type),\n        message: errorMessage,\n        data: {},\n      });\n    }\n  }\n\n  public onAudioTrackSwitched(event: string, data: {id: string}) {\n    const mediaElement = this.mediaElement;\n    let currentTime;\n    if (mediaElement != null) {\n      currentTime = mediaElement.currentTime;\n    }\n\n    this.eventCallback(Event.AUDIOTRACK_CHANGED, {\n      currentTime,\n    });\n  }\n\n  public onSubtitleLanguageSwitched(event: string, data: {id: string}) {\n    const mediaElement = this.mediaElement;\n    let currentTime;\n    if (mediaElement != null) {\n      currentTime = mediaElement.currentTime;\n    }\n\n    this.eventCallback(Event.SUBTITLE_CHANGE, {\n      currentTime,\n    });\n  }\n\n  /**\n   * returns mapped error code for Hlsjs ErrorTypes\n   * @param type one of the ErrorTypes according to https://github.com/video-dev/hls.js/blob/master/src/errors.ts\n   */\n  private getErrorCodeFromHlsErrorType(type: string): number {\n    switch (type) {\n      case 'networkError':\n        return 2;\n      case 'mediaError':\n        return 3;\n      case 'keySystemError':\n        return 4;\n      case 'muxError':\n        return 5;\n      // default equals `otherError`\n      default:\n        return 1;\n    }\n  }\n\n  private getSelectedAudioLanguage(): string | undefined {\n    if (this.hls.audioTrack == null || this.hls.audioTrack < 0) {\n      return undefined;\n    }\n    return (this.hls.audioTracks[this.hls.audioTrack] as any).lang;\n  }\n\n  private getSelectedSubtitleLanguage(): SubtitleInfo | undefined {\n    // Check if function is supported (in latest hls version), otherwise use fallback option\n    if (this.hls.subtitleDisplay != null) {\n      const isSubtitleDisplayed = this.hls.subtitleTrack >= 0 && this.hls.subtitleDisplay === true;\n      return {\n        enabled: isSubtitleDisplayed,\n        language: isSubtitleDisplayed ? this.hls.subtitleTracks[this.hls.subtitleTrack].lang : undefined,\n      };\n    } else {\n      const {subtitleTrackController} = this.hls as any;\n      if (subtitleTrackController != null && subtitleTrackController.media != null) {\n        return this.getSelectedSubtitleFromMediaElement(subtitleTrackController.media);\n      }\n    }\n    return undefined;\n  }\n}\n","import {DownloadSpeedMeter} from '../../core/DownloadSpeedMeter';\n\nexport class HlsSpeedMeterAdapter {\n  private meter: DownloadSpeedMeter;\n\n  constructor(hls: any, meter: DownloadSpeedMeter) {\n    this.meter = meter;\n    hls.on(hls.constructor.Events.FRAG_LOADED, (eventName, data) => this.handleFragmentLoadedEvent(data));\n  }\n\n  public getDownloadSpeedMeter(): DownloadSpeedMeter {\n    return this.meter;\n  }\n\n  public handleFragmentLoadedEvent(data: {frag: any; stats: any; networkDetails: any}) {\n    if (data.frag.type !== 'main') {\n      return;\n    }\n    // See hls documentation https://github.com/video-dev/hls.js/blob/master/src/types/loader.ts#L35\n    this.meter.addMeasurement({\n      duration: (data.stats.tload - data.stats.trequest) / 1000,\n      size: data.stats.total,\n      timeToFirstByte: (data.stats.tfirst - data.stats.trequest) / 1000,\n      timestamp: new Date(),\n      httpStatus: data.networkDetails.status,\n    });\n  }\n}\n","import {AdapterAPI} from '../api/AdapterAPI';\nimport {Analytics} from '../core/Analytics';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {logger} from '../utils/Logger';\nimport {Adapter} from './Adapter';\nimport {HTMLVideoElementInternalAdapter} from './internal/HTMLVideoElementInternalAdapter';\n\nexport class HTMLVideoElementAdapter extends Adapter implements AdapterAPI {\n  constructor(config: AnalyticsConfig, player: HTMLVideoElement, opts?: AnalyticsStateMachineOptions) {\n    super();\n    if (this.hasPlayerAlreadyBeenAugmented(player)) {\n      logger.errorMessageToUser('Bitmovin Analytics is already hooked up to this player instance');\n      return;\n    }\n    this.markPlayerInstanceAsAugmented(player);\n    this.internalAdapter = new HTMLVideoElementInternalAdapter(player, opts);\n    this.analytics = new Analytics(config, this.internalAdapter);\n  }\n}\n","import {Player} from '../../enums/Player';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {QualityLevelInfo} from '../../types/QualityLevelInfo';\nimport {getBrowserInfo} from '../../utils/Utils';\nimport {HTML5InternalAdapter} from './HTML5InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nexport class HTMLVideoElementInternalAdapter extends HTML5InternalAdapter implements InternalAdapterAPI {\n  constructor(mediaElement: HTMLVideoElement, opts?: AnalyticsStateMachineOptions) {\n    super(mediaElement, opts);\n  }\n\n  public getPlayerName = () => Player.HTML5;\n  public getPlayerVersion = () => {\n    const browserInfo = getBrowserInfo();\n    return `${browserInfo.name} ${browserInfo.version}`;\n  };\n  /**\n   * @override\n   */\n  public getStreamURL() {\n    return this.mediaElement ? this.mediaElement.currentSrc : undefined;\n  }\n\n  /**\n   * Implemented by sub-class to deliver current quality-level info\n   * specific to media-engine.\n   * @override\n   * @returns {QualityLevelInfo}\n   */\n  public getCurrentQualityLevelInfo(): QualityLevelInfo | null {\n    return {\n      bitrate: undefined,\n      width: this.mediaElement ? this.mediaElement.videoWidth : undefined,\n      height: this.mediaElement ? this.mediaElement.videoHeight : undefined,\n    };\n  }\n}\n","import {AdapterAPI} from '../api/AdapterAPI';\nimport {Analytics} from '../core/Analytics';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {logger} from '../utils/Logger';\nimport {Adapter} from './Adapter';\nimport {ShakaInternalAdapter} from './internal/ShakaInternalAdapter';\nexport class ShakaAdapter extends Adapter implements AdapterAPI {\n  constructor(config: AnalyticsConfig, player: any, opts?: AnalyticsStateMachineOptions) {\n    super();\n    if (this.hasPlayerAlreadyBeenAugmented(player)) {\n      logger.errorMessageToUser('Bitmovin Analytics is already hooked up to this player instance');\n      return;\n    }\n    this.markPlayerInstanceAsAugmented(player);\n    this.internalAdapter = new ShakaInternalAdapter(player, opts);\n    this.analytics = new Analytics(config, this.internalAdapter);\n  }\n}\n","import {Analytics} from '../../core/Analytics';\nimport {MIMETypes} from '../../enums/MIMETypes';\nimport {Player} from '../../enums/Player';\nimport {ErrorDetailBackend} from '../../features/errordetails/ErrorDetailBackend';\nimport {ErrorDetailTracking} from '../../features/errordetails/ErrorDetailTracking';\nimport {Feature} from '../../features/Feature';\nimport {FeatureConfig} from '../../features/FeatureConfig';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {QualityLevelInfo} from '../../types/QualityLevelInfo';\nimport {HTML5InternalAdapter} from './HTML5InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nexport class ShakaInternalAdapter extends HTML5InternalAdapter implements InternalAdapterAPI {\n  constructor(private player: any, opts?: AnalyticsStateMachineOptions) {\n    super(player.getMediaElement(), opts);\n  }\n\n  /**\n   * @override\n   */\n  public initialize(analytics: Analytics): Array<Feature<FeatureConfigContainer, FeatureConfig>> {\n    super.initialize(analytics);\n    let videoElement: HTMLVideoElement | undefined;\n    try {\n      videoElement = this.player.getMediaElement();\n    } catch (e) {} // tslint:disable-line:no-empty\n\n    if (videoElement == null) {\n      const onStateChangeEventListener = (state) => {\n        if (state.state === 'media-source') {\n          this.player.removeEventListener('onstatechange', onStateChangeEventListener);\n          videoElement = this.player.getMediaElement();\n          this.setMediaElement(videoElement);\n        }\n      };\n      this.player.addEventListener('onstatechange', onStateChangeEventListener);\n      this.player.addEventListener('unloading', this.release.bind(this));\n    } else {\n      this.setMediaElement(videoElement);\n    }\n    const errorDetailTracking = new ErrorDetailTracking(\n      analytics.errorDetailTrackingSettingsProvider,\n      new ErrorDetailBackend(analytics.errorDetailTrackingSettingsProvider.collectorConfig),\n      [analytics.errorDetailSubscribable],\n      undefined\n    );\n    return [errorDetailTracking];\n  }\n\n  public getPlayerName = () => Player.SHAKA;\n\n  public getPlayerVersion = () => this.player.constructor.version;\n\n  public isLive = () => {\n    return this.player ? this.player.isLive() : false;\n  };\n\n  /**\n   * @override\n   */\n  public getMIMEType() {\n    // FIXME: Could be HLS too, Shaka probably has a method to find out\n    return MIMETypes.DASH;\n  }\n\n  /**\n   * @override\n   */\n  public getStreamURL() {\n    return this.player ? this.player.getAssetUri() : null;\n  }\n\n  /**\n   * Implemented by sub-class to deliver current quality-level info\n   * specific to media-engine.\n   * @override\n   * @returns {QualityLevelInfo}\n   */\n  public getCurrentQualityLevelInfo(): QualityLevelInfo | null {\n    const variantTracks = this.player.getVariantTracks();\n\n    const activeVideoTrack = variantTracks\n      .filter((track: any) => track.active)\n      .filter((track: any) => track.videoCodec || track.videoId !== undefined)[0];\n\n    if (!activeVideoTrack) {\n      // can only happen for audio-only streams\n      return null;\n    }\n\n    const bitrate = activeVideoTrack.videoBandwidth || activeVideoTrack.bandwidth;\n    const width = activeVideoTrack.width;\n    const height = activeVideoTrack.height;\n\n    return {\n      bitrate,\n      width,\n      height,\n    };\n  }\n}\n","import {AdapterAPI} from '../api/AdapterAPI';\nimport {Analytics} from '../core/Analytics';\nimport {AnalyticsConfig} from '../types/AnalyticsConfig';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {logger} from '../utils/Logger';\nimport {Adapter} from './Adapter';\nimport {VideojsInternalAdapter} from './internal/VideojsInternalAdapter';\n\nexport class VideojsAdapter extends Adapter implements AdapterAPI {\n  constructor(config: AnalyticsConfig, player: any, opts?: AnalyticsStateMachineOptions) {\n    super();\n    if (this.hasPlayerAlreadyBeenAugmented(player)) {\n      logger.errorMessageToUser('Bitmovin Analytics is already hooked up to this player instance');\n      return;\n    }\n    this.markPlayerInstanceAsAugmented(player);\n    this.internalAdapter = new VideojsInternalAdapter(player as videojs.default.Player, opts);\n    this.analytics = new Analytics(config, this.internalAdapter);\n  }\n}\n","// tslint:disable:no-shadowed-variable\nimport {VideojsAnalyticsStateMachine} from '../../analyticsStateMachines/VideoJsAnalyticsStateMachine';\nimport {Analytics} from '../../core/Analytics';\nimport VideoCompletionTracker from '../../core/VideoCompletionTracker';\nimport {Event} from '../../enums/Event';\nimport {getMIMETypeFromFileExtension} from '../../enums/MIMETypes';\nimport {Player} from '../../enums/Player';\nimport {PlayerSize} from '../../enums/PlayerSize';\nimport {getStreamTypeFromMIMEType} from '../../enums/StreamTypes';\nimport {ErrorDetailBackend} from '../../features/errordetails/ErrorDetailBackend';\nimport {ErrorDetailTracking} from '../../features/errordetails/ErrorDetailTracking';\nimport {Feature} from '../../features/Feature';\nimport {FeatureConfig} from '../../features/FeatureConfig';\nimport {AnalyticsStateMachineOptions} from '../../types/AnalyticsStateMachineOptions';\nimport {DrmPerformanceInfo} from '../../types/DrmPerformanceInfo';\nimport {FeatureConfigContainer} from '../../types/FeatureConfigContainer';\nimport {PlaybackInfo} from '../../types/PlaybackInfo';\nimport {QualityLevelInfo} from '../../types/QualityLevelInfo';\nimport {StreamSources} from '../../types/StreamSources';\nimport {isDifferentSubtitleInfo, SubtitleInfo} from '../../types/SubtitleInfo';\nimport {InternalAdapter} from './InternalAdapter';\nimport {InternalAdapterAPI} from './InternalAdapterAPI';\n\nexport class VideojsInternalAdapter extends InternalAdapter implements InternalAdapterAPI {\n  public readonly videoCompletionTracker: VideoCompletionTracker;\n  private _subtitleInfo: SubtitleInfo = {enabled: false};\n  private selectedAudioLanguage?: string;\n  private onBeforeUnLoadEvent: boolean = false;\n  private previousTime: number = 0;\n\n  constructor(private player: videojs.default.Player, opts?: AnalyticsStateMachineOptions) {\n    super(opts);\n    this.stateMachine = new VideojsAnalyticsStateMachine(this.stateMachineCallbacks, this.opts);\n    this.videoCompletionTracker = new VideoCompletionTracker();\n  }\n\n  public initialize(analytics: Analytics): Array<Feature<FeatureConfigContainer, FeatureConfig>> {\n    this.register();\n    const errorDetailTracking = new ErrorDetailTracking(\n      analytics.errorDetailTrackingSettingsProvider,\n      new ErrorDetailBackend(analytics.errorDetailTrackingSettingsProvider.collectorConfig),\n      [analytics.errorDetailSubscribable],\n      undefined\n    );\n    return [errorDetailTracking];\n  }\n\n  public getPlayerVersion = () => ((window as any).videojs ? (window as any).videojs.VERSION : 'unknown');\n  public getPlayerName = () => Player.VIDEOJS;\n  public getPlayerTech = () => 'html5';\n  public getAutoPlay = () => (this.player.autoplay() as any) == true; // tslint:disable-line:triple-equals\n  public getDrmPerformanceInfo = (): DrmPerformanceInfo | undefined => this.drmPerformanceInfo;\n\n  public getStreamType(url: string) {\n    const mimeType = getMIMETypeFromFileExtension(url);\n    if (mimeType) {\n      return getStreamTypeFromMIMEType(mimeType);\n    }\n  }\n\n  // this seems very generic. one could put it in a helper\n  // and use it in many adapter implementations.\n  public getStreamSources(url: string): StreamSources {\n    const streamType = this.getStreamType(url);\n    switch (streamType) {\n      case 'hls':\n        return {m3u8Url: url};\n      case 'dash':\n        return {mpdUrl: url};\n      default:\n        return {progUrl: url};\n    }\n  }\n\n  public getCurrentPlaybackInfo(): PlaybackInfo {\n    this.selectedAudioLanguage = this.getSelectedAudioTrackLanguage(this.player);\n\n    const info: PlaybackInfo = {\n      ...this.getCommonPlaybackInfo(),\n      ...this.getStreamSources(this.player.currentSrc()),\n      streamFormat: this.getStreamType(this.player.currentSrc()),\n      isLive: this.player.duration() === Infinity,\n      size: (this.player as any).isFullscreen() ? PlayerSize.Fullscreen : PlayerSize.Window,\n      playerTech: this.getPlayerTech(),\n      isMuted: this.player.muted(),\n      videoDuration: this.player.duration(),\n      videoWindowHeight: this.player.height(),\n      videoWindowWidth: this.player.width(),\n      videoPlaybackHeight: (this.player as any).videoHeight(),\n      videoPlaybackWidth: (this.player as any).videoWidth(),\n      audioLanguage: this.selectedAudioLanguage,\n      subtitleEnabled: this._subtitleInfo.enabled,\n      subtitleLanguage: this._subtitleInfo.language,\n      droppedFrames: 0, // TODO\n      // TODO audioBitrate:\n      // TODO isCasting:\n      // TODO videoTitle: (currently only from the analytics config)\n    };\n\n    const qualityInfo = this.getCurrentQualityLevelInfo();\n    if (qualityInfo) {\n      info.videoPlaybackWidth = qualityInfo.width || info.videoPlaybackWidth;\n      info.videoPlaybackWidth = qualityInfo.height || info.videoPlaybackHeight;\n      info.videoBitrate = qualityInfo.bitrate;\n    }\n\n    return info;\n  }\n\n  public getCurrentQualityLevelInfo(): QualityLevelInfo | null {\n    // TODO: Needs to be implemented\n    return null;\n  }\n\n  public register() {\n    const that = this;\n    this.player.on('loadedmetadata', function (this: any) {\n      that.videoCompletionTracker.reset();\n      that.videoCompletionTracker.setVideoDuration(this.duration());\n      that.previousTime = 0;\n      that.eventCallback(Event.SOURCE_LOADED, {});\n    });\n    this.player.ready(function (this: any) {\n      that._subtitleInfo = that.getSubtitleInfo(this);\n      that.eventCallback(Event.READY, {});\n    });\n    this.player.on('play', function (this: any) {\n      that.eventCallback(Event.PLAY, {\n        currentTime: this.currentTime(),\n      });\n    });\n    this.player.on('pause', function (this: any) {\n      if (!this.seeking()) {\n        that.eventCallback(Event.PAUSE, {\n          currentTime: this.currentTime(),\n        });\n      }\n    });\n    this.player.on('error', function (this: any) {\n      const error: MediaError = this.error();\n      that.eventCallback(Event.ERROR, {\n        currentTime: this.currentTime(),\n        code: error.code,\n        message: error.message,\n        data: {},\n      });\n    });\n    this.player.on('volumechange', function (this: any) {\n      const muted = this.muted();\n      if (muted) {\n        that.eventCallback(Event.MUTE, {\n          currentTime: this.currentTime(),\n        });\n      } else {\n        that.eventCallback(Event.UN_MUTE, {\n          currentTime: this.currentTime(),\n        });\n      }\n    });\n    this.player.on('seeking', function (this: any) {\n      that.eventCallback(Event.SEEK, {\n        currentTime: that.previousTime != null ? that.previousTime : this.currentTime(),\n      });\n    });\n    this.player.on('seeked', function (this: any) {\n      that.eventCallback(Event.SEEKED, {\n        currentTime: this.currentTime(),\n      });\n    });\n\n    this.player.on('texttrackchange', function (this: any) {\n      const newSubtitleInfo = that.getSubtitleInfo(this);\n      const hasInfoChanged =\n        that._subtitleInfo == null ? true : isDifferentSubtitleInfo(that._subtitleInfo, newSubtitleInfo);\n      that._subtitleInfo = newSubtitleInfo;\n\n      if (hasInfoChanged) {\n        that.eventCallback(Event.SUBTITLE_CHANGE, {\n          currentTime: this.currentTime(),\n        });\n      }\n    });\n\n    const audioTracks = (this.player as any).audioTracks();\n    audioTracks.on('change', () => {\n      const newSelectedAudioLanguage = that.getSelectedAudioTrackLanguage(that.player);\n      if (newSelectedAudioLanguage != null && newSelectedAudioLanguage !== that.selectedAudioLanguage) {\n        that.eventCallback(Event.AUDIOTRACK_CHANGED, {\n          currentTime: that.player.currentTime(),\n        });\n      }\n    });\n\n    this.player.on('stalled', function (this: any) {\n      that.eventCallback(Event.START_BUFFERING, {\n        currentTime: this.currentTime(),\n      });\n    });\n    this.player.on('waiting', function (this: any) {\n      that.eventCallback(Event.START_BUFFERING, {\n        currentTime: this.currentTime(),\n      });\n    });\n    this.player.on('timeupdate', function (this: any) {\n      if (!this.seeking()) {\n        that.previousTime = this.currentTime();\n      }\n      that.eventCallback(Event.TIMECHANGED, {\n        currentTime: this.currentTime(),\n      });\n\n      // that is not the quality that is currently being played.\n      // for more accuracy one can use the segment-metadata cue tracking:\n      // https://github.com/videojs/videojs-contrib-hls#segment-metadata\n      const selectedPlaylist = this.tech_.hls ? this.tech_.hls.playlists.media() : null;\n      if (!selectedPlaylist) {\n        return;\n      }\n\n      const {attributes} = selectedPlaylist;\n      const bitrate = attributes.BANDWIDTH;\n      const width = (attributes.RESOLUTION || {}).width;\n      const height = (attributes.RESOLUTION || {}).height;\n\n      if (that.shouldAllowVideoQualityChange(bitrate)) {\n        const eventObject = {\n          width,\n          height,\n          bitrate,\n          currentTime: this.currentTime(),\n        };\n\n        that.eventCallback(Event.VIDEO_CHANGE, eventObject);\n        that.setPreviousVideoBitrate(bitrate);\n      }\n\n      // Check for HLS source-handler (videojs-contrib-hls)\n      // When we just use Videojs without any specific source-handler (not using MSE API based engine)\n      // but just native technology (HTML5/Flash) to do for example \"progressive download\" with plain Webm/Mp4\n      // or use native HLS on Safari this may not not be present. In that case Videojs is just\n      // a wrapper around the respective playback tech (HTML or Flash).\n\n      const tech = this.tech({IWillNotUseThisInPlugins: true});\n      if (tech.hls) {\n        // From here we are going onto Videojs-HLS source-handler specific API\n        //\n        const hls = this.tech_.hls;\n\n        // Maybe we have the HLS source-handler initialized, but it is\n        // not actually activated and used (just wrapping HTML5 built-in HLS playback like in Safari)\n        if (!hls.playlists || typeof hls.playlists.media !== 'function') {\n          return;\n        }\n\n        // Check for current media playlist\n        const selectedPlaylist = hls.playlists.media();\n        if (!selectedPlaylist) {\n          return;\n        }\n\n        const {attributes} = selectedPlaylist;\n        const bitrate = attributes.BANDWIDTH;\n        const width = (attributes.RESOLUTION || {}).width;\n        const height = (attributes.RESOLUTION || {}).height;\n\n        // update actual bitrate\n        if (that.shouldAllowVideoQualityChange(bitrate)) {\n          const eventObject = {\n            width,\n            height,\n            bitrate,\n            currentTime: this.currentTime(),\n          };\n\n          that.eventCallback(Event.VIDEO_CHANGE, eventObject);\n          that.setPreviousVideoBitrate(bitrate);\n        }\n      }\n    });\n\n    const handlePageClose = () => {\n      if (!this.onBeforeUnLoadEvent) {\n        this.onBeforeUnLoadEvent = true;\n        let currentTime: number | undefined;\n        if (this.player != null) {\n          currentTime = this.player.currentTime();\n        }\n        this.eventCallback(Event.UNLOAD, {\n          currentTime,\n        });\n      }\n    };\n\n    window.addEventListener('beforeunload', handlePageClose);\n    window.addEventListener('unload', handlePageClose);\n  }\n\n  public sourceChange(config: any, timestamp: number) {\n    this.videoCompletionTracker.reset();\n    this.videoCompletionTracker.setVideoDuration(this.player.duration());\n    this.previousTime = 0;\n    this.stateMachine.sourceChange(config, timestamp, this.player.currentTime());\n  }\n  protected get currentTime(): number {\n    return this.player.currentTime();\n  }\n\n  private getSelectedAudioTrackLanguage(player: any): string | undefined {\n    for (const track of player.audioTracks()) {\n      if (track.enabled) {\n        return track.language;\n      }\n    }\n    return undefined;\n  }\n\n  private getSubtitleInfo(player: any): SubtitleInfo {\n    const textTracks = player.textTracks() || [];\n    let enabled = false;\n    let language;\n    for (const track of textTracks) {\n      if (track.mode === 'showing') {\n        enabled = true;\n        language = track.language;\n        break;\n      }\n    }\n    return {\n      enabled,\n      language,\n    };\n  }\n}\n","import * as StateMachine from 'javascript-state-machine';\nimport {Event, EventMap} from '../enums/Event';\nimport {AnalyticsStateMachineOptions} from '../types/AnalyticsStateMachineOptions';\nimport {NoExtraProperties} from '../types/NoExtraProperties';\nimport {StateMachineCallbacks} from '../types/StateMachineCallbacks';\nimport {logger, padRight} from '../utils/Logger';\nimport {AnalyticsStateMachine} from './AnalyticsStateMachine';\n\nenum State {\n  AD = 'AD',\n  SETUP = 'SETUP',\n  STARTUP = 'STARTUP',\n  READY = 'READY',\n  PLAYING = 'PLAYING',\n  REBUFFERING = 'REBUFFERING',\n  PAUSE = 'PAUSE',\n  QUALITYCHANGE = 'QUALITYCHANGE',\n  PAUSED_SEEKING = 'PAUSED_SEEKING',\n  PLAY_SEEKING = 'PLAY_SEEKING',\n  END_PLAY_SEEKING = 'END_PLAY_SEEKING',\n  QUALITYCHANGE_PAUSE = 'QUALITYCHANGE_PAUSE',\n  QUALITYCHANGE_REBUFFERING = 'QUALITYCHANGE_REBUFFERING',\n  SOURCE_CHANGING = 'SOURCE_CHANGING',\n  END = 'END',\n  ERROR = 'ERROR',\n  MUTING_READY = 'MUTING_READY',\n  MUTING_PLAY = 'MUTING_PLAY',\n  MUTING_PAUSE = 'MUTING_PAUSE',\n  CASTING = 'CASTING',\n  AUDIOTRACK_CHANGING = 'AUDIOTRACK_CHANGING',\n  AUDIOTRACK_CHANGED_PLAYING = 'AUDIOTRACK_CHANGED_PLAYING',\n  SUBTITLE_CHANGING = 'SUBTITLE_CHANGING',\n  SUBTITLE_CHANGED_PLAYING = 'SUBTITLE_CHANGED_PLAYING',\n  EXIT_BEFORE_VIDEOSTART = 'EXIT_BEFORE_VIDEOSTART',\n  CUSTOMDATACHANGE = 'CUSTOMDATACHANGE',\n}\n\nexport class VideojsAnalyticsStateMachine extends AnalyticsStateMachine {\n  private seekTimestamp: number;\n  private seekedTimestamp: number;\n  private seekedTimeout: number;\n\n  constructor(stateMachineCallbacks: StateMachineCallbacks, opts: AnalyticsStateMachineOptions) {\n    super(stateMachineCallbacks, opts);\n\n    this.seekTimestamp = 0;\n    this.seekedTimestamp = 0;\n    this.seekedTimeout = 0;\n  }\n\n  public getAllStates() {\n    return [\n      ...Object.keys(State).map((key) => State[key]),\n      'FINISH_PLAY_SEEKING',\n      'PLAY_SEEK',\n      'FINISH_QUALITYCHANGE_PAUSE',\n      'FINISH_QUALITYCHANGE',\n      'FINISH_QUALITYCHANGE_REBUFFERING',\n    ];\n  }\n\n  public getAllStatesBut(state: string) {\n    return this.getAllStates().filter((i) => i !== state);\n  }\n\n  public createStateMachine(opts: AnalyticsStateMachineOptions) {\n    return StateMachine.create({\n      initial: State.SETUP,\n      error: (eventName, from, to, args, errorCode, errorMessage) => {\n        logger.error('Error in statemachine: ' + errorMessage);\n      },\n      events: [\n        {name: Event.SOURCE_LOADED, from: [State.SETUP, State.ERROR, State.SOURCE_CHANGING], to: State.READY},\n        {name: Event.TIMECHANGED, from: State.SETUP, to: State.SETUP},\n        {name: Event.SOURCE_LOADED, from: State.READY, to: State.READY},\n        {name: Event.READY, from: [State.SETUP, State.ERROR], to: State.READY},\n        {name: Event.PLAY, from: State.READY, to: State.STARTUP},\n\n        {name: Event.ERROR, from: State.STARTUP, to: State.EXIT_BEFORE_VIDEOSTART},\n        {name: Event.UNLOAD, from: State.STARTUP, to: State.EXIT_BEFORE_VIDEOSTART},\n        {name: Event.VIDEOSTART_TIMEOUT, from: State.STARTUP, to: State.EXIT_BEFORE_VIDEOSTART},\n\n        {name: Event.START_BUFFERING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.END_BUFFERING, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.VIDEO_CHANGE, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.AUDIO_CHANGE, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.TIMECHANGED, from: State.STARTUP, to: State.PLAYING},\n\n        {name: Event.TIMECHANGED, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.END_BUFFERING, from: State.PLAYING, to: State.PLAYING},\n        {name: Event.START_BUFFERING, from: State.PLAYING, to: State.REBUFFERING},\n        {name: Event.START_BUFFERING, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.TIMECHANGED, from: State.REBUFFERING, to: State.PLAYING},\n\n        // Ignoring since it's pushed in a live stream\n        {name: Event.SEEK, from: State.STARTUP, to: State.STARTUP},\n        {name: Event.SEEK, from: State.PLAYING, to: State.PLAY_SEEKING},\n        {name: Event.TIMECHANGED, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.TIMECHANGED, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n\n        {name: Event.PAUSE, from: State.PLAYING, to: State.PAUSE},\n        {name: Event.PAUSE, from: State.REBUFFERING, to: State.PAUSE},\n        {name: Event.TIMECHANGED, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.PLAY, from: State.PAUSE, to: State.PLAYING},\n\n        {name: Event.VIDEO_CHANGE, from: State.PLAYING, to: State.QUALITYCHANGE},\n        {name: Event.AUDIO_CHANGE, from: State.PLAYING, to: State.QUALITYCHANGE},\n        {name: Event.VIDEO_CHANGE, from: State.QUALITYCHANGE, to: State.QUALITYCHANGE},\n        {name: Event.AUDIO_CHANGE, from: State.QUALITYCHANGE, to: State.QUALITYCHANGE},\n        {name: 'FINISH_QUALITYCHANGE', from: State.QUALITYCHANGE, to: State.PLAYING},\n\n        {name: Event.VIDEO_CHANGE, from: State.PAUSE, to: State.QUALITYCHANGE_PAUSE},\n        {name: Event.AUDIO_CHANGE, from: State.PAUSE, to: State.QUALITYCHANGE_PAUSE},\n        {\n          name: Event.VIDEO_CHANGE,\n          from: State.QUALITYCHANGE_PAUSE,\n          to: State.QUALITYCHANGE_PAUSE,\n        },\n        {\n          name: Event.AUDIO_CHANGE,\n          from: State.QUALITYCHANGE_PAUSE,\n          to: State.QUALITYCHANGE_PAUSE,\n        },\n        {name: 'FINISH_QUALITYCHANGE_PAUSE', from: State.QUALITYCHANGE_PAUSE, to: State.PAUSE},\n\n        {name: Event.SEEK, from: State.PAUSE, to: State.PAUSED_SEEKING},\n        {name: Event.SEEK, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.AUDIO_CHANGE, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.VIDEO_CHANGE, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.START_BUFFERING, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.END_BUFFERING, from: State.PAUSED_SEEKING, to: State.PAUSED_SEEKING},\n        {name: Event.SEEKED, from: State.PAUSED_SEEKING, to: State.PAUSE},\n        {name: Event.PLAY, from: State.PAUSED_SEEKING, to: State.PLAYING},\n        {name: Event.PAUSE, from: State.PAUSED_SEEKING, to: State.PAUSE},\n\n        {name: 'PLAY_SEEK', from: State.PAUSE, to: State.PLAY_SEEKING},\n        {name: 'PLAY_SEEK', from: State.PAUSED_SEEKING, to: State.PLAY_SEEKING},\n        {name: 'PLAY_SEEK', from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.SEEK, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.AUDIO_CHANGE, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.VIDEO_CHANGE, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.START_BUFFERING, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.END_BUFFERING, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: Event.SEEKED, from: State.PLAY_SEEKING, to: State.PLAY_SEEKING},\n\n        // We are ending the seek\n        {name: Event.SEEKED, from: State.PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n\n        {name: Event.START_BUFFERING, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.END_BUFFERING, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.SEEKED, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.TIMECHANGED, from: State.END_PLAY_SEEKING, to: State.PLAYING},\n\n        {name: Event.END, from: State.PLAY_SEEKING, to: State.END},\n        {name: Event.END, from: State.PAUSED_SEEKING, to: State.END},\n        {name: Event.END, from: State.PLAYING, to: State.END},\n        {name: Event.END, from: State.PAUSE, to: State.END},\n        {name: Event.SEEK, from: State.END, to: State.END},\n        {name: Event.SEEKED, from: State.END, to: State.END},\n        {name: Event.TIMECHANGED, from: State.END, to: State.END},\n        {name: Event.END_BUFFERING, from: State.END, to: State.END},\n        {name: Event.START_BUFFERING, from: State.END, to: State.END},\n        {name: Event.END, from: State.END, to: State.END},\n\n        // Ignored - Livestreams do a Seek during startup and SEEKED once playback started\n        {name: Event.SEEKED, from: State.PLAYING, to: State.PLAYING},\n\n        {name: Event.PLAY, from: State.END, to: State.PLAYING},\n\n        {name: Event.ERROR, from: this.getAllStatesBut(State.STARTUP), to: State.ERROR},\n        {name: Event.PAUSE, from: State.ERROR, to: State.ERROR},\n\n        {name: Event.SEEK, from: State.END_PLAY_SEEKING, to: State.PLAY_SEEKING},\n        {name: 'FINISH_PLAY_SEEKING', from: State.END_PLAY_SEEKING, to: State.PLAYING},\n\n        {name: Event.UNLOAD, from: this.getAllStatesBut(State.STARTUP), to: State.END},\n\n        {name: Event.START_AD, from: State.PLAYING, to: State.AD},\n        {name: Event.END_AD, from: State.AD, to: State.PLAYING},\n\n        {name: Event.MUTE, from: State.READY, to: State.MUTING_READY},\n        {name: Event.UN_MUTE, from: State.READY, to: State.MUTING_READY},\n        {name: 'FINISH_MUTING', from: State.MUTING_READY, to: State.READY},\n\n        {name: Event.MUTE, from: State.PLAYING, to: State.MUTING_PLAY},\n        {name: Event.UN_MUTE, from: State.PLAYING, to: State.MUTING_PLAY},\n        {name: 'FINISH_MUTING', from: State.MUTING_PLAY, to: State.PLAYING},\n\n        {name: Event.MUTE, from: State.PAUSE, to: State.MUTING_PAUSE},\n        {name: Event.UN_MUTE, from: State.PAUSE, to: State.MUTING_PAUSE},\n        {name: 'FINISH_MUTING', from: State.MUTING_PAUSE, to: State.PAUSE},\n\n        {name: Event.START_CAST, from: [State.READY, State.PAUSE], to: State.CASTING},\n        {name: Event.PAUSE, from: State.CASTING, to: State.CASTING},\n        {name: Event.PLAY, from: State.CASTING, to: State.CASTING},\n        {name: Event.TIMECHANGED, from: State.CASTING, to: State.CASTING},\n        {name: Event.MUTE, from: State.CASTING, to: State.CASTING},\n        {name: Event.SEEK, from: State.CASTING, to: State.CASTING},\n        {name: Event.SEEKED, from: State.CASTING, to: State.CASTING},\n        {name: Event.END_CAST, from: State.CASTING, to: State.READY},\n\n        {name: Event.SEEK, from: State.READY, to: State.READY},\n        {name: Event.SEEKED, from: State.READY, to: State.READY},\n        {name: Event.SEEKED, from: State.STARTUP, to: State.STARTUP},\n\n        {name: Event.AUDIOTRACK_CHANGED, from: State.PLAYING, to: State.AUDIOTRACK_CHANGED_PLAYING},\n        {name: 'FINISH_AUDIOTRACK_CHANGING', from: State.AUDIOTRACK_CHANGED_PLAYING, to: State.PLAYING},\n        // States which should ignore audioTrack changes\n        {name: Event.AUDIOTRACK_CHANGED, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.READY, to: State.READY},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.AUDIOTRACK_CHANGED, from: State.AUDIOTRACK_CHANGING, to: State.AUDIOTRACK_CHANGING},\n\n        {name: Event.SUBTITLE_CHANGE, from: State.PLAYING, to: State.SUBTITLE_CHANGED_PLAYING},\n        {name: 'FINISH_SUBTITLE_CHANGING', from: State.SUBTITLE_CHANGED_PLAYING, to: State.PLAYING},\n        // States which should ignore subtitle changes\n        {name: Event.SUBTITLE_CHANGE, from: State.PAUSE, to: State.PAUSE},\n        {name: Event.SUBTITLE_CHANGE, from: State.READY, to: State.READY},\n        {name: Event.SUBTITLE_CHANGE, from: State.REBUFFERING, to: State.REBUFFERING},\n        {name: Event.SUBTITLE_CHANGE, from: State.END_PLAY_SEEKING, to: State.END_PLAY_SEEKING},\n        {name: Event.SUBTITLE_CHANGE, from: State.SUBTITLE_CHANGING, to: State.SUBTITLE_CHANGING},\n\n        {\n          name: Event.MANUAL_SOURCE_CHANGE,\n          from: this.getAllStatesBut(State.SETUP),\n          to: State.SOURCE_CHANGING,\n        },\n        {name: Event.MANUAL_SOURCE_CHANGE, from: State.SETUP, to: State.SETUP},\n        {name: Event.TIMECHANGED, from: State.SOURCE_CHANGING, to: State.SOURCE_CHANGING},\n\n        {name: Event.VIDEO_CHANGE, from: State.REBUFFERING, to: State.QUALITYCHANGE_REBUFFERING},\n        {name: Event.AUDIO_CHANGE, from: State.REBUFFERING, to: State.QUALITYCHANGE_REBUFFERING},\n        {\n          name: Event.VIDEO_CHANGE,\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.QUALITYCHANGE_REBUFFERING,\n        },\n        {\n          name: Event.AUDIO_CHANGE,\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.QUALITYCHANGE_REBUFFERING,\n        },\n        {\n          name: 'FINISH_QUALITYCHANGE_REBUFFERING',\n          from: State.QUALITYCHANGE_REBUFFERING,\n          to: State.REBUFFERING,\n        },\n\n        {name: Event.CUSTOM_DATA_CHANGE, from: [State.PLAYING, State.PAUSE], to: State.CUSTOMDATACHANGE},\n        {name: Event.PLAYING, from: State.CUSTOMDATACHANGE, to: State.PLAYING},\n        {name: Event.PAUSE, from: State.CUSTOMDATACHANGE, to: State.PAUSE},\n      ],\n      callbacks: {\n        onafterevent: (event, from, to, timestamp) => {\n          if (to === State.QUALITYCHANGE) {\n            this.stateMachine.FINISH_QUALITYCHANGE(timestamp);\n          }\n          if (to === State.MUTING_READY || to === State.MUTING_PLAY || to === State.MUTING_PAUSE) {\n            this.stateMachine.FINISH_MUTING(timestamp);\n          }\n          if (to === State.AUDIOTRACK_CHANGED_PLAYING) {\n            this.stateMachine.FINISH_AUDIOTRACK_CHANGING(timestamp);\n          }\n          if (to === State.SUBTITLE_CHANGED_PLAYING) {\n            this.stateMachine.FINISH_SUBTITLE_CHANGING(timestamp);\n          }\n        },\n        onenterstate: (event, from, to, timestamp, eventObject) => {\n          if (from === 'none' && opts.starttime) {\n            this.onEnterStateTimestamp = opts.starttime;\n          } else {\n            this.onEnterStateTimestamp = timestamp || new Date().getTime();\n          }\n\n          logger.log('[ENTER] ' + padRight(to, 20) + 'EVENT: ' + padRight(event, 20) + ' from ' + padRight(from, 14));\n\n          if (\n            eventObject &&\n            to !== State.PAUSED_SEEKING &&\n            to !== State.PLAY_SEEKING &&\n            to !== State.END_PLAY_SEEKING\n          ) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.SEEK) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.SEEKED) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n          }\n\n          if (\n            event === 'PLAY_SEEK' &&\n            to === State.PLAY_SEEKING &&\n            to !== State.PLAY_SEEKING &&\n            to !== State.END_PLAY_SEEKING\n          ) {\n            this.seekTimestamp = this.onEnterStateTimestamp;\n          }\n\n          if (event === Event.START_CAST && to === State.CASTING) {\n            this.stateMachineCallbacks.startCasting(timestamp, eventObject);\n          }\n\n          if (to === State.REBUFFERING) {\n            this.startRebufferingHeartbeatInterval();\n          }\n        },\n        onleavestate: (event, from, to, timestamp, eventObject) => {\n          if (from === State.REBUFFERING) {\n            this.resetRebufferingHelpers();\n          }\n\n          if (!timestamp) {\n            return;\n          }\n          logger.log(`[LEAVE] ${padRight(from, 20)} EVENT: ${padRight(event, 20)} to ${padRight(to, 20)}`);\n\n          const stateDuration = timestamp - this.onEnterStateTimestamp;\n\n          if (eventObject && to !== State.PAUSED_SEEKING && to !== State.END_PLAY_SEEKING) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n          }\n\n          if (event === 'PLAY_SEEK' && from === State.PAUSE) {\n            return true;\n          }\n\n          if (from === State.READY && to === State.STARTUP) {\n            this.setVideoStartTimeout();\n          } else if (from === State.STARTUP && (to === State.PLAYING || to === State.EXIT_BEFORE_VIDEOSTART)) {\n            this.clearVideoStartTimeout();\n          }\n\n          const fnName = String(from).toLowerCase();\n          if (to === State.EXIT_BEFORE_VIDEOSTART) {\n            this.clearVideoStartTimeout();\n            const eventData = this.getVideoStartupFailedEventData(timestamp, event, eventObject);\n            const shouldSendSample = event !== Event.ERROR;\n            this.stateMachineCallbacks.videoStartFailed(eventData, shouldSendSample);\n          } else if (from === State.PAUSED_SEEKING) {\n            const seekDuration = timestamp - this.seekTimestamp;\n            this.stateMachineCallbacks.paused_seeking(seekDuration, fnName);\n          } else if (from === State.END_PLAY_SEEKING) {\n            const seekDuration = this.seekedTimestamp - this.seekTimestamp;\n            this.stateMachineCallbacks.end_play_seeking(seekDuration, fnName);\n          } else if (event === Event.UNLOAD) {\n            this.stateMachineCallbacks.unload(stateDuration, fnName);\n          } else if (from === State.PAUSE && to !== State.PAUSED_SEEKING) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(event);\n            this.stateMachineCallbacks.pause(stateDuration, fnName);\n          } else {\n            const callbackFunction = this.stateMachineCallbacks[fnName];\n            if (typeof callbackFunction === 'function') {\n              callbackFunction(stateDuration, fnName, eventObject);\n            } else {\n              const excludedStates = [\n                State.MUTING_PAUSE,\n                State.MUTING_PLAY,\n                State.AUDIOTRACK_CHANGED_PLAYING,\n                State.SUBTITLE_CHANGED_PLAYING,\n              ];\n              if (excludedStates.find((e) => from === e) == null) {\n                logger.error('Could not find callback function for ' + fnName);\n              }\n            }\n          }\n\n          if (\n            eventObject &&\n            to !== State.PAUSED_SEEKING &&\n            to !== State.PLAY_SEEKING &&\n            to !== State.END_PLAY_SEEKING\n          ) {\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n\n          if (event === Event.VIDEO_CHANGE) {\n            this.stateMachineCallbacks.videoChange(eventObject);\n          } else if (event === Event.AUDIO_CHANGE) {\n            this.stateMachineCallbacks.audioChange(eventObject);\n          } else if (event === Event.MUTE) {\n            this.stateMachineCallbacks.mute();\n          } else if (event === Event.UN_MUTE) {\n            this.stateMachineCallbacks.unMute();\n          } else if (event === Event.MANUAL_SOURCE_CHANGE) {\n            this.stateMachineCallbacks.manualSourceChange(eventObject);\n          }\n        },\n        onseek: (event, from, to, timestamp) => {\n          this.seekTimestamp = timestamp;\n        },\n        onseeked: (event, from, to, timestamp) => {\n          this.seekedTimestamp = timestamp;\n        },\n        ontimechanged: (event, from, to, timestamp, eventObject) => {\n          const stateDuration = timestamp - this.onEnterStateTimestamp;\n\n          if (stateDuration > 59700) {\n            this.stateMachineCallbacks.setVideoTimeEndFromEvent(eventObject);\n\n            this.stateMachineCallbacks.heartbeat(stateDuration, String(from).toLowerCase(), {played: stateDuration});\n            this.onEnterStateTimestamp = timestamp;\n\n            this.stateMachineCallbacks.setVideoTimeStartFromEvent(eventObject);\n          }\n        },\n        onplayerError: (event, from, to, timestamp, eventObject) => {\n          this.stateMachineCallbacks.error(eventObject);\n        },\n      },\n    });\n  }\n\n  public callEvent<StatemachineEvent extends keyof EventMap, EventData extends EventMap[StatemachineEvent]>(\n    eventType: StatemachineEvent,\n    eventObject: NoExtraProperties<EventMap[StatemachineEvent], EventData>,\n    timestamp: number\n  ): void {\n    const exec = this.stateMachine[eventType];\n\n    if (exec) {\n      exec.call(this.stateMachine, timestamp, eventObject);\n    } else {\n      logger.log('Ignored Event: ' + eventType);\n    }\n  }\n\n  public sourceChange = (config: any, timestamp: number, currentTime?: number) => {\n    this.callEvent(Event.MANUAL_SOURCE_CHANGE, {config, currentTime}, timestamp);\n  };\n}\n","export interface SubtitleInfo {\n  /**\n   * Indicates if subtitles are displayed.\n   */\n  enabled: boolean;\n  /**\n   * The selected subtitle/captions language.\n   */\n  language?: string;\n}\n\nexport const isDifferentSubtitleInfo = (info1?: SubtitleInfo, info2?: SubtitleInfo): boolean => {\n  if (info1 == null && info2 == null) {\n    return false;\n  }\n  return !(info1 != null && info2 != null && info1.enabled === info2.enabled && info1.language === info2.language);\n};\n","export enum CdnProvider {\n  CLOUDFLARE = 'cloudflare',\n  AKAMAI = 'akamai',\n  FASTLY = 'fastly',\n  MAXCDN = 'maxcdn',\n  CLOUDFRONT = 'cloudfront',\n  CHINACACHE = 'chinacache',\n  BITGRAVITY = 'bitgravity',\n}\n"],"sourceRoot":""}